<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RocksDB Doxygen: ROCKSDB_NAMESPACE::CheckpointImpl 클래스 참조</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RocksDB Doxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 다음에 의해 생성됨 :  Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','검색',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">로딩중...</div>
<div class="SRStatus" id="Searching">검색중...</div>
<div class="SRStatus" id="NoMatches">일치하는것 없음</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public 멤버 함수</a> &#124;
<a href="#pri-methods">Private 멤버 함수</a> &#124;
<a href="#pri-attribs">Private 속성</a> &#124;
<a href="../../d5/dee/classROCKSDB__NAMESPACE_1_1CheckpointImpl-members.html">모든 멤버 목록</a>  </div>
  <div class="headertitle"><div class="title">ROCKSDB_NAMESPACE::CheckpointImpl 클래스 참조</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../dc/d30/checkpoint__impl_8h_source.html">checkpoint_impl.h</a>&gt;</code></p>
<div class="dynheader">
ROCKSDB_NAMESPACE::CheckpointImpl에 대한 상속 다이어그램 : </div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d3e/classROCKSDB__NAMESPACE_1_1CheckpointImpl__inherit__graph.png" border="0" usemap="#aROCKSDB__NAMESPACE_1_1CheckpointImpl_inherit__map" alt="Inheritance graph"/></div>
<map name="aROCKSDB__NAMESPACE_1_1CheckpointImpl_inherit__map" id="aROCKSDB__NAMESPACE_1_1CheckpointImpl_inherit__map">
<area shape="rect" title=" " alt="" coords="5,98,187,143"/>
<area shape="rect" href="../../de/d30/classROCKSDB__NAMESPACE_1_1Checkpoint.html" title=" " alt="" coords="5,5,187,50"/>
<area shape="poly" title=" " alt="" coords="99,66,99,98,93,98,93,66"/>
</map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">범례</a>]</span></center></div>
<div class="dynheader">
ROCKSDB_NAMESPACE::CheckpointImpl에 대한 협력 다이어그램:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d79/classROCKSDB__NAMESPACE_1_1CheckpointImpl__coll__graph.png" border="0" usemap="#aROCKSDB__NAMESPACE_1_1CheckpointImpl_coll__map" alt="Collaboration graph"/></div>
<map name="aROCKSDB__NAMESPACE_1_1CheckpointImpl_coll__map" id="aROCKSDB__NAMESPACE_1_1CheckpointImpl_coll__map">
<area shape="rect" title=" " alt="" coords="112,115,293,160"/>
<area shape="rect" href="../../de/d30/classROCKSDB__NAMESPACE_1_1Checkpoint.html" title=" " alt="" coords="5,5,187,50"/>
<area shape="poly" title=" " alt="" coords="130,59,183,112,179,116,126,63"/>
<area shape="rect" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html" title=" " alt="" coords="210,14,411,42"/>
<area shape="poly" title=" " alt="" coords="289,55,226,117,222,113,285,51"/>
</map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">범례</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public 멤버 함수</h2></td></tr>
<tr class="memitem:a4140bb31d82a5e07a9c2998921849296" id="r_a4140bb31d82a5e07a9c2998921849296"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4140bb31d82a5e07a9c2998921849296">CheckpointImpl</a> (<a class="el" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html">DB</a> *db)</td></tr>
<tr class="separator:a4140bb31d82a5e07a9c2998921849296"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a740d97c6ca0e956407ddb183f74014" id="r_a6a740d97c6ca0e956407ddb183f74014"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a740d97c6ca0e956407ddb183f74014">CreateCheckpoint</a> (const std::string &amp;checkpoint_dir, uint64_t log_size_for_flush, uint64_t *sequence_number_ptr) override</td></tr>
<tr class="separator:a6a740d97c6ca0e956407ddb183f74014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affaa3247c6b4fe65cf3b2d8a8f37a0e5" id="r_affaa3247c6b4fe65cf3b2d8a8f37a0e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#affaa3247c6b4fe65cf3b2d8a8f37a0e5">ExportColumnFamily</a> (<a class="el" href="../../da/d3d/classROCKSDB__NAMESPACE_1_1ColumnFamilyHandle.html">ColumnFamilyHandle</a> *handle, const std::string &amp;export_dir, <a class="el" href="../../db/da6/structROCKSDB__NAMESPACE_1_1ExportImportFilesMetaData.html">ExportImportFilesMetaData</a> **metadata) override</td></tr>
<tr class="separator:affaa3247c6b4fe65cf3b2d8a8f37a0e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eb88487277d45be8c0eeea9fbc7de9a" id="r_a5eb88487277d45be8c0eeea9fbc7de9a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5eb88487277d45be8c0eeea9fbc7de9a">CreateCustomCheckpoint</a> (std::function&lt; <a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>(const std::string &amp;src_dirname, const std::string &amp;fname, <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a572c40b059615a4b9755748d810fc3ad">FileType</a> <a class="el" href="../../de/da8/structROCKSDB__NAMESPACE_1_1aligned__storage.html">type</a>)&gt; link_file_cb, std::function&lt; <a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>(const std::string &amp;src_dirname, const std::string &amp;fname, uint64_t size_limit_bytes, <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a572c40b059615a4b9755748d810fc3ad">FileType</a> <a class="el" href="../../de/da8/structROCKSDB__NAMESPACE_1_1aligned__storage.html">type</a>, const std::string &amp;checksum_func_name, const std::string &amp;checksum_val, const <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af492037d489fafcaaa94166f43071240">Temperature</a> src_temperature)&gt; copy_file_cb, std::function&lt; <a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>(const std::string &amp;fname, const std::string &amp;contents, <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a572c40b059615a4b9755748d810fc3ad">FileType</a> <a class="el" href="../../de/da8/structROCKSDB__NAMESPACE_1_1aligned__storage.html">type</a>)&gt; create_file_cb, uint64_t *sequence_number, uint64_t log_size_for_flush, bool get_live_table_checksum=false)</td></tr>
<tr class="separator:a5eb88487277d45be8c0eeea9fbc7de9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classROCKSDB__NAMESPACE_1_1Checkpoint"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classROCKSDB__NAMESPACE_1_1Checkpoint')"><img src="../../closed.png" alt="-"/>&#160;<a class="el" href="../../de/d30/classROCKSDB__NAMESPACE_1_1Checkpoint.html">ROCKSDB_NAMESPACE::Checkpoint</a>(으)로부터 상속된 Public 멤버 함수</td></tr>
<tr class="memitem:a2c1ca9925de5fdf16cf7ea909aac641f inherit pub_methods_classROCKSDB__NAMESPACE_1_1Checkpoint" id="r_a2c1ca9925de5fdf16cf7ea909aac641f"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d30/classROCKSDB__NAMESPACE_1_1Checkpoint.html#a2c1ca9925de5fdf16cf7ea909aac641f">~Checkpoint</a> ()</td></tr>
<tr class="separator:a2c1ca9925de5fdf16cf7ea909aac641f inherit pub_methods_classROCKSDB__NAMESPACE_1_1Checkpoint"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private 멤버 함수</h2></td></tr>
<tr class="memitem:ab1aa0ff9e34be502526b0cd7270d8fa0" id="r_ab1aa0ff9e34be502526b0cd7270d8fa0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab1aa0ff9e34be502526b0cd7270d8fa0">CleanStagingDirectory</a> (const std::string &amp;path, <a class="el" href="../../dc/d56/classROCKSDB__NAMESPACE_1_1Logger.html">Logger</a> *info_log)</td></tr>
<tr class="separator:ab1aa0ff9e34be502526b0cd7270d8fa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88b2c0c9243be071a41002299b2143fb" id="r_a88b2c0c9243be071a41002299b2143fb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a88b2c0c9243be071a41002299b2143fb">ExportFilesInMetaData</a> (const <a class="el" href="../../d8/d57/structROCKSDB__NAMESPACE_1_1DBOptions.html">DBOptions</a> &amp;db_options, const <a class="el" href="../../d5/dfc/structROCKSDB__NAMESPACE_1_1ColumnFamilyMetaData.html">ColumnFamilyMetaData</a> &amp;metadata, std::function&lt; <a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>(const std::string &amp;src_dirname, const std::string &amp;fname)&gt; link_file_cb, std::function&lt; <a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>(const std::string &amp;src_dirname, const std::string &amp;fname)&gt; copy_file_cb)</td></tr>
<tr class="separator:a88b2c0c9243be071a41002299b2143fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private 속성</h2></td></tr>
<tr class="memitem:adbe040b610cac2898463c9d0f3dc46c4" id="r_adbe040b610cac2898463c9d0f3dc46c4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html">DB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a></td></tr>
<tr class="separator:adbe040b610cac2898463c9d0f3dc46c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
추가로 상속된 멤버들</h2></td></tr>
<tr class="inherit_header pub_static_methods_classROCKSDB__NAMESPACE_1_1Checkpoint"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_static_methods_classROCKSDB__NAMESPACE_1_1Checkpoint')"><img src="../../closed.png" alt="-"/>&#160;<a class="el" href="../../de/d30/classROCKSDB__NAMESPACE_1_1Checkpoint.html">ROCKSDB_NAMESPACE::Checkpoint</a>(으)로부터 상속된 정적 Public 멤버 함수</td></tr>
<tr class="memitem:aa7d1a904a0c846942f1711a4575566bb inherit pub_static_methods_classROCKSDB__NAMESPACE_1_1Checkpoint" id="r_aa7d1a904a0c846942f1711a4575566bb"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d30/classROCKSDB__NAMESPACE_1_1Checkpoint.html#aa7d1a904a0c846942f1711a4575566bb">Create</a> (<a class="el" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html">DB</a> *db, <a class="el" href="../../de/d30/classROCKSDB__NAMESPACE_1_1Checkpoint.html">Checkpoint</a> **checkpoint_ptr)</td></tr>
<tr class="separator:aa7d1a904a0c846942f1711a4575566bb inherit pub_static_methods_classROCKSDB__NAMESPACE_1_1Checkpoint"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">상세한 설명</h2>
<div class="textblock">
<p class="definition"><a class="el" href="../../dc/d30/checkpoint__impl_8h_source.html">checkpoint_impl.h</a> 파일의 <a class="el" href="../../dc/d30/checkpoint__impl_8h_source.html#l00016">16</a> 번째 라인에서 정의되었습니다.</p>
</div><h2 class="groupheader">생성자 &amp; 소멸자 문서화</h2>
<a id="a4140bb31d82a5e07a9c2998921849296" name="a4140bb31d82a5e07a9c2998921849296"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4140bb31d82a5e07a9c2998921849296">&#9670;&#160;</a></span>CheckpointImpl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ROCKSDB_NAMESPACE::CheckpointImpl::CheckpointImpl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html">DB</a> *</td>          <td class="paramname"><span class="paramname"><em>db</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel explicit">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../dc/d30/checkpoint__impl_8h_source.html">checkpoint_impl.h</a> 파일의 <a class="el" href="../../dc/d30/checkpoint__impl_8h_source.html#l00018">18</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">   18</span>: <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>(db) {}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1CheckpointImpl_html_adbe040b610cac2898463c9d0f3dc46c4"><div class="ttname"><a href="#adbe040b610cac2898463c9d0f3dc46c4">ROCKSDB_NAMESPACE::CheckpointImpl::db_</a></div><div class="ttdeci">DB * db_</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d30/checkpoint__impl_8h_source.html#l00060">checkpoint_impl.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">멤버 함수 문서화</h2>
<a id="ab1aa0ff9e34be502526b0cd7270d8fa0" name="ab1aa0ff9e34be502526b0cd7270d8fa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1aa0ff9e34be502526b0cd7270d8fa0">&#9670;&#160;</a></span>CleanStagingDirectory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a> ROCKSDB_NAMESPACE::CheckpointImpl::CleanStagingDirectory </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d56/classROCKSDB__NAMESPACE_1_1Logger.html">Logger</a> *</td>          <td class="paramname"><span class="paramname"><em>info_log</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d2/dce/checkpoint__impl_8cc_source.html">checkpoint_impl.cc</a> 파일의 <a class="el" href="../../d2/dce/checkpoint__impl_8cc_source.html#l00049">49</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">   50</span>                                                          {</div>
<div class="line"><span class="lineno">   51</span>  std::vector&lt;std::string&gt; subchildren;</div>
<div class="line"><span class="lineno">   52</span>  Status s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#af57b0deed23176c890dc764d7f8e5142">FileExists</a>(full_private_path);</div>
<div class="line"><span class="lineno">   53</span>  <span class="keywordflow">if</span> (s.IsNotFound()) {</div>
<div class="line"><span class="lineno">   54</span>    <span class="comment">// Nothing to clean</span></div>
<div class="line"><span class="lineno">   55</span>    <span class="keywordflow">return</span> Status::OK();</div>
<div class="line"><span class="lineno">   56</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!s.ok()) {</div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">return</span> s;</div>
<div class="line"><span class="lineno">   58</span>  }</div>
<div class="line"><span class="lineno">   59</span>  assert(s.ok());</div>
<div class="line"><span class="lineno">   60</span>  <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(info_log, <span class="stringliteral">&quot;File exists %s -- %s&quot;</span>, full_private_path.c_str(),</div>
<div class="line"><span class="lineno">   61</span>                 s.ToString().c_str());</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>  s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#ad821c7a23e52c37cab15fbaa14d31388">GetChildren</a>(full_private_path, &amp;subchildren);</div>
<div class="line"><span class="lineno">   64</span>  <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; subchild : subchildren) {</div>
<div class="line"><span class="lineno">   66</span>      Status del_s;</div>
<div class="line"><span class="lineno">   67</span>      std::string subchild_path = full_private_path + <span class="stringliteral">&quot;/&quot;</span> + subchild;</div>
<div class="line"><span class="lineno">   68</span>      del_s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#a1b83f773eb9d5293128c2270e7f6ca4a">DeleteFile</a>(subchild_path);</div>
<div class="line"><span class="lineno">   69</span>      <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(info_log, <span class="stringliteral">&quot;Delete file %s -- %s&quot;</span>, subchild_path.c_str(),</div>
<div class="line"><span class="lineno">   70</span>                     del_s.ToString().c_str());</div>
<div class="line"><span class="lineno">   71</span>      <span class="keywordflow">if</span> (!del_s.ok() &amp;&amp; s.ok()) {</div>
<div class="line"><span class="lineno">   72</span>        s = del_s;</div>
<div class="line"><span class="lineno">   73</span>      }</div>
<div class="line"><span class="lineno">   74</span>    }</div>
<div class="line"><span class="lineno">   75</span>  }</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>  <span class="comment">// Then delete the private dir</span></div>
<div class="line"><span class="lineno">   78</span>  <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">   79</span>    s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#a5092f628ea8316e17d9fa83f47849a06">DeleteDir</a>(full_private_path);</div>
<div class="line"><span class="lineno">   80</span>    <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(info_log, <span class="stringliteral">&quot;Delete dir %s -- %s&quot;</span>, full_private_path.c_str(),</div>
<div class="line"><span class="lineno">   81</span>                   s.ToString().c_str());</div>
<div class="line"><span class="lineno">   82</span>  }</div>
<div class="line"><span class="lineno">   83</span>  <span class="keywordflow">return</span> s;</div>
<div class="line"><span class="lineno">   84</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1DB_html_ab8edb16b3bf7f9fb5871ac547d53472b"><div class="ttname"><a href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">ROCKSDB_NAMESPACE::DB::GetEnv</a></div><div class="ttdeci">virtual Env * GetEnv() const =0</div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1Env_html_a1b83f773eb9d5293128c2270e7f6ca4a"><div class="ttname"><a href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#a1b83f773eb9d5293128c2270e7f6ca4a">ROCKSDB_NAMESPACE::Env::DeleteFile</a></div><div class="ttdeci">virtual Status DeleteFile(const std::string &amp;fname)=0</div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1Env_html_a5092f628ea8316e17d9fa83f47849a06"><div class="ttname"><a href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#a5092f628ea8316e17d9fa83f47849a06">ROCKSDB_NAMESPACE::Env::DeleteDir</a></div><div class="ttdeci">virtual Status DeleteDir(const std::string &amp;dirname)=0</div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1Env_html_ad821c7a23e52c37cab15fbaa14d31388"><div class="ttname"><a href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#ad821c7a23e52c37cab15fbaa14d31388">ROCKSDB_NAMESPACE::Env::GetChildren</a></div><div class="ttdeci">virtual Status GetChildren(const std::string &amp;dir, std::vector&lt; std::string &gt; *result)=0</div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1Env_html_af57b0deed23176c890dc764d7f8e5142"><div class="ttname"><a href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#af57b0deed23176c890dc764d7f8e5142">ROCKSDB_NAMESPACE::Env::FileExists</a></div><div class="ttdeci">virtual Status FileExists(const std::string &amp;fname)=0</div></div>
<div class="ttc" id="alogging_8h_html_a7f6160596d40ac57e3d9b68b40d7fc1c"><div class="ttname"><a href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a></div><div class="ttdeci">#define ROCKS_LOG_INFO(LGR, FMT,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d77/logging_8h_source.html#l00038">logging.h:38</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_ab1aa0ff9e34be502526b0cd7270d8fa0_cgraph.png" border="0" usemap="#ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_ab1aa0ff9e34be502526b0cd7270d8fa0_cgraph" alt=""/></div>
<map name="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_ab1aa0ff9e34be502526b0cd7270d8fa0_cgraph" id="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_ab1aa0ff9e34be502526b0cd7270d8fa0_cgraph">
<area shape="rect" title=" " alt="" coords="5,125,223,186"/>
<area shape="poly" title=" " alt="" coords="65,124,67,114,76,106,92,100,114,98,140,101,156,108,154,113,139,106,114,103,93,105,79,110,72,117,71,125"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#abad803bbeb3e3c84affdae4551f372d9" title=" " alt="" coords="271,168,452,213"/>
<area shape="poly" title=" " alt="" coords="223,168,256,173,255,178,223,174"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a68c941da5f3083ca54122b381139b65b" title=" " alt="" coords="271,237,452,282"/>
<area shape="poly" title=" " alt="" coords="185,185,272,223,287,229,285,234,270,227,183,190"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a44cf4d9e0f59181d4838378a46b41c73" title=" " alt="" coords="271,5,452,50"/>
<area shape="poly" title=" " alt="" coords="161,122,213,91,269,60,282,54,284,59,272,65,215,95,164,127"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a9405441372e0f9ce926cc59c37b00b11" title=" " alt="" coords="271,99,452,143"/>
<area shape="poly" title=" " alt="" coords="223,138,255,133,256,138,223,143"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#afc660ff45fc7c890834fd65eb0ee6c9c" title=" " alt="" coords="500,99,681,143"/>
<area shape="poly" title=" " alt="" coords="437,165,499,146,501,151,438,170"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#acf8261295e4ab4ec8c132ed51b6feb71" title=" " alt="" coords="729,99,911,143"/>
<area shape="poly" title=" " alt="" coords="452,181,562,170,681,153,720,145,721,150,682,158,562,176,453,187"/>
<area shape="poly" title=" " alt="" coords="682,118,714,118,714,124,682,124"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a9f76d02ed8e41702a1388cd092a12464" title=" " alt="" coords="500,237,681,282"/>
<area shape="poly" title=" " alt="" coords="452,257,485,257,485,262,452,262"/>
<area shape="poly" title=" " alt="" coords="423,48,453,60,524,90,522,95,451,65,421,53"/>
<area shape="poly" title=" " alt="" coords="453,40,682,84,717,92,716,97,681,89,452,45"/>
<area shape="poly" title=" " alt="" coords="452,118,485,118,485,124,452,124"/>
<area shape="poly" title=" " alt="" coords="317,99,316,89,324,80,339,74,361,72,386,75,401,81,399,86,385,80,361,77,340,79,327,84,321,90,323,98"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_ab1aa0ff9e34be502526b0cd7270d8fa0_icgraph.png" border="0" usemap="#ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_ab1aa0ff9e34be502526b0cd7270d8fa0_icgraph" alt=""/></div>
<map name="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_ab1aa0ff9e34be502526b0cd7270d8fa0_icgraph" id="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_ab1aa0ff9e34be502526b0cd7270d8fa0_icgraph">
<area shape="rect" title=" " alt="" coords="301,29,518,91"/>
<area shape="poly" title=" " alt="" coords="455,18,438,11,409,8,385,10,369,15,361,21,360,30,355,29,356,19,366,10,384,5,409,3,439,6,457,13"/>
<area shape="rect" href="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl.html#a6a740d97c6ca0e956407ddb183f74014" title=" " alt="" coords="5,38,253,82"/>
<area shape="poly" title=" " alt="" coords="285,63,253,63,253,58,285,58"/>
<area shape="poly" title=" " alt="" coords="175,25,158,19,129,16,103,18,86,23,79,29,81,37,76,38,74,28,83,19,102,13,129,11,159,14,177,20"/>
</map>
</div>

</div>
</div>
<a id="a6a740d97c6ca0e956407ddb183f74014" name="a6a740d97c6ca0e956407ddb183f74014"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a740d97c6ca0e956407ddb183f74014">&#9670;&#160;</a></span>CreateCheckpoint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a> ROCKSDB_NAMESPACE::CheckpointImpl::CreateCheckpoint </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>checkpoint_dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>log_size_for_flush</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *</td>          <td class="paramname"><span class="paramname"><em>sequence_number_ptr</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel override">override</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="../../de/d30/classROCKSDB__NAMESPACE_1_1Checkpoint.html#aa47c208dec7ea35741b4e5f4989f6900">ROCKSDB_NAMESPACE::Checkpoint</a>(으)로부터 재구현되었습니다.</p>

<p class="definition"><a class="el" href="../../d2/dce/checkpoint__impl_8cc_source.html">checkpoint_impl.cc</a> 파일의 <a class="el" href="../../d2/dce/checkpoint__impl_8cc_source.html#l00093">93</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">   95</span>                                                                       {</div>
<div class="line"><span class="lineno">   96</span>  DBOptions db_options = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#aa8911710ab5c5b26876870a809bdd7f6">GetDBOptions</a>();</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>  Status file_exists_s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#af57b0deed23176c890dc764d7f8e5142">FileExists</a>(checkpoint_dir);</div>
<div class="line"><span class="lineno">   99</span>  <span class="keywordflow">if</span> (file_exists_s.ok()) {</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">return</span> Status::InvalidArgument(<span class="stringliteral">&quot;Directory exists&quot;</span>);</div>
<div class="line"><span class="lineno">  101</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!file_exists_s.IsNotFound()) {</div>
<div class="line"><span class="lineno">  102</span>    assert(file_exists_s.IsIOError());</div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordflow">return</span> file_exists_s;</div>
<div class="line"><span class="lineno">  104</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  105</span>    assert(file_exists_s.IsNotFound());</div>
<div class="line"><span class="lineno">  106</span>  };</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>  Status s;</div>
<div class="line"><span class="lineno">  109</span>  <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(</div>
<div class="line"><span class="lineno">  110</span>      db_options.info_log,</div>
<div class="line"><span class="lineno">  111</span>      <span class="stringliteral">&quot;Started the snapshot process -- creating snapshot in directory %s&quot;</span>,</div>
<div class="line"><span class="lineno">  112</span>      checkpoint_dir.c_str());</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>  <span class="keywordtype">size_t</span> final_nonslash_idx = checkpoint_dir.find_last_not_of(<span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  115</span>  <span class="keywordflow">if</span> (final_nonslash_idx == std::string::npos) {</div>
<div class="line"><span class="lineno">  116</span>    <span class="comment">// npos means it&#39;s only slashes or empty. Non-empty means it&#39;s the root</span></div>
<div class="line"><span class="lineno">  117</span>    <span class="comment">// directory, but it shouldn&#39;t be because we verified above the directory</span></div>
<div class="line"><span class="lineno">  118</span>    <span class="comment">// doesn&#39;t exist.</span></div>
<div class="line"><span class="lineno">  119</span>    assert(checkpoint_dir.empty());</div>
<div class="line"><span class="lineno">  120</span>    s.PermitUncheckedError();</div>
<div class="line"><span class="lineno">  121</span>    <span class="keywordflow">return</span> Status::InvalidArgument(<span class="stringliteral">&quot;invalid checkpoint directory name&quot;</span>);</div>
<div class="line"><span class="lineno">  122</span>  }</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>  std::string full_private_path =</div>
<div class="line"><span class="lineno">  125</span>      checkpoint_dir.substr(0, final_nonslash_idx + 1) + <span class="stringliteral">&quot;.tmp&quot;</span>;</div>
<div class="line"><span class="lineno">  126</span>  <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log,</div>
<div class="line"><span class="lineno">  127</span>                 <span class="stringliteral">&quot;Snapshot process -- using temporary directory %s&quot;</span>,</div>
<div class="line"><span class="lineno">  128</span>                 full_private_path.c_str());</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>  s = <a class="code hl_function" href="#ab1aa0ff9e34be502526b0cd7270d8fa0">CleanStagingDirectory</a>(full_private_path, db_options.info_log.get());</div>
<div class="line"><span class="lineno">  131</span>  <span class="keywordflow">if</span> (!s.ok()) {</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">return</span> Status::Aborted(</div>
<div class="line"><span class="lineno">  133</span>        <span class="stringliteral">&quot;Failed to clean the temporary directory &quot;</span> + full_private_path +</div>
<div class="line"><span class="lineno">  134</span>        <span class="stringliteral">&quot; needed before checkpoint creation : &quot;</span> + s.ToString());</div>
<div class="line"><span class="lineno">  135</span>  }</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>  <span class="comment">// create snapshot directory</span></div>
<div class="line"><span class="lineno">  138</span>  s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#a4791003af6e944a9708441186cd23a25">CreateDir</a>(full_private_path);</div>
<div class="line"><span class="lineno">  139</span>  uint64_t sequence_number = 0;</div>
<div class="line"><span class="lineno">  140</span>  <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">  141</span>    <span class="comment">// enable file deletions</span></div>
<div class="line"><span class="lineno">  142</span>    s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a4ad5358caca9c50809d43460c5735f35">DisableFileDeletions</a>();</div>
<div class="line"><span class="lineno">  143</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> disabled_file_deletions = s.<a class="code hl_function" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a44cf4d9e0f59181d4838378a46b41c73">ok</a>();</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordflow">if</span> (s.ok() || s.IsNotSupported()) {</div>
<div class="line"><span class="lineno">  146</span>      s = <a class="code hl_function" href="#a5eb88487277d45be8c0eeea9fbc7de9a">CreateCustomCheckpoint</a>(</div>
<div class="line"><span class="lineno">  147</span>          [&amp;](<span class="keyword">const</span> std::string&amp; src_dirname, <span class="keyword">const</span> std::string&amp; fname,</div>
<div class="line"><span class="lineno">  148</span>              FileType) {</div>
<div class="line"><span class="lineno">  149</span>            <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log, <span class="stringliteral">&quot;Hard Linking %s&quot;</span>,</div>
<div class="line"><span class="lineno">  150</span>                           fname.c_str());</div>
<div class="line"><span class="lineno">  151</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a0526c7049c12073f74b88f4497c212fc">GetFileSystem</a>()-&gt;<a class="code hl_function" href="../../d3/d26/classROCKSDB__NAMESPACE_1_1FileSystem.html#aaea6be9eab2489b802510b295a5750a9">LinkFile</a>(</div>
<div class="line"><span class="lineno">  152</span>                src_dirname + <span class="stringliteral">&quot;/&quot;</span> + fname, full_private_path + <span class="stringliteral">&quot;/&quot;</span> + fname,</div>
<div class="line"><span class="lineno">  153</span>                IOOptions(), <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  154</span>          } <span class="comment">/* link_file_cb */</span>,</div>
<div class="line"><span class="lineno">  155</span>          [&amp;](<span class="keyword">const</span> std::string&amp; src_dirname, <span class="keyword">const</span> std::string&amp; fname,</div>
<div class="line"><span class="lineno">  156</span>              uint64_t size_limit_bytes, <a class="code hl_enumeration" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a572c40b059615a4b9755748d810fc3ad">FileType</a>,</div>
<div class="line"><span class="lineno">  157</span>              <span class="keyword">const</span> std::string&amp; <span class="comment">/* checksum_func_name */</span>,</div>
<div class="line"><span class="lineno">  158</span>              <span class="keyword">const</span> std::string&amp; <span class="comment">/* checksum_val */</span>,</div>
<div class="line"><span class="lineno">  159</span>              <span class="keyword">const</span> <a class="code hl_enumeration" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af492037d489fafcaaa94166f43071240">Temperature</a> temperature) {</div>
<div class="line"><span class="lineno">  160</span>            <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log, <span class="stringliteral">&quot;Copying %s&quot;</span>, fname.c_str());</div>
<div class="line"><span class="lineno">  161</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a61bc5b537d7b9219309af2dbd66096a2">CopyFile</a>(<a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a0526c7049c12073f74b88f4497c212fc">GetFileSystem</a>(), src_dirname + <span class="stringliteral">&quot;/&quot;</span> + fname,</div>
<div class="line"><span class="lineno">  162</span>                            temperature, full_private_path + <span class="stringliteral">&quot;/&quot;</span> + fname,</div>
<div class="line"><span class="lineno">  163</span>                            temperature, size_limit_bytes, db_options.use_fsync,</div>
<div class="line"><span class="lineno">  164</span>                            <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  165</span>          } <span class="comment">/* copy_file_cb */</span>,</div>
<div class="line"><span class="lineno">  166</span>          [&amp;](<span class="keyword">const</span> std::string&amp; fname, <span class="keyword">const</span> std::string&amp; contents, <a class="code hl_enumeration" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a572c40b059615a4b9755748d810fc3ad">FileType</a>) {</div>
<div class="line"><span class="lineno">  167</span>            <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log, <span class="stringliteral">&quot;Creating %s&quot;</span>, fname.c_str());</div>
<div class="line"><span class="lineno">  168</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a380d917e0efeb23a1320ceb9b57f58ff">CreateFile</a>(<a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a0526c7049c12073f74b88f4497c212fc">GetFileSystem</a>(),</div>
<div class="line"><span class="lineno">  169</span>                              full_private_path + <span class="stringliteral">&quot;/&quot;</span> + fname, contents,</div>
<div class="line"><span class="lineno">  170</span>                              db_options.use_fsync);</div>
<div class="line"><span class="lineno">  171</span>          } <span class="comment">/* create_file_cb */</span>,</div>
<div class="line"><span class="lineno">  172</span>          &amp;sequence_number, log_size_for_flush);</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>      <span class="comment">// we copied all the files, enable file deletions</span></div>
<div class="line"><span class="lineno">  175</span>      <span class="keywordflow">if</span> (disabled_file_deletions) {</div>
<div class="line"><span class="lineno">  176</span>        Status ss = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a76b598f2f07a7e961fa397a1cd65a013">EnableFileDeletions</a>();</div>
<div class="line"><span class="lineno">  177</span>        assert(ss.ok());</div>
<div class="line"><span class="lineno">  178</span>        ss.PermitUncheckedError();</div>
<div class="line"><span class="lineno">  179</span>      }</div>
<div class="line"><span class="lineno">  180</span>    }</div>
<div class="line"><span class="lineno">  181</span>  }</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>  <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">  184</span>    <span class="comment">// move tmp private backup to real snapshot directory</span></div>
<div class="line"><span class="lineno">  185</span>    s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#ab69c066e0f471bbc4020cccc32e2f496">RenameFile</a>(full_private_path, checkpoint_dir);</div>
<div class="line"><span class="lineno">  186</span>  }</div>
<div class="line"><span class="lineno">  187</span>  <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">  188</span>    std::unique_ptr&lt;FSDirectory&gt; checkpoint_directory;</div>
<div class="line"><span class="lineno">  189</span>    s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a0526c7049c12073f74b88f4497c212fc">GetFileSystem</a>()-&gt;<a class="code hl_function" href="../../d3/d26/classROCKSDB__NAMESPACE_1_1FileSystem.html#a3ffb5bf5aae1a721a29f0a31d427c33b">NewDirectory</a>(checkpoint_dir, IOOptions(),</div>
<div class="line"><span class="lineno">  190</span>                                           &amp;checkpoint_directory, <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  191</span>    <span class="keywordflow">if</span> (s.ok() &amp;&amp; checkpoint_directory != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  192</span>      s = checkpoint_directory-&gt;FsyncWithDirOptions(</div>
<div class="line"><span class="lineno">  193</span>          IOOptions(), <span class="keyword">nullptr</span>,</div>
<div class="line"><span class="lineno">  194</span>          DirFsyncOptions(DirFsyncOptions::FsyncReason::kDirRenamed));</div>
<div class="line"><span class="lineno">  195</span>    }</div>
<div class="line"><span class="lineno">  196</span>  }</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>  <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">if</span> (sequence_number_ptr != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  200</span>      *sequence_number_ptr = sequence_number;</div>
<div class="line"><span class="lineno">  201</span>    }</div>
<div class="line"><span class="lineno">  202</span>    <span class="comment">// here we know that we succeeded and installed the new snapshot</span></div>
<div class="line"><span class="lineno">  203</span>    <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log, <span class="stringliteral">&quot;Snapshot DONE. All is good&quot;</span>);</div>
<div class="line"><span class="lineno">  204</span>    <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log, <span class="stringliteral">&quot;Snapshot sequence number: %&quot;</span> PRIu64,</div>
<div class="line"><span class="lineno">  205</span>                   sequence_number);</div>
<div class="line"><span class="lineno">  206</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  207</span>    <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log, <span class="stringliteral">&quot;Snapshot failed -- %s&quot;</span>,</div>
<div class="line"><span class="lineno">  208</span>                   s.ToString().c_str());</div>
<div class="line"><span class="lineno">  209</span>    <span class="comment">// clean all the files and directory we might have created</span></div>
<div class="line"><span class="lineno">  210</span>    Status del_s =</div>
<div class="line"><span class="lineno">  211</span>        <a class="code hl_function" href="#ab1aa0ff9e34be502526b0cd7270d8fa0">CleanStagingDirectory</a>(full_private_path, db_options.info_log.get());</div>
<div class="line"><span class="lineno">  212</span>    <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log,</div>
<div class="line"><span class="lineno">  213</span>                   <span class="stringliteral">&quot;Clean files or directory we might have created %s: %s&quot;</span>,</div>
<div class="line"><span class="lineno">  214</span>                   full_private_path.c_str(), del_s.ToString().c_str());</div>
<div class="line"><span class="lineno">  215</span>    del_s.PermitUncheckedError();</div>
<div class="line"><span class="lineno">  216</span>  }</div>
<div class="line"><span class="lineno">  217</span>  <span class="keywordflow">return</span> s;</div>
<div class="line"><span class="lineno">  218</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1CheckpointImpl_html_a5eb88487277d45be8c0eeea9fbc7de9a"><div class="ttname"><a href="#a5eb88487277d45be8c0eeea9fbc7de9a">ROCKSDB_NAMESPACE::CheckpointImpl::CreateCustomCheckpoint</a></div><div class="ttdeci">Status CreateCustomCheckpoint(std::function&lt; Status(const std::string &amp;src_dirname, const std::string &amp;fname, FileType type)&gt; link_file_cb, std::function&lt; Status(const std::string &amp;src_dirname, const std::string &amp;fname, uint64_t size_limit_bytes, FileType type, const std::string &amp;checksum_func_name, const std::string &amp;checksum_val, const Temperature src_temperature)&gt; copy_file_cb, std::function&lt; Status(const std::string &amp;fname, const std::string &amp;contents, FileType type)&gt; create_file_cb, uint64_t *sequence_number, uint64_t log_size_for_flush, bool get_live_table_checksum=false)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/dce/checkpoint__impl_8cc_source.html#l00220">checkpoint_impl.cc:220</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1CheckpointImpl_html_ab1aa0ff9e34be502526b0cd7270d8fa0"><div class="ttname"><a href="#ab1aa0ff9e34be502526b0cd7270d8fa0">ROCKSDB_NAMESPACE::CheckpointImpl::CleanStagingDirectory</a></div><div class="ttdeci">Status CleanStagingDirectory(const std::string &amp;path, Logger *info_log)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/dce/checkpoint__impl_8cc_source.html#l00049">checkpoint_impl.cc:49</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1DB_html_a0526c7049c12073f74b88f4497c212fc"><div class="ttname"><a href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a0526c7049c12073f74b88f4497c212fc">ROCKSDB_NAMESPACE::DB::GetFileSystem</a></div><div class="ttdeci">virtual FileSystem * GetFileSystem() const</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d75/db__impl_8cc_source.html#l04470">db_impl.cc:4470</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1DB_html_a4ad5358caca9c50809d43460c5735f35"><div class="ttname"><a href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a4ad5358caca9c50809d43460c5735f35">ROCKSDB_NAMESPACE::DB::DisableFileDeletions</a></div><div class="ttdeci">virtual Status DisableFileDeletions()=0</div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1DB_html_a76b598f2f07a7e961fa397a1cd65a013"><div class="ttname"><a href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a76b598f2f07a7e961fa397a1cd65a013">ROCKSDB_NAMESPACE::DB::EnableFileDeletions</a></div><div class="ttdeci">virtual Status EnableFileDeletions()=0</div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1DB_html_aa8911710ab5c5b26876870a809bdd7f6"><div class="ttname"><a href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#aa8911710ab5c5b26876870a809bdd7f6">ROCKSDB_NAMESPACE::DB::GetDBOptions</a></div><div class="ttdeci">virtual DBOptions GetDBOptions() const =0</div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1Env_html_a4791003af6e944a9708441186cd23a25"><div class="ttname"><a href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#a4791003af6e944a9708441186cd23a25">ROCKSDB_NAMESPACE::Env::CreateDir</a></div><div class="ttdeci">virtual Status CreateDir(const std::string &amp;dirname)=0</div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1Env_html_ab69c066e0f471bbc4020cccc32e2f496"><div class="ttname"><a href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#ab69c066e0f471bbc4020cccc32e2f496">ROCKSDB_NAMESPACE::Env::RenameFile</a></div><div class="ttdeci">virtual Status RenameFile(const std::string &amp;src, const std::string &amp;target)=0</div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1FileSystem_html_a3ffb5bf5aae1a721a29f0a31d427c33b"><div class="ttname"><a href="../../d3/d26/classROCKSDB__NAMESPACE_1_1FileSystem.html#a3ffb5bf5aae1a721a29f0a31d427c33b">ROCKSDB_NAMESPACE::FileSystem::NewDirectory</a></div><div class="ttdeci">virtual IOStatus NewDirectory(const std::string &amp;name, const IOOptions &amp;io_opts, std::unique_ptr&lt; FSDirectory &gt; *result, IODebugContext *dbg)=0</div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1FileSystem_html_aaea6be9eab2489b802510b295a5750a9"><div class="ttname"><a href="../../d3/d26/classROCKSDB__NAMESPACE_1_1FileSystem.html#aaea6be9eab2489b802510b295a5750a9">ROCKSDB_NAMESPACE::FileSystem::LinkFile</a></div><div class="ttdeci">virtual IOStatus LinkFile(const std::string &amp;, const std::string &amp;, const IOOptions &amp;, IODebugContext *)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d8d/file__system_8h_source.html#l00556">file_system.h:556</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1Status_html_a44cf4d9e0f59181d4838378a46b41c73"><div class="ttname"><a href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a44cf4d9e0f59181d4838378a46b41c73">ROCKSDB_NAMESPACE::Status::ok</a></div><div class="ttdeci">bool ok() const</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd0/include_2rocksdb_2status_8h_source.html#l00320">status.h:320</a></div></div>
<div class="ttc" id="anamespaceROCKSDB__NAMESPACE_html_a380d917e0efeb23a1320ceb9b57f58ff"><div class="ttname"><a href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a380d917e0efeb23a1320ceb9b57f58ff">ROCKSDB_NAMESPACE::CreateFile</a></div><div class="ttdeci">IOStatus CreateFile(FileSystem *fs, const std::string &amp;destination, const std::string &amp;contents, bool use_fsync)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d2b/file__util_8cc_source.html#l00103">file_util.cc:103</a></div></div>
<div class="ttc" id="anamespaceROCKSDB__NAMESPACE_html_a572c40b059615a4b9755748d810fc3ad"><div class="ttname"><a href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a572c40b059615a4b9755748d810fc3ad">ROCKSDB_NAMESPACE::FileType</a></div><div class="ttdeci">FileType</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d49/types_8h_source.html#l00045">types.h:45</a></div></div>
<div class="ttc" id="anamespaceROCKSDB__NAMESPACE_html_a61bc5b537d7b9219309af2dbd66096a2"><div class="ttname"><a href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a61bc5b537d7b9219309af2dbd66096a2">ROCKSDB_NAMESPACE::CopyFile</a></div><div class="ttdeci">IOStatus CopyFile(FileSystem *fs, const std::string &amp;source, Temperature src_temp_hint, std::unique_ptr&lt; WritableFileWriter &gt; &amp;dest_writer, uint64_t size, bool use_fsync, const std::shared_ptr&lt; IOTracer &gt; &amp;io_tracer)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d2b/file__util_8cc_source.html#l00021">file_util.cc:21</a></div></div>
<div class="ttc" id="anamespaceROCKSDB__NAMESPACE_html_af492037d489fafcaaa94166f43071240"><div class="ttname"><a href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af492037d489fafcaaa94166f43071240">ROCKSDB_NAMESPACE::Temperature</a></div><div class="ttdeci">Temperature</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d49/types_8h_source.html#l00117">types.h:117</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a6a740d97c6ca0e956407ddb183f74014_cgraph.png" border="0" usemap="#ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a6a740d97c6ca0e956407ddb183f74014_cgraph" alt=""/></div>
<map name="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a6a740d97c6ca0e956407ddb183f74014_cgraph" id="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a6a740d97c6ca0e956407ddb183f74014_cgraph">
<area shape="rect" title=" " alt="" coords="5,475,253,519"/>
<area shape="poly" title=" " alt="" coords="75,475,74,464,83,455,101,450,129,448,159,450,177,457,175,462,158,456,129,453,102,455,86,460,79,466,81,474"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a51e6d3ac7cbe986b7eb5f1cbf99b10d4" title=" " alt="" coords="322,109,504,154"/>
<area shape="poly" title=" " alt="" coords="140,473,204,366,249,299,299,234,335,196,371,162,374,166,338,199,303,237,253,302,208,369,145,475"/>
<area shape="rect" href="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl.html#ab1aa0ff9e34be502526b0cd7270d8fa0" title=" " alt="" coords="304,584,522,645"/>
<area shape="poly" title=" " alt="" coords="186,517,323,575,321,580,184,522"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#abad803bbeb3e3c84affdae4551f372d9" title=" " alt="" coords="592,640,774,685"/>
<area shape="poly" title=" " alt="" coords="148,518,173,551,208,589,252,627,302,655,370,674,443,683,513,683,577,678,577,683,513,689,442,688,369,680,300,659,249,631,205,593,169,554,143,521"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a44cf4d9e0f59181d4838378a46b41c73" title=" " alt="" coords="592,709,774,754"/>
<area shape="poly" title=" " alt="" coords="145,519,169,558,204,605,249,652,274,672,302,689,369,716,441,731,512,738,577,738,577,743,512,743,440,736,368,721,299,694,271,677,245,656,200,609,164,561,140,521"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a9405441372e0f9ce926cc59c37b00b11" title=" " alt="" coords="592,571,774,615"/>
<area shape="poly" title=" " alt="" coords="253,505,385,521,526,545,598,563,596,568,524,550,384,526,253,510"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a61bc5b537d7b9219309af2dbd66096a2" title=" " alt="" coords="322,821,504,866"/>
<area shape="poly" title=" " alt="" coords="145,518,207,623,252,688,303,750,335,782,369,810,366,814,332,786,299,753,248,691,203,625,140,521"/>
<area shape="rect" href="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl.html#a5eb88487277d45be8c0eeea9fbc7de9a" title=" " alt="" coords="301,272,525,333"/>
<area shape="poly" title=" " alt="" coords="151,473,215,413,256,380,299,349,318,338,321,343,302,354,259,384,218,417,154,476"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a74251af128f4cf6beb4e1fadf77d717d" title=" " alt="" coords="592,408,774,453"/>
<area shape="poly" title=" " alt="" coords="253,480,577,440,577,446,253,485"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a380d917e0efeb23a1320ceb9b57f58ff" title=" " alt="" coords="322,915,504,959"/>
<area shape="poly" title=" " alt="" coords="138,519,155,586,187,680,209,732,235,783,267,832,303,876,340,905,337,909,299,880,262,835,231,786,204,734,182,682,150,588,132,520"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a5fdd2c6692215a7d1894f2052ffc5609" title=" " alt="" coords="322,5,504,50"/>
<area shape="poly" title=" " alt="" coords="132,473,150,404,182,305,204,251,231,196,262,144,299,95,321,74,347,56,350,60,325,78,303,99,267,147,236,199,209,253,187,307,155,405,138,475"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#afbdbc286a17e980852073e5382cff0fb" title=" " alt="" coords="592,477,774,522"/>
<area shape="poly" title=" " alt="" coords="253,495,577,496,577,502,253,500"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#aaf1532cf0c0cf8fb93620d09e41d624f" title=" " alt="" coords="841,348,1057,393"/>
<area shape="poly" title=" " alt="" coords="196,472,300,441,435,412,573,393,703,380,825,373,826,378,703,386,573,398,436,417,301,446,197,477"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a9f76d02ed8e41702a1388cd092a12464" title=" " alt="" coords="858,80,1040,125"/>
<area shape="poly" title=" " alt="" coords="457,106,511,83,572,65,634,56,683,54,794,65,847,74,846,79,793,70,683,59,635,61,574,70,513,88,459,111"/>
<area shape="poly" title=" " alt="" coords="360,583,361,573,371,564,388,559,413,557,441,560,458,567,456,572,440,565,413,562,389,564,374,569,366,575,365,584"/>
<area shape="poly" title=" " alt="" coords="522,631,577,641,576,646,521,636"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a68c941da5f3083ca54122b381139b65b" title=" " alt="" coords="592,288,774,333"/>
<area shape="poly" title=" " alt="" coords="431,581,489,494,528,442,571,394,634,340,637,344,575,398,533,446,494,497,435,584"/>
<area shape="poly" title=" " alt="" coords="470,643,574,695,591,701,590,706,572,699,468,648"/>
<area shape="poly" title=" " alt="" coords="522,603,577,599,577,604,522,608"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#afc660ff45fc7c890834fd65eb0ee6c9c" title=" " alt="" coords="858,563,1040,607"/>
<area shape="poly" title=" " alt="" coords="762,637,854,610,856,615,763,642"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#acf8261295e4ab4ec8c132ed51b6feb71" title=" " alt="" coords="1105,516,1286,561"/>
<area shape="poly" title=" " alt="" coords="774,660,909,649,984,637,1056,617,1106,595,1150,567,1153,572,1108,599,1058,622,985,642,910,655,775,665"/>
<area shape="poly" title=" " alt="" coords="1040,565,1089,556,1090,561,1041,570"/>
<area shape="poly" title=" " alt="" coords="770,285,792,273,832,242,868,206,923,136,927,139,872,209,836,246,795,278,773,290"/>
<area shape="poly" title=" " alt="" coords="765,706,792,695,855,656,909,615,912,619,858,660,795,699,768,711"/>
<area shape="poly" title=" " alt="" coords="774,726,838,720,911,708,985,689,1055,661,1087,642,1117,619,1164,571,1168,575,1120,623,1090,647,1058,666,987,694,912,714,839,725,774,732"/>
<area shape="poly" title=" " alt="" coords="774,588,843,586,843,591,774,593"/>
<area shape="poly" title=" " alt="" coords="633,571,631,560,640,552,657,546,683,544,712,546,729,553,727,558,711,552,683,549,658,551,643,556,636,562,638,570"/>
<area shape="poly" title=" " alt="" coords="456,818,572,764,590,757,592,762,574,769,458,823"/>
<area shape="poly" title=" " alt="" coords="362,821,360,811,369,802,386,797,413,795,442,797,459,803,457,808,440,802,413,800,387,802,372,807,365,813,367,820"/>
<area shape="rect" href="../../d4/d77/classROCKSDB__NAMESPACE_1_1IOStatus.html#a76acbf601e7a94bf9b975c7317612fe8" title=" " alt="" coords="592,917,774,962"/>
<area shape="poly" title=" " alt="" coords="495,864,526,876,574,903,590,909,588,914,572,907,524,881,493,869"/>
<area shape="rect" href="../../d3/d26/classROCKSDB__NAMESPACE_1_1FileSystem.html#aaeb7fe642962682038a301ffd73c4242" title=" " alt="" coords="592,987,774,1031"/>
<area shape="poly" title=" " alt="" coords="506,862,527,876,545,901,552,926,558,949,575,972,581,977,577,981,571,976,553,952,546,927,540,903,523,880,503,867"/>
<area shape="rect" href="../../d3/d26/classROCKSDB__NAMESPACE_1_1FileSystem.html#ac8298a902e5ad7cd14294df072caf9e5" title=" " alt="" coords="573,1056,793,1101"/>
<area shape="poly" title=" " alt="" coords="506,861,527,876,543,898,550,919,552,961,553,1002,560,1022,575,1042,578,1045,574,1048,571,1045,555,1024,548,1003,546,961,545,920,538,900,523,880,502,865"/>
<area shape="rect" href="../../de/dc6/classROCKSDB__NAMESPACE_1_1Slice.html#a47c51c16ecee27b619768f1b817a342c" title=" " alt="" coords="592,779,774,823"/>
<area shape="poly" title=" " alt="" coords="504,827,577,815,578,820,504,832"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a82cbdaebf691c6ce25d631dda5ae8ed5" title=" " alt="" coords="592,848,774,893"/>
<area shape="poly" title=" " alt="" coords="504,850,577,857,577,863,504,855"/>
<area shape="rect" href="../../d4/d77/classROCKSDB__NAMESPACE_1_1IOStatus.html#afbd1ef4e0d59793126a5384681f793e2" title=" " alt="" coords="858,917,1040,962"/>
<area shape="poly" title=" " alt="" coords="774,937,843,937,843,942,774,942"/>
<area shape="poly" title=" " alt="" coords="902,917,901,907,909,898,925,893,949,891,976,893,991,900,989,905,974,898,949,896,926,898,912,903,906,909,907,916"/>
<area shape="poly" title=" " alt="" coords="525,303,577,305,577,310,525,308"/>
<area shape="poly" title=" " alt="" coords="432,332,477,427,528,547,539,591,543,628,551,661,560,678,575,695,581,701,578,705,571,699,556,681,546,663,537,629,534,592,522,549,472,430,427,335"/>
<area shape="poly" title=" " alt="" coords="360,271,361,261,371,252,388,247,413,245,441,248,458,255,456,260,440,253,413,250,389,252,374,257,366,263,365,272"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a41dc92b90c65fe4db6b69108cf52569e" title=" " alt="" coords="592,149,774,194"/>
<area shape="poly" title=" " alt="" coords="458,269,512,236,572,204,587,197,589,202,574,209,514,240,461,273"/>
<area shape="poly" title=" " alt="" coords="481,331,621,398,619,403,479,336"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a42e3923d032df7d19711bed58fc74bbd" title=" " alt="" coords="592,219,774,263"/>
<area shape="poly" title=" " alt="" coords="525,274,577,262,578,268,526,279"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a80198f888172bfab4d714628b7bfaec5" title=" " alt="" coords="592,80,774,125"/>
<area shape="poly" title=" " alt="" coords="434,269,492,202,530,166,572,135,581,130,583,134,574,139,533,170,496,205,438,273"/>
<area shape="poly" title=" " alt="" coords="771,146,845,127,847,132,772,151"/>
<area shape="poly" title=" " alt="" coords="768,451,795,463,860,505,915,550,911,554,857,510,792,467,766,456"/>
<area shape="poly" title=" " alt="" coords="775,443,908,467,1057,498,1100,509,1098,514,1056,504,907,472,774,448"/>
<area shape="poly" title=" " alt="" coords="774,100,843,100,843,105,774,105"/>
<area shape="poly" title=" " alt="" coords="474,912,500,896,523,877,534,862,540,848,545,821,551,793,559,778,571,764,578,759,581,763,575,768,563,781,556,795,550,822,545,850,538,865,527,880,503,901,476,916"/>
<area shape="poly" title=" " alt="" coords="362,915,360,904,369,896,386,890,413,888,442,890,459,897,457,902,440,896,413,893,387,895,372,900,365,906,367,914"/>
<area shape="rect" href="../../d3/d26/classROCKSDB__NAMESPACE_1_1FileSystem.html#a45c1624e35e2fe23fb70b0c67394a38d" title=" " alt="" coords="580,1125,786,1170"/>
<area shape="poly" title=" " alt="" coords="431,958,488,1033,529,1075,575,1111,583,1116,580,1120,571,1115,525,1079,484,1037,427,962"/>
<area shape="poly" title=" " alt="" coords="504,21,641,23,718,29,794,41,842,54,887,71,885,76,840,59,793,46,718,34,641,28,504,26"/>
<area shape="poly" title=" " alt="" coords="757,520,794,532,865,555,863,560,793,537,756,525"/>
<area shape="poly" title=" " alt="" coords="775,504,1089,528,1089,533,774,509"/>
<area shape="poly" title=" " alt="" coords="997,391,1058,427,1111,466,1158,504,1155,508,1108,470,1055,431,994,396"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a6a740d97c6ca0e956407ddb183f74014_icgraph.png" border="0" usemap="#ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a6a740d97c6ca0e956407ddb183f74014_icgraph" alt=""/></div>
<map name="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a6a740d97c6ca0e956407ddb183f74014_icgraph" id="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a6a740d97c6ca0e956407ddb183f74014_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,253,74"/>
<area shape="poly" title=" " alt="" coords="170,17,154,10,129,8,106,10,91,15,86,21,87,28,82,29,81,19,89,10,105,5,129,3,156,5,172,12"/>
</map>
</div>

</div>
</div>
<a id="a5eb88487277d45be8c0eeea9fbc7de9a" name="a5eb88487277d45be8c0eeea9fbc7de9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eb88487277d45be8c0eeea9fbc7de9a">&#9670;&#160;</a></span>CreateCustomCheckpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a> ROCKSDB_NAMESPACE::CheckpointImpl::CreateCustomCheckpoint </td>
          <td>(</td>
          <td class="paramtype">std::function&lt; <a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>(const std::string &amp;src_dirname, const std::string &amp;fname, <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a572c40b059615a4b9755748d810fc3ad">FileType</a> <a class="el" href="../../de/da8/structROCKSDB__NAMESPACE_1_1aligned__storage.html">type</a>)&gt;</td>          <td class="paramname"><span class="paramname"><em>link_file_cb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; <a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>(const std::string &amp;src_dirname, const std::string &amp;fname, uint64_t size_limit_bytes, <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a572c40b059615a4b9755748d810fc3ad">FileType</a> <a class="el" href="../../de/da8/structROCKSDB__NAMESPACE_1_1aligned__storage.html">type</a>, const std::string &amp;checksum_func_name, const std::string &amp;checksum_val, const <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af492037d489fafcaaa94166f43071240">Temperature</a> src_temperature)&gt;</td>          <td class="paramname"><span class="paramname"><em>copy_file_cb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; <a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>(const std::string &amp;fname, const std::string &amp;contents, <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a572c40b059615a4b9755748d810fc3ad">FileType</a> <a class="el" href="../../de/da8/structROCKSDB__NAMESPACE_1_1aligned__storage.html">type</a>)&gt;</td>          <td class="paramname"><span class="paramname"><em>create_file_cb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *</td>          <td class="paramname"><span class="paramname"><em>sequence_number</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>log_size_for_flush</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>get_live_table_checksum</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d2/dce/checkpoint__impl_8cc_source.html">checkpoint_impl.cc</a> 파일의 <a class="el" href="../../d2/dce/checkpoint__impl_8cc_source.html#l00220">220</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  234</span>                                  {</div>
<div class="line"><span class="lineno">  235</span>  *sequence_number = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#adb801426d2d750b709ce26f908aa8ad2">GetLatestSequenceNumber</a>();</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>  LiveFilesStorageInfoOptions opts;</div>
<div class="line"><span class="lineno">  238</span>  opts.include_checksum_info = get_live_table_checksum;</div>
<div class="line"><span class="lineno">  239</span>  opts.wal_size_for_flush = log_size_for_flush;</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>  std::vector&lt;LiveFileStorageInfo&gt; infos;</div>
<div class="line"><span class="lineno">  242</span>  {</div>
<div class="line"><span class="lineno">  243</span>    Status s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#af46f8882c10ea8587318c42ad49a1a97">GetLiveFilesStorageInfo</a>(opts, &amp;infos);</div>
<div class="line"><span class="lineno">  244</span>    <span class="keywordflow">if</span> (!s.ok()) {</div>
<div class="line"><span class="lineno">  245</span>      <span class="keywordflow">return</span> s;</div>
<div class="line"><span class="lineno">  246</span>    }</div>
<div class="line"><span class="lineno">  247</span>  }</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>  <span class="comment">// Verify that everything except WAL files are in same directory</span></div>
<div class="line"><span class="lineno">  250</span>  <span class="comment">// (db_paths / cf_paths not supported)</span></div>
<div class="line"><span class="lineno">  251</span>  std::unordered_set&lt;std::string&gt; dirs;</div>
<div class="line"><span class="lineno">  252</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; info : infos) {</div>
<div class="line"><span class="lineno">  253</span>    <span class="keywordflow">if</span> (info.file_type != kWalFile) {</div>
<div class="line"><span class="lineno">  254</span>      dirs.insert(info.directory);</div>
<div class="line"><span class="lineno">  255</span>    }</div>
<div class="line"><span class="lineno">  256</span>  }</div>
<div class="line"><span class="lineno">  257</span>  <span class="keywordflow">if</span> (dirs.size() &gt; 1) {</div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">return</span> Status::NotSupported(</div>
<div class="line"><span class="lineno">  259</span>        <span class="stringliteral">&quot;db_paths / cf_paths not supported for Checkpoint nor BackupEngine&quot;</span>);</div>
<div class="line"><span class="lineno">  260</span>  }</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>  <span class="keywordtype">bool</span> same_fs = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; info : infos) {</div>
<div class="line"><span class="lineno">  265</span>    Status s;</div>
<div class="line"><span class="lineno">  266</span>    <span class="keywordflow">if</span> (!info.replacement_contents.empty()) {</div>
<div class="line"><span class="lineno">  267</span>      <span class="comment">// Currently should only be used for CURRENT file.</span></div>
<div class="line"><span class="lineno">  268</span>      assert(info.file_type == kCurrentFile);</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>      <span class="keywordflow">if</span> (info.size != info.replacement_contents.size()) {</div>
<div class="line"><span class="lineno">  271</span>        s = Status::Corruption(<span class="stringliteral">&quot;Inconsistent size metadata for &quot;</span> +</div>
<div class="line"><span class="lineno">  272</span>                               info.relative_filename);</div>
<div class="line"><span class="lineno">  273</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  274</span>        s = create_file_cb(info.relative_filename, info.replacement_contents,</div>
<div class="line"><span class="lineno">  275</span>                           info.file_type);</div>
<div class="line"><span class="lineno">  276</span>      }</div>
<div class="line"><span class="lineno">  277</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  278</span>      <span class="keywordflow">if</span> (same_fs &amp;&amp; !info.trim_to_size) {</div>
<div class="line"><span class="lineno">  279</span>        s = link_file_cb(info.directory, info.relative_filename,</div>
<div class="line"><span class="lineno">  280</span>                         info.file_type);</div>
<div class="line"><span class="lineno">  281</span>        <span class="keywordflow">if</span> (s.IsNotSupported()) {</div>
<div class="line"><span class="lineno">  282</span>          same_fs = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  283</span>          s = Status::OK();</div>
<div class="line"><span class="lineno">  284</span>        }</div>
<div class="line"><span class="lineno">  285</span>        s.MustCheck();</div>
<div class="line"><span class="lineno">  286</span>      }</div>
<div class="line"><span class="lineno">  287</span>      <span class="keywordflow">if</span> (!same_fs || info.trim_to_size) {</div>
<div class="line"><span class="lineno">  288</span>        assert(info.file_checksum_func_name.empty() ==</div>
<div class="line"><span class="lineno">  289</span>               !opts.include_checksum_info);</div>
<div class="line"><span class="lineno">  290</span>        <span class="comment">// no assertion on file_checksum because empty is used for both &quot;not</span></div>
<div class="line"><span class="lineno">  291</span>        <span class="comment">// set&quot; and &quot;unknown&quot;</span></div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">if</span> (opts.include_checksum_info) {</div>
<div class="line"><span class="lineno">  293</span>          s = copy_file_cb(info.directory, info.relative_filename, info.size,</div>
<div class="line"><span class="lineno">  294</span>                           info.file_type, info.file_checksum_func_name,</div>
<div class="line"><span class="lineno">  295</span>                           info.file_checksum, info.temperature);</div>
<div class="line"><span class="lineno">  296</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  297</span>          s = copy_file_cb(info.directory, info.relative_filename, info.size,</div>
<div class="line"><span class="lineno">  298</span>                           info.file_type, kUnknownFileChecksumFuncName,</div>
<div class="line"><span class="lineno">  299</span>                           kUnknownFileChecksum, info.temperature);</div>
<div class="line"><span class="lineno">  300</span>        }</div>
<div class="line"><span class="lineno">  301</span>      }</div>
<div class="line"><span class="lineno">  302</span>    }</div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordflow">if</span> (!s.ok()) {</div>
<div class="line"><span class="lineno">  304</span>      <span class="keywordflow">return</span> s;</div>
<div class="line"><span class="lineno">  305</span>    }</div>
<div class="line"><span class="lineno">  306</span>  }</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>  <span class="keywordflow">return</span> Status::OK();</div>
<div class="line"><span class="lineno">  309</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1DB_html_adb801426d2d750b709ce26f908aa8ad2"><div class="ttname"><a href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#adb801426d2d750b709ce26f908aa8ad2">ROCKSDB_NAMESPACE::DB::GetLatestSequenceNumber</a></div><div class="ttdeci">virtual SequenceNumber GetLatestSequenceNumber() const =0</div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1DB_html_af46f8882c10ea8587318c42ad49a1a97"><div class="ttname"><a href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#af46f8882c10ea8587318c42ad49a1a97">ROCKSDB_NAMESPACE::DB::GetLiveFilesStorageInfo</a></div><div class="ttdeci">virtual Status GetLiveFilesStorageInfo(const LiveFilesStorageInfoOptions &amp;opts, std::vector&lt; LiveFileStorageInfo &gt; *files)=0</div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a5eb88487277d45be8c0eeea9fbc7de9a_cgraph.png" border="0" usemap="#ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a5eb88487277d45be8c0eeea9fbc7de9a_cgraph" alt=""/></div>
<map name="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a5eb88487277d45be8c0eeea9fbc7de9a_cgraph" id="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a5eb88487277d45be8c0eeea9fbc7de9a_cgraph">
<area shape="rect" title=" " alt="" coords="5,170,230,232"/>
<area shape="poly" title=" " alt="" coords="68,170,70,160,79,151,95,145,118,144,144,146,160,153,158,158,142,151,117,149,96,151,81,156,74,162,74,170"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a41dc92b90c65fe4db6b69108cf52569e" title=" " alt="" coords="278,5,459,50"/>
<area shape="poly" title=" " alt="" coords="146,168,204,114,239,85,276,60,285,55,288,60,279,65,242,90,207,118,150,172"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a74251af128f4cf6beb4e1fadf77d717d" title=" " alt="" coords="278,352,459,397"/>
<area shape="poly" title=" " alt="" coords="150,230,207,284,242,312,279,337,288,342,285,347,276,342,239,317,204,288,146,234"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a42e3923d032df7d19711bed58fc74bbd" title=" " alt="" coords="278,144,459,189"/>
<area shape="poly" title=" " alt="" coords="230,183,262,178,263,184,231,188"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a80198f888172bfab4d714628b7bfaec5" title=" " alt="" coords="278,75,459,119"/>
<area shape="poly" title=" " alt="" coords="188,167,277,129,292,123,294,128,279,134,190,172"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a68c941da5f3083ca54122b381139b65b" title=" " alt="" coords="278,213,459,258"/>
<area shape="poly" title=" " alt="" coords="231,214,263,218,262,224,230,219"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a44cf4d9e0f59181d4838378a46b41c73" title=" " alt="" coords="278,283,459,327"/>
<area shape="poly" title=" " alt="" coords="190,230,279,268,294,274,292,279,277,273,188,235"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a9f76d02ed8e41702a1388cd092a12464" title=" " alt="" coords="507,75,688,119"/>
<area shape="poly" title=" " alt="" coords="445,48,508,67,506,72,444,53"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#afc660ff45fc7c890834fd65eb0ee6c9c" title=" " alt="" coords="507,317,688,362"/>
<area shape="poly" title=" " alt="" coords="459,358,491,353,492,358,460,363"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#acf8261295e4ab4ec8c132ed51b6feb71" title=" " alt="" coords="736,317,918,362"/>
<area shape="poly" title=" " alt="" coords="460,378,569,379,688,372,734,364,734,369,689,377,569,385,460,383"/>
<area shape="poly" title=" " alt="" coords="689,337,721,337,721,342,689,342"/>
<area shape="poly" title=" " alt="" coords="459,94,492,94,492,100,459,100"/>
<area shape="poly" title=" " alt="" coords="434,210,458,199,511,164,558,127,561,131,515,168,460,203,436,215"/>
<area shape="poly" title=" " alt="" coords="460,316,492,321,491,326,459,321"/>
<area shape="poly" title=" " alt="" coords="460,296,569,295,689,302,734,311,734,316,688,308,569,300,460,302"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a5eb88487277d45be8c0eeea9fbc7de9a_icgraph.png" border="0" usemap="#ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a5eb88487277d45be8c0eeea9fbc7de9a_icgraph" alt=""/></div>
<map name="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a5eb88487277d45be8c0eeea9fbc7de9a_icgraph" id="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a5eb88487277d45be8c0eeea9fbc7de9a_icgraph">
<area shape="rect" title=" " alt="" coords="301,29,525,91"/>
<area shape="poly" title=" " alt="" coords="459,18,442,11,413,8,388,10,372,15,364,21,363,30,357,29,359,19,369,10,387,5,413,3,443,6,461,13"/>
<area shape="rect" href="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl.html#a6a740d97c6ca0e956407ddb183f74014" title=" " alt="" coords="5,38,253,82"/>
<area shape="poly" title=" " alt="" coords="285,63,253,63,253,58,285,58"/>
<area shape="poly" title=" " alt="" coords="175,25,158,19,129,16,102,18,86,23,79,29,81,37,75,38,74,28,83,19,101,13,129,11,159,14,177,20"/>
</map>
</div>

</div>
</div>
<a id="affaa3247c6b4fe65cf3b2d8a8f37a0e5" name="affaa3247c6b4fe65cf3b2d8a8f37a0e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affaa3247c6b4fe65cf3b2d8a8f37a0e5">&#9670;&#160;</a></span>ExportColumnFamily()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a> ROCKSDB_NAMESPACE::CheckpointImpl::ExportColumnFamily </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d3d/classROCKSDB__NAMESPACE_1_1ColumnFamilyHandle.html">ColumnFamilyHandle</a> *</td>          <td class="paramname"><span class="paramname"><em>handle</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>export_dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/da6/structROCKSDB__NAMESPACE_1_1ExportImportFilesMetaData.html">ExportImportFilesMetaData</a> **</td>          <td class="paramname"><span class="paramname"><em>metadata</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel override">override</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="../../de/d30/classROCKSDB__NAMESPACE_1_1Checkpoint.html#a6f122aa1f7102cab0a46aac0b91fe744">ROCKSDB_NAMESPACE::Checkpoint</a>(으)로부터 재구현되었습니다.</p>

<p class="definition"><a class="el" href="../../d2/dce/checkpoint__impl_8cc_source.html">checkpoint_impl.cc</a> 파일의 <a class="el" href="../../d2/dce/checkpoint__impl_8cc_source.html#l00313">313</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  315</span>                                          {</div>
<div class="line"><span class="lineno">  316</span>  <span class="keyword">auto</span> cfh = static_cast_with_check&lt;ColumnFamilyHandleImpl&gt;(handle);</div>
<div class="line"><span class="lineno">  317</span>  <span class="keyword">const</span> <span class="keyword">auto</span> cf_name = cfh-&gt;GetName();</div>
<div class="line"><span class="lineno">  318</span>  <span class="keyword">const</span> <span class="keyword">auto</span> db_options = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#aa8911710ab5c5b26876870a809bdd7f6">GetDBOptions</a>();</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>  assert(metadata != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  321</span>  assert(*metadata == <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  322</span>  <span class="keyword">auto</span> s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#af57b0deed23176c890dc764d7f8e5142">FileExists</a>(export_dir);</div>
<div class="line"><span class="lineno">  323</span>  <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">  324</span>    <span class="keywordflow">return</span> Status::InvalidArgument(<span class="stringliteral">&quot;Specified export_dir exists&quot;</span>);</div>
<div class="line"><span class="lineno">  325</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!s.IsNotFound()) {</div>
<div class="line"><span class="lineno">  326</span>    assert(s.IsIOError());</div>
<div class="line"><span class="lineno">  327</span>    <span class="keywordflow">return</span> s;</div>
<div class="line"><span class="lineno">  328</span>  }</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>  <span class="keyword">const</span> <span class="keyword">auto</span> final_nonslash_idx = export_dir.find_last_not_of(<span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  331</span>  <span class="keywordflow">if</span> (final_nonslash_idx == std::string::npos) {</div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordflow">return</span> Status::InvalidArgument(<span class="stringliteral">&quot;Specified export_dir invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  333</span>  }</div>
<div class="line"><span class="lineno">  334</span>  <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log,</div>
<div class="line"><span class="lineno">  335</span>                 <span class="stringliteral">&quot;[%s] export column family onto export directory %s&quot;</span>,</div>
<div class="line"><span class="lineno">  336</span>                 cf_name.c_str(), export_dir.c_str());</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>  <span class="comment">// Create a temporary export directory.</span></div>
<div class="line"><span class="lineno">  339</span>  <span class="keyword">const</span> <span class="keyword">auto</span> tmp_export_dir =</div>
<div class="line"><span class="lineno">  340</span>      export_dir.substr(0, final_nonslash_idx + 1) + <span class="stringliteral">&quot;.tmp&quot;</span>;</div>
<div class="line"><span class="lineno">  341</span>  s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#a4791003af6e944a9708441186cd23a25">CreateDir</a>(tmp_export_dir);</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>  <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">  344</span>    s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#afc36dd1b6dfc5be0955b690e1ddd528a">Flush</a>(ROCKSDB_NAMESPACE::FlushOptions(), handle);</div>
<div class="line"><span class="lineno">  345</span>  }</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>  ColumnFamilyMetaData db_metadata;</div>
<div class="line"><span class="lineno">  348</span>  <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">  349</span>    <span class="comment">// Export live sst files with file deletions disabled.</span></div>
<div class="line"><span class="lineno">  350</span>    s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a4ad5358caca9c50809d43460c5735f35">DisableFileDeletions</a>();</div>
<div class="line"><span class="lineno">  351</span>    <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">  352</span>      <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#aeb2575bd20f1e4ef3fc796e29ded2b51">GetColumnFamilyMetaData</a>(handle, &amp;db_metadata);</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>      s = <a class="code hl_function" href="#a88b2c0c9243be071a41002299b2143fb">ExportFilesInMetaData</a>(</div>
<div class="line"><span class="lineno">  355</span>          db_options, db_metadata,</div>
<div class="line"><span class="lineno">  356</span>          [&amp;](<span class="keyword">const</span> std::string&amp; src_dirname, <span class="keyword">const</span> std::string&amp; fname) {</div>
<div class="line"><span class="lineno">  357</span>            <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log, <span class="stringliteral">&quot;[%s] HardLinking %s&quot;</span>,</div>
<div class="line"><span class="lineno">  358</span>                           cf_name.c_str(), fname.c_str());</div>
<div class="line"><span class="lineno">  359</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#a6d73578a1298eec01e9f66f815082fc6">LinkFile</a>(src_dirname + fname,</div>
<div class="line"><span class="lineno">  360</span>                                           tmp_export_dir + fname);</div>
<div class="line"><span class="lineno">  361</span>          } <span class="comment">/*link_file_cb*/</span>,</div>
<div class="line"><span class="lineno">  362</span>          [&amp;](<span class="keyword">const</span> std::string&amp; src_dirname, <span class="keyword">const</span> std::string&amp; fname) {</div>
<div class="line"><span class="lineno">  363</span>            <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log, <span class="stringliteral">&quot;[%s] Copying %s&quot;</span>,</div>
<div class="line"><span class="lineno">  364</span>                           cf_name.c_str(), fname.c_str());</div>
<div class="line"><span class="lineno">  365</span>            <span class="comment">// FIXME: temperature handling</span></div>
<div class="line"><span class="lineno">  366</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a61bc5b537d7b9219309af2dbd66096a2">CopyFile</a>(<a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a0526c7049c12073f74b88f4497c212fc">GetFileSystem</a>(), src_dirname + fname,</div>
<div class="line"><span class="lineno">  367</span>                            Temperature::kUnknown, tmp_export_dir + fname,</div>
<div class="line"><span class="lineno">  368</span>                            Temperature::kUnknown, 0, db_options.use_fsync,</div>
<div class="line"><span class="lineno">  369</span>                            <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  370</span>          } <span class="comment">/*copy_file_cb*/</span>);</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>      <span class="keyword">const</span> <span class="keyword">auto</span> enable_status = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a76b598f2f07a7e961fa397a1cd65a013">EnableFileDeletions</a>();</div>
<div class="line"><span class="lineno">  373</span>      <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">  374</span>        s = enable_status;</div>
<div class="line"><span class="lineno">  375</span>      }</div>
<div class="line"><span class="lineno">  376</span>    }</div>
<div class="line"><span class="lineno">  377</span>  }</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>  <span class="keyword">auto</span> moved_to_user_specified_dir = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  380</span>  <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">  381</span>    <span class="comment">// Move temporary export directory to the actual export directory.</span></div>
<div class="line"><span class="lineno">  382</span>    s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#ab69c066e0f471bbc4020cccc32e2f496">RenameFile</a>(tmp_export_dir, export_dir);</div>
<div class="line"><span class="lineno">  383</span>  }</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>  <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">  386</span>    <span class="comment">// Fsync export directory.</span></div>
<div class="line"><span class="lineno">  387</span>    moved_to_user_specified_dir = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  388</span>    std::unique_ptr&lt;FSDirectory&gt; dir_ptr;</div>
<div class="line"><span class="lineno">  389</span>    s = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a0526c7049c12073f74b88f4497c212fc">GetFileSystem</a>()-&gt;<a class="code hl_function" href="../../d3/d26/classROCKSDB__NAMESPACE_1_1FileSystem.html#a3ffb5bf5aae1a721a29f0a31d427c33b">NewDirectory</a>(export_dir, IOOptions(), &amp;dir_ptr,</div>
<div class="line"><span class="lineno">  390</span>                                           <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">  392</span>      assert(dir_ptr != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  393</span>      s = dir_ptr-&gt;FsyncWithDirOptions(</div>
<div class="line"><span class="lineno">  394</span>          IOOptions(), <span class="keyword">nullptr</span>,</div>
<div class="line"><span class="lineno">  395</span>          DirFsyncOptions(DirFsyncOptions::FsyncReason::kDirRenamed));</div>
<div class="line"><span class="lineno">  396</span>    }</div>
<div class="line"><span class="lineno">  397</span>  }</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>  <span class="keywordflow">if</span> (s.ok()) {</div>
<div class="line"><span class="lineno">  400</span>    <span class="comment">// Export of files succeeded. Fill in the metadata information.</span></div>
<div class="line"><span class="lineno">  401</span>    <span class="keyword">auto</span> result_metadata = <span class="keyword">new</span> ExportImportFilesMetaData();</div>
<div class="line"><span class="lineno">  402</span>    result_metadata-&gt;db_comparator_name = handle-&gt;GetComparator()-&gt;Name();</div>
<div class="line"><span class="lineno">  403</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; level_metadata : db_metadata.levels) {</div>
<div class="line"><span class="lineno">  404</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; file_metadata : level_metadata.files) {</div>
<div class="line"><span class="lineno">  405</span>        LiveFileMetaData live_file_metadata;</div>
<div class="line"><span class="lineno">  406</span>        live_file_metadata.size = file_metadata.size;</div>
<div class="line"><span class="lineno">  407</span>        live_file_metadata.name = file_metadata.name;</div>
<div class="line"><span class="lineno">  408</span>        live_file_metadata.file_number = file_metadata.file_number;</div>
<div class="line"><span class="lineno">  409</span>        live_file_metadata.db_path = export_dir;</div>
<div class="line"><span class="lineno">  410</span>        live_file_metadata.smallest_seqno = file_metadata.smallest_seqno;</div>
<div class="line"><span class="lineno">  411</span>        live_file_metadata.largest_seqno = file_metadata.largest_seqno;</div>
<div class="line"><span class="lineno">  412</span>        live_file_metadata.smallestkey = file_metadata.smallestkey;</div>
<div class="line"><span class="lineno">  413</span>        live_file_metadata.largestkey = file_metadata.largestkey;</div>
<div class="line"><span class="lineno">  414</span>        live_file_metadata.oldest_blob_file_number =</div>
<div class="line"><span class="lineno">  415</span>            file_metadata.oldest_blob_file_number;</div>
<div class="line"><span class="lineno">  416</span>        live_file_metadata.epoch_number = file_metadata.epoch_number;</div>
<div class="line"><span class="lineno">  417</span>        live_file_metadata.level = level_metadata.level;</div>
<div class="line"><span class="lineno">  418</span>        live_file_metadata.smallest = file_metadata.smallest;</div>
<div class="line"><span class="lineno">  419</span>        live_file_metadata.largest = file_metadata.largest;</div>
<div class="line"><span class="lineno">  420</span>        result_metadata-&gt;files.push_back(live_file_metadata);</div>
<div class="line"><span class="lineno">  421</span>      }</div>
<div class="line"><span class="lineno">  422</span>      *metadata = result_metadata;</div>
<div class="line"><span class="lineno">  423</span>    }</div>
<div class="line"><span class="lineno">  424</span>    <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log, <span class="stringliteral">&quot;[%s] Export succeeded.&quot;</span>,</div>
<div class="line"><span class="lineno">  425</span>                   cf_name.c_str());</div>
<div class="line"><span class="lineno">  426</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  427</span>    <span class="comment">// Failure: Clean up all the files/directories created.</span></div>
<div class="line"><span class="lineno">  428</span>    <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log, <span class="stringliteral">&quot;[%s] Export failed. %s&quot;</span>,</div>
<div class="line"><span class="lineno">  429</span>                   cf_name.c_str(), s.ToString().c_str());</div>
<div class="line"><span class="lineno">  430</span>    std::vector&lt;std::string&gt; subchildren;</div>
<div class="line"><span class="lineno">  431</span>    <span class="keyword">const</span> <span class="keyword">auto</span> cleanup_dir =</div>
<div class="line"><span class="lineno">  432</span>        moved_to_user_specified_dir ? export_dir : tmp_export_dir;</div>
<div class="line"><span class="lineno">  433</span>    <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#ad821c7a23e52c37cab15fbaa14d31388">GetChildren</a>(cleanup_dir, &amp;subchildren);</div>
<div class="line"><span class="lineno">  434</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; subchild : subchildren) {</div>
<div class="line"><span class="lineno">  435</span>      <span class="keyword">const</span> <span class="keyword">auto</span> subchild_path = cleanup_dir + <span class="stringliteral">&quot;/&quot;</span> + subchild;</div>
<div class="line"><span class="lineno">  436</span>      <span class="keyword">const</span> <span class="keyword">auto</span> status = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#a1b83f773eb9d5293128c2270e7f6ca4a">DeleteFile</a>(subchild_path);</div>
<div class="line"><span class="lineno">  437</span>      <span class="keywordflow">if</span> (!status.ok()) {</div>
<div class="line"><span class="lineno">  438</span>        <a class="code hl_define" href="../../d5/d77/logging_8h.html#aa53b5d1833cb5871cd658a60fd09291f">ROCKS_LOG_WARN</a>(db_options.info_log, <span class="stringliteral">&quot;Failed to cleanup file %s: %s&quot;</span>,</div>
<div class="line"><span class="lineno">  439</span>                       subchild_path.c_str(), status.ToString().c_str());</div>
<div class="line"><span class="lineno">  440</span>      }</div>
<div class="line"><span class="lineno">  441</span>    }</div>
<div class="line"><span class="lineno">  442</span>    <span class="keyword">const</span> <span class="keyword">auto</span> status = <a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#ab8edb16b3bf7f9fb5871ac547d53472b">GetEnv</a>()-&gt;<a class="code hl_function" href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#a5092f628ea8316e17d9fa83f47849a06">DeleteDir</a>(cleanup_dir);</div>
<div class="line"><span class="lineno">  443</span>    <span class="keywordflow">if</span> (!status.ok()) {</div>
<div class="line"><span class="lineno">  444</span>      <a class="code hl_define" href="../../d5/d77/logging_8h.html#aa53b5d1833cb5871cd658a60fd09291f">ROCKS_LOG_WARN</a>(db_options.info_log, <span class="stringliteral">&quot;Failed to cleanup dir %s: %s&quot;</span>,</div>
<div class="line"><span class="lineno">  445</span>                     cleanup_dir.c_str(), status.ToString().c_str());</div>
<div class="line"><span class="lineno">  446</span>    }</div>
<div class="line"><span class="lineno">  447</span>  }</div>
<div class="line"><span class="lineno">  448</span>  <span class="keywordflow">return</span> s;</div>
<div class="line"><span class="lineno">  449</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1CheckpointImpl_html_a88b2c0c9243be071a41002299b2143fb"><div class="ttname"><a href="#a88b2c0c9243be071a41002299b2143fb">ROCKSDB_NAMESPACE::CheckpointImpl::ExportFilesInMetaData</a></div><div class="ttdeci">Status ExportFilesInMetaData(const DBOptions &amp;db_options, const ColumnFamilyMetaData &amp;metadata, std::function&lt; Status(const std::string &amp;src_dirname, const std::string &amp;fname)&gt; link_file_cb, std::function&lt; Status(const std::string &amp;src_dirname, const std::string &amp;fname)&gt; copy_file_cb)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/dce/checkpoint__impl_8cc_source.html#l00451">checkpoint_impl.cc:451</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1DB_html_aeb2575bd20f1e4ef3fc796e29ded2b51"><div class="ttname"><a href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#aeb2575bd20f1e4ef3fc796e29ded2b51">ROCKSDB_NAMESPACE::DB::GetColumnFamilyMetaData</a></div><div class="ttdeci">virtual void GetColumnFamilyMetaData(ColumnFamilyHandle *, ColumnFamilyMetaData *)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d43/include_2rocksdb_2db_8h_source.html#l01810">db.h:1810</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1DB_html_afc36dd1b6dfc5be0955b690e1ddd528a"><div class="ttname"><a href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#afc36dd1b6dfc5be0955b690e1ddd528a">ROCKSDB_NAMESPACE::DB::Flush</a></div><div class="ttdeci">virtual Status Flush(const FlushOptions &amp;options, ColumnFamilyHandle *column_family)=0</div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1Env_html_a6d73578a1298eec01e9f66f815082fc6"><div class="ttname"><a href="../../df/d9b/classROCKSDB__NAMESPACE_1_1Env.html#a6d73578a1298eec01e9f66f815082fc6">ROCKSDB_NAMESPACE::Env::LinkFile</a></div><div class="ttdeci">virtual Status LinkFile(const std::string &amp;, const std::string &amp;)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d81/env_8h_source.html#l00386">env.h:386</a></div></div>
<div class="ttc" id="alogging_8h_html_aa53b5d1833cb5871cd658a60fd09291f"><div class="ttname"><a href="../../d5/d77/logging_8h.html#aa53b5d1833cb5871cd658a60fd09291f">ROCKS_LOG_WARN</a></div><div class="ttdeci">#define ROCKS_LOG_WARN(LGR, FMT,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d77/logging_8h_source.html#l00041">logging.h:41</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_affaa3247c6b4fe65cf3b2d8a8f37a0e5_cgraph.png" border="0" usemap="#ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_affaa3247c6b4fe65cf3b2d8a8f37a0e5_cgraph" alt=""/></div>
<map name="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_affaa3247c6b4fe65cf3b2d8a8f37a0e5_cgraph" id="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_affaa3247c6b4fe65cf3b2d8a8f37a0e5_cgraph">
<area shape="rect" title=" " alt="" coords="5,630,229,692"/>
<area shape="poly" title=" " alt="" coords="66,630,67,620,77,611,93,605,117,604,144,606,161,613,159,618,143,611,117,609,94,611,79,616,72,622,71,630"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a61bc5b537d7b9219309af2dbd66096a2" title=" " alt="" coords="287,237,468,282"/>
<area shape="poly" title=" " alt="" coords="136,628,352,294,356,296,141,631"/>
<area shape="rect" href="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl.html#a88b2c0c9243be071a41002299b2143fb" title=" " alt="" coords="277,506,479,568"/>
<area shape="poly" title=" " alt="" coords="176,627,276,577,287,572,289,577,278,582,178,632"/>
<area shape="rect" href="../../da/d3d/classROCKSDB__NAMESPACE_1_1ColumnFamilyHandle.html#a67cfd02870c29500838fe2439e07dfb4" title=" " alt="" coords="287,592,468,653"/>
<area shape="poly" title=" " alt="" coords="229,642,271,635,272,641,230,647"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a5fdd2c6692215a7d1894f2052ffc5609" title=" " alt="" coords="287,677,468,722"/>
<area shape="poly" title=" " alt="" coords="230,675,272,681,271,687,229,680"/>
<area shape="rect" href="../../dc/d3f/classROCKSDB__NAMESPACE_1_1Comparator.html#a6ae11360523ccd8358289fc3b2fd1dd3" title=" " alt="" coords="287,747,468,791"/>
<area shape="poly" title=" " alt="" coords="183,690,278,732,294,738,292,743,276,737,181,695"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#abfbc137fc639f1f3dce840cdb45f588c" title=" " alt="" coords="287,840,468,885"/>
<area shape="poly" title=" " alt="" coords="151,690,208,744,278,802,322,830,319,834,275,806,205,748,147,694"/>
<area shape="poly" title=" " alt="" coords="329,237,327,227,336,218,352,213,378,211,406,213,422,220,420,225,405,218,378,216,353,218,338,223,332,229,334,236"/>
<area shape="rect" href="../../d4/d77/classROCKSDB__NAMESPACE_1_1IOStatus.html#a76acbf601e7a94bf9b975c7317612fe8" title=" " alt="" coords="546,29,728,74"/>
<area shape="poly" title=" " alt="" coords="390,235,443,161,482,120,525,84,534,79,537,84,529,89,485,124,447,165,395,239"/>
<area shape="rect" href="../../d3/d26/classROCKSDB__NAMESPACE_1_1FileSystem.html#aaeb7fe642962682038a301ffd73c4242" title=" " alt="" coords="546,99,728,143"/>
<area shape="poly" title=" " alt="" coords="404,235,459,194,526,153,539,147,542,152,528,158,462,198,408,239"/>
<area shape="rect" href="../../d3/d26/classROCKSDB__NAMESPACE_1_1FileSystem.html#ac8298a902e5ad7cd14294df072caf9e5" title=" " alt="" coords="527,168,747,213"/>
<area shape="poly" title=" " alt="" coords="464,234,536,215,537,220,465,239"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a44cf4d9e0f59181d4838378a46b41c73" title=" " alt="" coords="546,376,728,421"/>
<area shape="poly" title=" " alt="" coords="408,280,462,321,528,361,542,367,539,372,526,366,459,325,404,284"/>
<area shape="rect" href="../../de/dc6/classROCKSDB__NAMESPACE_1_1Slice.html#a47c51c16ecee27b619768f1b817a342c" title=" " alt="" coords="546,237,728,282"/>
<area shape="poly" title=" " alt="" coords="469,257,531,257,531,262,469,262"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a82cbdaebf691c6ce25d631dda5ae8ed5" title=" " alt="" coords="546,307,728,351"/>
<area shape="poly" title=" " alt="" coords="465,280,537,300,536,305,464,285"/>
<area shape="rect" href="../../d4/d77/classROCKSDB__NAMESPACE_1_1IOStatus.html#afbd1ef4e0d59793126a5384681f793e2" title=" " alt="" coords="795,29,977,74"/>
<area shape="poly" title=" " alt="" coords="728,49,780,49,780,54,728,54"/>
<area shape="poly" title=" " alt="" coords="842,29,841,19,848,10,863,5,886,3,911,5,926,12,923,17,909,10,886,8,865,10,851,15,846,21,847,28"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#afc660ff45fc7c890834fd65eb0ee6c9c" title=" " alt="" coords="795,411,977,455"/>
<area shape="poly" title=" " alt="" coords="729,408,780,416,780,421,728,414"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#acf8261295e4ab4ec8c132ed51b6feb71" title=" " alt="" coords="1025,411,1206,455"/>
<area shape="poly" title=" " alt="" coords="728,390,847,388,977,396,1023,404,1022,409,976,401,847,393,728,395"/>
<area shape="poly" title=" " alt="" coords="977,430,1009,430,1009,436,977,436"/>
<area shape="poly" title=" " alt="" coords="415,504,466,466,526,431,539,424,542,429,528,435,469,471,418,508"/>
<area shape="poly" title=" " alt="" coords="327,506,328,496,338,487,354,481,378,480,405,482,422,489,419,494,404,487,378,485,355,487,341,492,333,498,332,506"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a41dc92b90c65fe4db6b69108cf52569e" title=" " alt="" coords="546,515,728,559"/>
<area shape="poly" title=" " alt="" coords="480,534,531,534,531,540,480,540"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a74251af128f4cf6beb4e1fadf77d717d" title=" " alt="" coords="546,445,728,490"/>
<area shape="poly" title=" " alt="" coords="479,507,536,492,537,497,480,512"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a68c941da5f3083ca54122b381139b65b" title=" " alt="" coords="546,584,728,629"/>
<area shape="poly" title=" " alt="" coords="480,562,537,577,536,582,479,567"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a7d87aaca453b4f1ca5f4475ef9b0ff31" title=" " alt="" coords="546,677,728,722"/>
<area shape="poly" title=" " alt="" coords="463,566,481,578,496,593,506,609,514,623,529,639,571,667,568,672,525,643,510,627,501,611,492,597,477,582,460,570"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a9f76d02ed8e41702a1388cd092a12464" title=" " alt="" coords="795,584,977,629"/>
<area shape="poly" title=" " alt="" coords="721,557,789,577,788,582,719,563"/>
<area shape="poly" title=" " alt="" coords="728,452,780,445,780,450,729,458"/>
<area shape="poly" title=" " alt="" coords="728,471,847,473,976,465,1022,457,1023,462,977,470,847,478,728,476"/>
<area shape="poly" title=" " alt="" coords="728,604,780,604,780,609,728,609"/>
<area shape="poly" title=" " alt="" coords="590,677,588,667,596,658,613,653,637,651,664,653,680,660,678,665,663,658,637,656,614,658,599,663,594,669,595,676"/>
<area shape="poly" title=" " alt="" coords="443,720,508,737,586,750,626,752,667,750,708,744,746,732,780,714,810,690,858,639,862,643,814,694,783,718,748,737,709,749,668,755,626,757,585,755,507,743,442,725"/>
<area shape="poly" title=" " alt="" coords="329,840,327,830,336,821,352,815,378,813,406,816,422,822,420,827,405,821,378,819,353,821,338,825,332,831,334,839"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_affaa3247c6b4fe65cf3b2d8a8f37a0e5_icgraph.png" border="0" usemap="#ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_affaa3247c6b4fe65cf3b2d8a8f37a0e5_icgraph" alt=""/></div>
<map name="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_affaa3247c6b4fe65cf3b2d8a8f37a0e5_icgraph" id="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_affaa3247c6b4fe65cf3b2d8a8f37a0e5_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,229,91"/>
<area shape="poly" title=" " alt="" coords="153,17,139,11,117,8,98,10,85,15,79,21,78,29,73,29,74,19,82,10,97,5,117,3,141,5,155,13"/>
</map>
</div>

</div>
</div>
<a id="a88b2c0c9243be071a41002299b2143fb" name="a88b2c0c9243be071a41002299b2143fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b2c0c9243be071a41002299b2143fb">&#9670;&#160;</a></span>ExportFilesInMetaData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a> ROCKSDB_NAMESPACE::CheckpointImpl::ExportFilesInMetaData </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d8/d57/structROCKSDB__NAMESPACE_1_1DBOptions.html">DBOptions</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>db_options</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/dfc/structROCKSDB__NAMESPACE_1_1ColumnFamilyMetaData.html">ColumnFamilyMetaData</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>metadata</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; <a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>(const std::string &amp;src_dirname, const std::string &amp;fname)&gt;</td>          <td class="paramname"><span class="paramname"><em>link_file_cb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; <a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>(const std::string &amp;src_dirname, const std::string &amp;fname)&gt;</td>          <td class="paramname"><span class="paramname"><em>copy_file_cb</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d2/dce/checkpoint__impl_8cc_source.html">checkpoint_impl.cc</a> 파일의 <a class="el" href="../../d2/dce/checkpoint__impl_8cc_source.html#l00451">451</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  458</span>                      {</div>
<div class="line"><span class="lineno">  459</span>  Status s;</div>
<div class="line"><span class="lineno">  460</span>  <span class="keyword">auto</span> hardlink_file = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>  <span class="comment">// Copy/hard link files in metadata.</span></div>
<div class="line"><span class="lineno">  463</span>  <span class="keywordtype">size_t</span> num_files = 0;</div>
<div class="line"><span class="lineno">  464</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; level_metadata : metadata.levels) {</div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; file_metadata : level_metadata.files) {</div>
<div class="line"><span class="lineno">  466</span>      uint64_t number;</div>
<div class="line"><span class="lineno">  467</span>      <a class="code hl_enumeration" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a572c40b059615a4b9755748d810fc3ad">FileType</a> <a class="code hl_variable" href="../../d7/de8/namespaceadvisor_1_1config__optimizer__example.html#af6e0d4caf2e04f0e18ae85aaaab5c6ae">type</a>;</div>
<div class="line"><span class="lineno">  468</span>      <span class="keyword">const</span> <span class="keyword">auto</span> ok = <a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a7d87aaca453b4f1ca5f4475ef9b0ff31">ParseFileName</a>(file_metadata.name, &amp;number, &amp;type);</div>
<div class="line"><span class="lineno">  469</span>      <span class="keywordflow">if</span> (!ok) {</div>
<div class="line"><span class="lineno">  470</span>        s = Status::Corruption(<span class="stringliteral">&quot;Could not parse file name&quot;</span>);</div>
<div class="line"><span class="lineno">  471</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  472</span>      }</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>      <span class="comment">// We should only get sst files here.</span></div>
<div class="line"><span class="lineno">  475</span>      assert(type == kTableFile);</div>
<div class="line"><span class="lineno">  476</span>      assert(file_metadata.size &gt; 0 &amp;&amp; file_metadata.name[0] == <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  477</span>      <span class="keyword">const</span> <span class="keyword">auto</span> src_fname = file_metadata.name;</div>
<div class="line"><span class="lineno">  478</span>      ++num_files;</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>      <span class="keywordflow">if</span> (hardlink_file) {</div>
<div class="line"><span class="lineno">  481</span>        s = link_file_cb(<a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a2d5977d71491509705e6bf9bcb6bddcf">GetName</a>(), src_fname);</div>
<div class="line"><span class="lineno">  482</span>        <span class="keywordflow">if</span> (num_files == 1 &amp;&amp; s.IsNotSupported()) {</div>
<div class="line"><span class="lineno">  483</span>          <span class="comment">// Fallback to copy if link failed due to cross-device directories.</span></div>
<div class="line"><span class="lineno">  484</span>          hardlink_file = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  485</span>          s = Status::OK();</div>
<div class="line"><span class="lineno">  486</span>        }</div>
<div class="line"><span class="lineno">  487</span>      }</div>
<div class="line"><span class="lineno">  488</span>      <span class="keywordflow">if</span> (!hardlink_file) {</div>
<div class="line"><span class="lineno">  489</span>        s = copy_file_cb(<a class="code hl_variable" href="#adbe040b610cac2898463c9d0f3dc46c4">db_</a>-&gt;<a class="code hl_function" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a2d5977d71491509705e6bf9bcb6bddcf">GetName</a>(), src_fname);</div>
<div class="line"><span class="lineno">  490</span>      }</div>
<div class="line"><span class="lineno">  491</span>      <span class="keywordflow">if</span> (!s.ok()) {</div>
<div class="line"><span class="lineno">  492</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  493</span>      }</div>
<div class="line"><span class="lineno">  494</span>    }</div>
<div class="line"><span class="lineno">  495</span>  }</div>
<div class="line"><span class="lineno">  496</span>  <a class="code hl_define" href="../../d5/d77/logging_8h.html#a7f6160596d40ac57e3d9b68b40d7fc1c">ROCKS_LOG_INFO</a>(db_options.info_log, <span class="stringliteral">&quot;Number of table files %&quot;</span> <a class="code hl_define" href="../../dc/d7c/port__posix_8h.html#a7b788074056bbe1d81914a538d26afe1">ROCKSDB_PRIszt</a>,</div>
<div class="line"><span class="lineno">  497</span>                 num_files);</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>  <span class="keywordflow">return</span> s;</div>
<div class="line"><span class="lineno">  500</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1DB_html_a2d5977d71491509705e6bf9bcb6bddcf"><div class="ttname"><a href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html#a2d5977d71491509705e6bf9bcb6bddcf">ROCKSDB_NAMESPACE::DB::GetName</a></div><div class="ttdeci">virtual const std::string &amp; GetName() const =0</div></div>
<div class="ttc" id="anamespaceROCKSDB__NAMESPACE_html_a7d87aaca453b4f1ca5f4475ef9b0ff31"><div class="ttname"><a href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a7d87aaca453b4f1ca5f4475ef9b0ff31">ROCKSDB_NAMESPACE::ParseFileName</a></div><div class="ttdeci">bool ParseFileName(const std::string &amp;fname, uint64_t *number, FileType *type, WalFileType *log_type)</div><div class="ttdef"><b>Definition</b> <a href="../../de/d86/filename_8cc_source.html#l00268">filename.cc:268</a></div></div>
<div class="ttc" id="anamespaceadvisor_1_1config__optimizer__example_html_af6e0d4caf2e04f0e18ae85aaaab5c6ae"><div class="ttname"><a href="../../d7/de8/namespaceadvisor_1_1config__optimizer__example.html#af6e0d4caf2e04f0e18ae85aaaab5c6ae">advisor.config_optimizer_example.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d22/config__optimizer__example_8py_source.html#l00072">config_optimizer_example.py:72</a></div></div>
<div class="ttc" id="aport__posix_8h_html_a7b788074056bbe1d81914a538d26afe1"><div class="ttname"><a href="../../dc/d7c/port__posix_8h.html#a7b788074056bbe1d81914a538d26afe1">ROCKSDB_PRIszt</a></div><div class="ttdeci">#define ROCKSDB_PRIszt</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d7c/port__posix_8h_source.html#l00022">port_posix.h:22</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a88b2c0c9243be071a41002299b2143fb_cgraph.png" border="0" usemap="#ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a88b2c0c9243be071a41002299b2143fb_cgraph" alt=""/></div>
<map name="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a88b2c0c9243be071a41002299b2143fb_cgraph" id="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a88b2c0c9243be071a41002299b2143fb_cgraph">
<area shape="rect" title=" " alt="" coords="5,136,208,197"/>
<area shape="poly" title=" " alt="" coords="59,135,61,125,69,116,85,111,107,109,132,112,147,119,145,124,130,117,106,114,86,116,72,121,65,127,65,136"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a41dc92b90c65fe4db6b69108cf52569e" title=" " alt="" coords="256,5,437,50"/>
<area shape="poly" title=" " alt="" coords="145,133,196,96,254,60,265,54,268,59,257,65,199,100,148,137"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a74251af128f4cf6beb4e1fadf77d717d" title=" " alt="" coords="256,144,437,189"/>
<area shape="poly" title=" " alt="" coords="208,164,240,164,240,169,208,169"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a68c941da5f3083ca54122b381139b65b" title=" " alt="" coords="256,75,437,119"/>
<area shape="poly" title=" " alt="" coords="207,134,251,122,252,127,209,140"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a44cf4d9e0f59181d4838378a46b41c73" title=" " alt="" coords="256,213,437,258"/>
<area shape="poly" title=" " alt="" coords="209,193,252,206,251,211,207,198"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a7d87aaca453b4f1ca5f4475ef9b0ff31" title=" " alt="" coords="256,307,437,351"/>
<area shape="poly" title=" " alt="" coords="153,195,257,268,299,296,296,300,254,273,150,200"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#a9f76d02ed8e41702a1388cd092a12464" title=" " alt="" coords="485,40,666,85"/>
<area shape="poly" title=" " alt="" coords="438,39,470,44,469,49,437,44"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#afc660ff45fc7c890834fd65eb0ee6c9c" title=" " alt="" coords="485,183,666,227"/>
<area shape="poly" title=" " alt="" coords="438,179,470,185,469,190,437,184"/>
<area shape="rect" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html#acf8261295e4ab4ec8c132ed51b6feb71" title=" " alt="" coords="714,183,896,227"/>
<area shape="poly" title=" " alt="" coords="437,159,547,159,667,168,712,176,711,181,666,173,547,164,437,165"/>
<area shape="poly" title=" " alt="" coords="667,202,699,202,699,208,667,208"/>
<area shape="poly" title=" " alt="" coords="437,81,469,76,470,81,438,86"/>
<area shape="poly" title=" " alt="" coords="437,221,469,217,470,222,438,226"/>
<area shape="poly" title=" " alt="" coords="438,241,547,244,666,237,712,229,712,234,667,242,547,249,438,246"/>
<area shape="poly" title=" " alt="" coords="302,307,301,297,309,288,324,282,346,280,371,283,386,289,384,294,370,288,346,285,325,287,312,292,306,298,308,306"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a88b2c0c9243be071a41002299b2143fb_icgraph.png" border="0" usemap="#ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a88b2c0c9243be071a41002299b2143fb_icgraph" alt=""/></div>
<map name="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a88b2c0c9243be071a41002299b2143fb_icgraph" id="ad0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl_a88b2c0c9243be071a41002299b2143fb_icgraph">
<area shape="rect" title=" " alt="" coords="277,29,479,91"/>
<area shape="poly" title=" " alt="" coords="420,17,404,11,378,8,355,10,340,15,333,21,332,29,327,29,328,19,338,10,354,5,378,3,405,5,422,13"/>
<area shape="rect" href="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl.html#affaa3247c6b4fe65cf3b2d8a8f37a0e5" title=" " alt="" coords="5,29,229,91"/>
<area shape="poly" title=" " alt="" coords="261,63,229,63,229,58,261,58"/>
<area shape="poly" title=" " alt="" coords="159,17,143,11,117,8,94,10,79,15,72,21,71,29,66,29,67,19,77,10,93,5,117,3,144,5,161,13"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">멤버 데이터 문서화</h2>
<a id="adbe040b610cac2898463c9d0f3dc46c4" name="adbe040b610cac2898463c9d0f3dc46c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbe040b610cac2898463c9d0f3dc46c4">&#9670;&#160;</a></span>db_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/dc0/classROCKSDB__NAMESPACE_1_1DB.html">DB</a>* ROCKSDB_NAMESPACE::CheckpointImpl::db_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../dc/d30/checkpoint__impl_8h_source.html">checkpoint_impl.h</a> 파일의 <a class="el" href="../../dc/d30/checkpoint__impl_8h_source.html#l00060">60</a> 번째 라인에서 정의되었습니다.</p>

</div>
</div>
<hr/>이 클래스에 대한 문서화 페이지는 다음의 파일들로부터 생성되었습니다.:<ul>
<li>utilities/checkpoint/<a class="el" href="../../dc/d30/checkpoint__impl_8h_source.html">checkpoint_impl.h</a></li>
<li>utilities/checkpoint/<a class="el" href="../../d2/dce/checkpoint__impl_8cc_source.html">checkpoint_impl.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html">ROCKSDB_NAMESPACE</a></li><li class="navelem"><a class="el" href="../../d0/dc3/classROCKSDB__NAMESPACE_1_1CheckpointImpl.html">CheckpointImpl</a></li>
    <li class="footer">다음에 의해 생성됨 :  <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
