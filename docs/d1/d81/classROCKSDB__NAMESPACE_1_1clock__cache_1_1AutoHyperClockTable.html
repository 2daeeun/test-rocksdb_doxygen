<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RocksDB Doxygen: ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable 클래스 참조</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RocksDB Doxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 다음에 의해 생성됨 :  Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','검색',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">로딩중...</div>
<div class="SRStatus" id="Searching">검색중...</div>
<div class="SRStatus" id="NoMatches">일치하는것 없음</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">클래스</a> &#124;
<a href="#pub-methods">Public 멤버 함수</a> &#124;
<a href="#pub-static-attribs">정적 Public 속성</a> &#124;
<a href="#pri-methods">Private 멤버 함수</a> &#124;
<a href="#pri-static-methods">정적 Private 멤버 함수</a> &#124;
<a href="#pri-attribs">Private 속성</a> &#124;
<a href="../../d7/d1e/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable-members.html">모든 멤버 목록</a>  </div>
  <div class="headertitle"><div class="title">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable 클래스 참조</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../db/d81/clock__cache_8h_source.html">clock_cache.h</a>&gt;</code></p>
<div class="dynheader">
ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable에 대한 상속 다이어그램 : </div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d8e/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable__inherit__graph.png" border="0" usemap="#aROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_inherit__map" alt="Inheritance graph"/></div>
<map name="aROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_inherit__map" id="aROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_inherit__map">
<area shape="rect" title=" " alt="" coords="5,98,219,160"/>
<area shape="rect" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html" title=" " alt="" coords="7,5,217,50"/>
<area shape="poly" title=" " alt="" coords="115,65,115,98,109,98,109,65"/>
</map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">범례</a>]</span></center></div>
<div class="dynheader">
ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable에 대한 협력 다이어그램:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/dfd/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable__coll__graph.png" border="0" usemap="#aROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_coll__map" alt="Collaboration graph"/></div>
<map name="aROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_coll__map" id="aROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_coll__map">
<area shape="rect" title=" " alt="" coords="1275,281,1489,342"/>
<area shape="rect" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html" title=" " alt="" coords="912,165,1122,210"/>
<area shape="poly" title=" " alt="" coords="1100,213,1290,278,1288,283,1098,218"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html" title=" " alt="" coords="474,5,677,50"/>
<area shape="poly" title=" " alt="" coords="633,55,702,84,747,95,784,100,821,104,867,116,924,138,974,162,972,167,922,143,865,121,820,110,783,105,746,101,700,89,631,60"/>
<area shape="rect" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html" title=" " alt="" coords="919,13,1114,58"/>
<area shape="poly" title=" " alt="" coords="692,11,701,10,784,7,866,10,919,16,918,21,866,16,784,12,701,16,693,16"/>
<area shape="rect" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html" title=" " alt="" coords="485,225,666,270"/>
<area shape="poly" title=" " alt="" coords="682,246,772,242,866,230,952,208,953,213,866,236,772,247,682,251"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html" title=" " alt="" coords="236,276,424,321"/>
<area shape="poly" title=" " alt="" coords="440,304,701,318,1014,320,1275,313,1275,319,1014,325,701,324,440,309"/>
<area shape="poly" title=" " alt="" coords="439,273,484,264,485,269,440,278"/>
<area shape="rect" href="../../d1/d8f/classROCKSDB__NAMESPACE_1_1MemoryAllocator.html" title=" " alt="" coords="485,108,666,153"/>
<area shape="poly" title=" " alt="" coords="682,136,866,157,912,164,911,170,866,162,681,141"/>
<area shape="rect" href="../../d0/deb/classROCKSDB__NAMESPACE_1_1Customizable.html" title=" " alt="" coords="240,108,421,153"/>
<area shape="poly" title=" " alt="" coords="437,128,484,128,484,133,437,133"/>
<area shape="rect" href="../../da/dc0/classROCKSDB__NAMESPACE_1_1Configurable.html" title=" " alt="" coords="5,108,187,153"/>
<area shape="poly" title=" " alt="" coords="202,128,239,128,239,133,202,133"/>
<area shape="rect" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html" title=" " alt="" coords="890,365,1143,410"/>
<area shape="poly" title=" " alt="" coords="1158,377,1251,361,1311,341,1313,346,1252,366,1159,382"/>
<area shape="rect" href="../../d2/d18/classROCKSDB__NAMESPACE_1_1MemMapping.html" title=" " alt="" coords="485,365,666,410"/>
<area shape="poly" title=" " alt="" coords="682,385,889,385,889,390,682,390"/>
<area shape="poly" title=" " alt="" coords="1061,65,1341,278,1338,283,1058,69"/>
</map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">범례</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
클래스</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html">ChainRewriteLock</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dbb/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1InsertState.html">InsertState</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dc8/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1Opts.html">Opts</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public 멤버 함수</h2></td></tr>
<tr class="memitem:a9616b2306e5efc8080bd3f56e3d59945" id="r_a9616b2306e5efc8080bd3f56e3d59945"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9616b2306e5efc8080bd3f56e3d59945">AutoHyperClockTable</a> (size_t capacity, <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#ad6fbfb4d192b433af6ebde26a12775dc">CacheMetadataChargePolicy</a> metadata_charge_policy, <a class="el" href="../../d1/d8f/classROCKSDB__NAMESPACE_1_1MemoryAllocator.html">MemoryAllocator</a> *allocator, const <a class="el" href="../../d2/d0d/classROCKSDB__NAMESPACE_1_1Cache.html#af94e718286ee6148eacb1e95808c2399">Cache::EvictionCallback</a> *eviction_callback, const uint32_t *hash_seed, const <a class="el" href="../../de/dc8/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1Opts.html">Opts</a> &amp;opts)</td></tr>
<tr class="separator:a9616b2306e5efc8080bd3f56e3d59945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a696abeb6e3bbbb60bba3865b715721fc" id="r_a696abeb6e3bbbb60bba3865b715721fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a696abeb6e3bbbb60bba3865b715721fc">~AutoHyperClockTable</a> ()</td></tr>
<tr class="separator:a696abeb6e3bbbb60bba3865b715721fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6679dbb26ab8882954a473b50bac5082" id="r_a6679dbb26ab8882954a473b50bac5082"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6679dbb26ab8882954a473b50bac5082">StartInsert</a> (<a class="el" href="../../db/dbb/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1InsertState.html">InsertState</a> &amp;state)</td></tr>
<tr class="separator:a6679dbb26ab8882954a473b50bac5082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8566ed911e3ebb602e88d9abf773ac0" id="r_ae8566ed911e3ebb602e88d9abf773ac0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae8566ed911e3ebb602e88d9abf773ac0">GrowIfNeeded</a> (size_t new_occupancy, <a class="el" href="../../db/dbb/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1InsertState.html">InsertState</a> &amp;state)</td></tr>
<tr class="separator:ae8566ed911e3ebb602e88d9abf773ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ff266928e356a814d3a1688aedaac56" id="r_a6ff266928e356a814d3a1688aedaac56"><td class="memItemLeft" align="right" valign="top">HandleImpl *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ff266928e356a814d3a1688aedaac56">DoInsert</a> (const <a class="el" href="../../d1/d57/structROCKSDB__NAMESPACE_1_1clock__cache_1_1ClockHandleBasicData.html">ClockHandleBasicData</a> &amp;proto, uint64_t initial_countdown, bool take_ref, <a class="el" href="../../db/dbb/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1InsertState.html">InsertState</a> &amp;state)</td></tr>
<tr class="separator:a6ff266928e356a814d3a1688aedaac56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9055868cef9d318a6d4bc97cc2f55c8d" id="r_a9055868cef9d318a6d4bc97cc2f55c8d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9055868cef9d318a6d4bc97cc2f55c8d">Evict</a> (size_t requested_charge, <a class="el" href="../../db/dbb/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1InsertState.html">InsertState</a> &amp;state, <a class="el" href="../../d4/d35/structROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_1_1EvictionData.html">EvictionData</a> *data, uint32_t eviction_effort_cap)</td></tr>
<tr class="separator:a9055868cef9d318a6d4bc97cc2f55c8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9c1fa5039809f0efeb200afc4db8bf8" id="r_af9c1fa5039809f0efeb200afc4db8bf8"><td class="memItemLeft" align="right" valign="top">HandleImpl *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af9c1fa5039809f0efeb200afc4db8bf8">Lookup</a> (const <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af4c4e4074a950ca9c8bc7e635a784bf7">UniqueId64x2</a> &amp;hashed_key)</td></tr>
<tr class="separator:af9c1fa5039809f0efeb200afc4db8bf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ad5ee767437cfef149d7effdf2b97a4" id="r_a8ad5ee767437cfef149d7effdf2b97a4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8ad5ee767437cfef149d7effdf2b97a4">Release</a> (HandleImpl *handle, bool useful, bool erase_if_last_ref)</td></tr>
<tr class="separator:a8ad5ee767437cfef149d7effdf2b97a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5b762aa6657b81ad29f6cd51ea9f305" id="r_aa5b762aa6657b81ad29f6cd51ea9f305"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa5b762aa6657b81ad29f6cd51ea9f305">Erase</a> (const <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af4c4e4074a950ca9c8bc7e635a784bf7">UniqueId64x2</a> &amp;hashed_key)</td></tr>
<tr class="separator:aa5b762aa6657b81ad29f6cd51ea9f305"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acecc474c0a88e9db56f62463c297fee0" id="r_acecc474c0a88e9db56f62463c297fee0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acecc474c0a88e9db56f62463c297fee0">EraseUnRefEntries</a> ()</td></tr>
<tr class="separator:acecc474c0a88e9db56f62463c297fee0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a064c2e0057bdd3eff5edb1537bffd356" id="r_a064c2e0057bdd3eff5edb1537bffd356"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a064c2e0057bdd3eff5edb1537bffd356">GetTableSize</a> () const</td></tr>
<tr class="separator:a064c2e0057bdd3eff5edb1537bffd356"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a950fc9e7f613a8e924d472af6dba928c" id="r_a950fc9e7f613a8e924d472af6dba928c"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a950fc9e7f613a8e924d472af6dba928c">GetOccupancyLimit</a> () const</td></tr>
<tr class="separator:a950fc9e7f613a8e924d472af6dba928c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a065e2e75fb96e28f35e3c404244e4c5d" id="r_a065e2e75fb96e28f35e3c404244e4c5d"><td class="memItemLeft" align="right" valign="top">const HandleImpl *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a065e2e75fb96e28f35e3c404244e4c5d">HandlePtr</a> (size_t idx) const</td></tr>
<tr class="separator:a065e2e75fb96e28f35e3c404244e4c5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a899a03cabc8d3f3f1bc371d432c68551" id="r_a899a03cabc8d3f3f1bc371d432c68551"><td class="memItemLeft" align="right" valign="top">size_t &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a899a03cabc8d3f3f1bc371d432c68551">TEST_MutableOccupancyLimit</a> ()</td></tr>
<tr class="separator:a899a03cabc8d3f3f1bc371d432c68551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9b12764aa02fbbf9120fb96ed552cf7" id="r_af9b12764aa02fbbf9120fb96ed552cf7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af9b12764aa02fbbf9120fb96ed552cf7">TEST_ReleaseN</a> (HandleImpl *handle, size_t n)</td></tr>
<tr class="separator:af9b12764aa02fbbf9120fb96ed552cf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable')"><img src="../../closed.png" alt="-"/>&#160;<a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html">ROCKSDB_NAMESPACE::clock_cache::BaseClockTable</a>(으)로부터 상속된 Public 멤버 함수</td></tr>
<tr class="memitem:a589b754f612e4acebf3403fd26f9a43e inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_a589b754f612e4acebf3403fd26f9a43e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a589b754f612e4acebf3403fd26f9a43e">BaseClockTable</a> (<a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#ad6fbfb4d192b433af6ebde26a12775dc">CacheMetadataChargePolicy</a> metadata_charge_policy, <a class="el" href="../../d1/d8f/classROCKSDB__NAMESPACE_1_1MemoryAllocator.html">MemoryAllocator</a> *allocator, const <a class="el" href="../../d2/d0d/classROCKSDB__NAMESPACE_1_1Cache.html#af94e718286ee6148eacb1e95808c2399">Cache::EvictionCallback</a> *eviction_callback, const uint32_t *hash_seed)</td></tr>
<tr class="separator:a589b754f612e4acebf3403fd26f9a43e inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbc95f17b3d2608b533954a2b123e893 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_abbc95f17b3d2608b533954a2b123e893"><td class="memTemplParams" colspan="2">template&lt;class Table&gt; </td></tr>
<tr class="memitem:abbc95f17b3d2608b533954a2b123e893 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memTemplItemLeft" align="right" valign="top">Table::HandleImpl *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#abbc95f17b3d2608b533954a2b123e893">CreateStandalone</a> (<a class="el" href="../../d1/d57/structROCKSDB__NAMESPACE_1_1clock__cache_1_1ClockHandleBasicData.html">ClockHandleBasicData</a> &amp;proto, size_t capacity, uint32_t eec_and_scl, bool allow_uncharged)</td></tr>
<tr class="separator:abbc95f17b3d2608b533954a2b123e893 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f4cbb156e643c3efa9022b1c3fc1463 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_a2f4cbb156e643c3efa9022b1c3fc1463"><td class="memTemplParams" colspan="2">template&lt;class Table&gt; </td></tr>
<tr class="memitem:a2f4cbb156e643c3efa9022b1c3fc1463 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d4/d5b/classROCKSDB__NAMESPACE_1_1Status.html">Status</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a2f4cbb156e643c3efa9022b1c3fc1463">Insert</a> (const <a class="el" href="../../d1/d57/structROCKSDB__NAMESPACE_1_1clock__cache_1_1ClockHandleBasicData.html">ClockHandleBasicData</a> &amp;proto, typename Table::HandleImpl **handle, <a class="el" href="../../d2/d0d/classROCKSDB__NAMESPACE_1_1Cache.html#aae9756924748d66b8202bd4850e9d84d">Cache::Priority</a> priority, size_t capacity, uint32_t eec_and_scl)</td></tr>
<tr class="separator:a2f4cbb156e643c3efa9022b1c3fc1463 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6ee78d01b300b1f03b3f8804def847b inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_aa6ee78d01b300b1f03b3f8804def847b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#aa6ee78d01b300b1f03b3f8804def847b">Ref</a> (<a class="el" href="../../d7/d95/structROCKSDB__NAMESPACE_1_1clock__cache_1_1ClockHandle.html">ClockHandle</a> &amp;handle)</td></tr>
<tr class="separator:aa6ee78d01b300b1f03b3f8804def847b inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59235f2b9afd06e12c6de65477802773 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_a59235f2b9afd06e12c6de65477802773"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a59235f2b9afd06e12c6de65477802773">GetOccupancy</a> () const</td></tr>
<tr class="separator:a59235f2b9afd06e12c6de65477802773 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a560102008d3d124ef021139ab558df3d inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_a560102008d3d124ef021139ab558df3d"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a560102008d3d124ef021139ab558df3d">GetUsage</a> () const</td></tr>
<tr class="separator:a560102008d3d124ef021139ab558df3d inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a124b0bd45682aaf62baa5131e38deb65 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_a124b0bd45682aaf62baa5131e38deb65"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a124b0bd45682aaf62baa5131e38deb65">GetStandaloneUsage</a> () const</td></tr>
<tr class="separator:a124b0bd45682aaf62baa5131e38deb65 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66d044deed4670df98192cc0820a8582 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_a66d044deed4670df98192cc0820a8582"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a66d044deed4670df98192cc0820a8582">GetHashSeed</a> () const</td></tr>
<tr class="separator:a66d044deed4670df98192cc0820a8582 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79a22dc59a1e8f5beb030731aa5ebd27 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_a79a22dc59a1e8f5beb030731aa5ebd27"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a79a22dc59a1e8f5beb030731aa5ebd27">GetYieldCount</a> () const</td></tr>
<tr class="separator:a79a22dc59a1e8f5beb030731aa5ebd27 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06d28f16fd5324f709c7f57779674436 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_a06d28f16fd5324f709c7f57779674436"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a06d28f16fd5324f709c7f57779674436">GetEvictionEffortExceededCount</a> () const</td></tr>
<tr class="separator:a06d28f16fd5324f709c7f57779674436 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa32ca86b0bb994fcb45ddb2cbebd40e1 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_aa32ca86b0bb994fcb45ddb2cbebd40e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#aa32ca86b0bb994fcb45ddb2cbebd40e1">TrackAndReleaseEvictedEntry</a> (<a class="el" href="../../d7/d95/structROCKSDB__NAMESPACE_1_1clock__cache_1_1ClockHandle.html">ClockHandle</a> *h)</td></tr>
<tr class="separator:aa32ca86b0bb994fcb45ddb2cbebd40e1 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dfca308c0668c21d38967f5e150bffa inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_a4dfca308c0668c21d38967f5e150bffa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a4dfca308c0668c21d38967f5e150bffa">TEST_RefN</a> (<a class="el" href="../../d7/d95/structROCKSDB__NAMESPACE_1_1clock__cache_1_1ClockHandle.html">ClockHandle</a> &amp;handle, size_t n)</td></tr>
<tr class="separator:a4dfca308c0668c21d38967f5e150bffa inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae56c44d575aee6d3d4dcedec2a5de280 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_ae56c44d575aee6d3d4dcedec2a5de280"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ae56c44d575aee6d3d4dcedec2a5de280">TEST_ReleaseNMinus1</a> (<a class="el" href="../../d7/d95/structROCKSDB__NAMESPACE_1_1clock__cache_1_1ClockHandle.html">ClockHandle</a> *handle, size_t n)</td></tr>
<tr class="separator:ae56c44d575aee6d3d4dcedec2a5de280 inherit pub_methods_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
정적 Public 속성</h2></td></tr>
<tr class="memitem:a98620a4cd334f9067756d38932c75d5f" id="r_a98620a4cd334f9067756d38932c75d5f"><td class="memItemLeft" align="right" valign="top">static constexpr double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a98620a4cd334f9067756d38932c75d5f">kMaxLoadFactor</a> = 0.60</td></tr>
<tr class="separator:a98620a4cd334f9067756d38932c75d5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private 멤버 함수</h2></td></tr>
<tr class="memitem:a5ca412446df4200dd55e020e802d99f2" id="r_a5ca412446df4200dd55e020e802d99f2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5ca412446df4200dd55e020e802d99f2">Grow</a> (<a class="el" href="../../db/dbb/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1InsertState.html">InsertState</a> &amp;state)</td></tr>
<tr class="separator:a5ca412446df4200dd55e020e802d99f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad711f79a6b0edd406c9c64330e707e0f" id="r_ad711f79a6b0edd406c9c64330e707e0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad711f79a6b0edd406c9c64330e707e0f">SplitForGrow</a> (size_t grow_home, size_t old_home, int old_shift)</td></tr>
<tr class="separator:ad711f79a6b0edd406c9c64330e707e0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24212c074c37a92800c31882b2907f8d" id="r_a24212c074c37a92800c31882b2907f8d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a24212c074c37a92800c31882b2907f8d">Remove</a> (HandleImpl *h)</td></tr>
<tr class="separator:a24212c074c37a92800c31882b2907f8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53060e46ed4e542a6db7f0e6bdae9c8a" id="r_a53060e46ed4e542a6db7f0e6bdae9c8a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a53060e46ed4e542a6db7f0e6bdae9c8a">TryEraseHandle</a> (HandleImpl *h, bool holding_ref, bool mark_invisible)</td></tr>
<tr class="separator:a53060e46ed4e542a6db7f0e6bdae9c8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a353c1aa19f1e338db90086bdca07407b" id="r_a353c1aa19f1e338db90086bdca07407b"><td class="memTemplParams" colspan="2">template&lt;class OpData&gt; </td></tr>
<tr class="memitem:a353c1aa19f1e338db90086bdca07407b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a353c1aa19f1e338db90086bdca07407b">PurgeImpl</a> (OpData *op_data, size_t home=SIZE_MAX, <a class="el" href="../../d4/d35/structROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_1_1EvictionData.html">EvictionData</a> *data=nullptr)</td></tr>
<tr class="separator:a353c1aa19f1e338db90086bdca07407b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c68c3c5ccbe3c20bd71313b1a0f8e10" id="r_a4c68c3c5ccbe3c20bd71313b1a0f8e10"><td class="memTemplParams" colspan="2">template&lt;class OpData&gt; </td></tr>
<tr class="memitem:a4c68c3c5ccbe3c20bd71313b1a0f8e10"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a4c68c3c5ccbe3c20bd71313b1a0f8e10">PurgeImplLocked</a> (OpData *op_data, <a class="el" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html">ChainRewriteLock</a> &amp;rewrite_lock, size_t home, <a class="el" href="../../d4/d35/structROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_1_1EvictionData.html">EvictionData</a> *data)</td></tr>
<tr class="separator:a4c68c3c5ccbe3c20bd71313b1a0f8e10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e26beba887f4e95c1c53b5ae2eaacdd" id="r_a5e26beba887f4e95c1c53b5ae2eaacdd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e26beba887f4e95c1c53b5ae2eaacdd">CatchUpLengthInfoNoWait</a> (size_t known_usable_grow_home)</td></tr>
<tr class="separator:a5e26beba887f4e95c1c53b5ae2eaacdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-methods" name="pri-static-methods"></a>
정적 Private 멤버 함수</h2></td></tr>
<tr class="memitem:a12e42e93cd42660f9347bada7b5b12e4" id="r_a12e42e93cd42660f9347bada7b5b12e4"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a12e42e93cd42660f9347bada7b5b12e4">CalcMaxUsableLength</a> (size_t capacity, size_t min_avg_value_size, <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#ad6fbfb4d192b433af6ebde26a12775dc">CacheMetadataChargePolicy</a> metadata_charge_policy)</td></tr>
<tr class="separator:a12e42e93cd42660f9347bada7b5b12e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private 속성</h2></td></tr>
<tr class="memitem:ac090a43a3dde16589fbaf9a3aab83c63" id="r_ac090a43a3dde16589fbaf9a3aab83c63"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html">TypedMemMapping</a>&lt; HandleImpl &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a></td></tr>
<tr class="separator:ac090a43a3dde16589fbaf9a3aab83c63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691cf5bc49f36f3001d8c980901de288" id="r_a691cf5bc49f36f3001d8c980901de288"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html">AcqRelAtomic</a>&lt; uint64_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a691cf5bc49f36f3001d8c980901de288">length_info_</a></td></tr>
<tr class="separator:a691cf5bc49f36f3001d8c980901de288"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36ca56c367a512dc25dd00ba74a115e9" id="r_a36ca56c367a512dc25dd00ba74a115e9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html">RelaxedAtomic</a>&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a36ca56c367a512dc25dd00ba74a115e9">occupancy_limit_</a></td></tr>
<tr class="separator:a36ca56c367a512dc25dd00ba74a115e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcb35ce36192fc425c67157f697c5226" id="r_afcb35ce36192fc425c67157f697c5226"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html">RelaxedAtomic</a>&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afcb35ce36192fc425c67157f697c5226">grow_frontier_</a></td></tr>
<tr class="separator:afcb35ce36192fc425c67157f697c5226"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cd88545c5e9cfb63d51e413f244f0b9" id="r_a3cd88545c5e9cfb63d51e413f244f0b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html">RelaxedAtomic</a>&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3cd88545c5e9cfb63d51e413f244f0b9">clock_pointer_mask_</a></td></tr>
<tr class="separator:a3cd88545c5e9cfb63d51e413f244f0b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
추가로 상속된 멤버들</h2></td></tr>
<tr class="inherit_header pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable')"><img src="../../closed.png" alt="-"/>&#160;<a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html">ROCKSDB_NAMESPACE::clock_cache::BaseClockTable</a>(으)로부터 상속된 Protected 속성</td></tr>
<tr class="memitem:aaf422722f1e9ff79fd0f8d1952068b57 inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_aaf422722f1e9ff79fd0f8d1952068b57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html">RelaxedAtomic</a>&lt; uint64_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#aaf422722f1e9ff79fd0f8d1952068b57">clock_pointer_</a> {}</td></tr>
<tr class="separator:aaf422722f1e9ff79fd0f8d1952068b57 inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae058b85ca9ff2ed2c9240cafe094f99f inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_ae058b85ca9ff2ed2c9240cafe094f99f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html">RelaxedAtomic</a>&lt; uint64_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ae058b85ca9ff2ed2c9240cafe094f99f">yield_count_</a> {}</td></tr>
<tr class="separator:ae058b85ca9ff2ed2c9240cafe094f99f inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbfb2f7669dfb5646031a78ff9457374 inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_afbfb2f7669dfb5646031a78ff9457374"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html">RelaxedAtomic</a>&lt; uint64_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#afbfb2f7669dfb5646031a78ff9457374">eviction_effort_exceeded_count_</a> {}</td></tr>
<tr class="separator:afbfb2f7669dfb5646031a78ff9457374 inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac77e847a676d7b1c9b23386e8fc0671b inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_ac77e847a676d7b1c9b23386e8fc0671b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html">AcqRelAtomic</a>&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ac77e847a676d7b1c9b23386e8fc0671b">occupancy_</a> {}</td></tr>
<tr class="separator:ac77e847a676d7b1c9b23386e8fc0671b inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83cfd21cdc4064eaad12cf25f7dc0011 inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_a83cfd21cdc4064eaad12cf25f7dc0011"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html">AcqRelAtomic</a>&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a83cfd21cdc4064eaad12cf25f7dc0011">usage_</a> {}</td></tr>
<tr class="separator:a83cfd21cdc4064eaad12cf25f7dc0011 inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af52195d41a6f06bfcbd82679a027cbf6 inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_af52195d41a6f06bfcbd82679a027cbf6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html">AcqRelAtomic</a>&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#af52195d41a6f06bfcbd82679a027cbf6">standalone_usage_</a> {}</td></tr>
<tr class="separator:af52195d41a6f06bfcbd82679a027cbf6 inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b3d1b42cce7ea431ff90d735eb35c0a inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_a9b3d1b42cce7ea431ff90d735eb35c0a"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#ad6fbfb4d192b433af6ebde26a12775dc">CacheMetadataChargePolicy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a9b3d1b42cce7ea431ff90d735eb35c0a">metadata_charge_policy_</a></td></tr>
<tr class="separator:a9b3d1b42cce7ea431ff90d735eb35c0a inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac17ac84de3be7dec0320979693b01f78 inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_ac17ac84de3be7dec0320979693b01f78"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d8f/classROCKSDB__NAMESPACE_1_1MemoryAllocator.html">MemoryAllocator</a> *const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ac17ac84de3be7dec0320979693b01f78">allocator_</a></td></tr>
<tr class="separator:ac17ac84de3be7dec0320979693b01f78 inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5dca373e480f88dfa20c828104b8c38 inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_ab5dca373e480f88dfa20c828104b8c38"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d2/d0d/classROCKSDB__NAMESPACE_1_1Cache.html#af94e718286ee6148eacb1e95808c2399">Cache::EvictionCallback</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ab5dca373e480f88dfa20c828104b8c38">eviction_callback_</a></td></tr>
<tr class="separator:ab5dca373e480f88dfa20c828104b8c38 inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2b3971ae328e8ee5badf31a1b9c6a0d inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable" id="r_aa2b3971ae328e8ee5badf31a1b9c6a0d"><td class="memItemLeft" align="right" valign="top">const uint32_t &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#aa2b3971ae328e8ee5badf31a1b9c6a0d">hash_seed_</a></td></tr>
<tr class="separator:aa2b3971ae328e8ee5badf31a1b9c6a0d inherit pro_attribs_classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">상세한 설명</h2>
<div class="textblock">
<p class="definition"><a class="el" href="../../db/d81/clock__cache_8h_source.html">clock_cache.h</a> 파일의 <a class="el" href="../../db/d81/clock__cache_8h_source.html#l00732">732</a> 번째 라인에서 정의되었습니다.</p>
</div><h2 class="groupheader">생성자 &amp; 소멸자 문서화</h2>
<a id="a9616b2306e5efc8080bd3f56e3d59945" name="a9616b2306e5efc8080bd3f56e3d59945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9616b2306e5efc8080bd3f56e3d59945">&#9670;&#160;</a></span>AutoHyperClockTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::AutoHyperClockTable </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>capacity</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#ad6fbfb4d192b433af6ebde26a12775dc">CacheMetadataChargePolicy</a></td>          <td class="paramname"><span class="paramname"><em>metadata_charge_policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d8f/classROCKSDB__NAMESPACE_1_1MemoryAllocator.html">MemoryAllocator</a> *</td>          <td class="paramname"><span class="paramname"><em>allocator</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d2/d0d/classROCKSDB__NAMESPACE_1_1Cache.html#af94e718286ee6148eacb1e95808c2399">Cache::EvictionCallback</a> *</td>          <td class="paramname"><span class="paramname"><em>eviction_callback</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t *</td>          <td class="paramname"><span class="paramname"><em>hash_seed</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/dc8/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1Opts.html">Opts</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>opts</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l01971">1971</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1976</span>    : <a class="code hl_function" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a589b754f612e4acebf3403fd26f9a43e">BaseClockTable</a>(metadata_charge_policy, allocator, eviction_callback,</div>
<div class="line"><span class="lineno"> 1977</span>                     hash_seed),</div>
<div class="line"><span class="lineno"> 1978</span>      <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>(MemMapping::AllocateLazyZeroed(</div>
<div class="line"><span class="lineno"> 1979</span>          <span class="keyword">sizeof</span>(HandleImpl) * <a class="code hl_function" href="#a12e42e93cd42660f9347bada7b5b12e4">CalcMaxUsableLength</a>(capacity,</div>
<div class="line"><span class="lineno"> 1980</span>                                                   opts.min_avg_value_size,</div>
<div class="line"><span class="lineno"> 1981</span>                                                   metadata_charge_policy))),</div>
<div class="line"><span class="lineno"> 1982</span>      <a class="code hl_variable" href="#a691cf5bc49f36f3001d8c980901de288">length_info_</a>(UsedLengthToLengthInfo(GetStartingLength(capacity))),</div>
<div class="line"><span class="lineno"> 1983</span>      <a class="code hl_variable" href="#a36ca56c367a512dc25dd00ba74a115e9">occupancy_limit_</a>(</div>
<div class="line"><span class="lineno"> 1984</span>          CalcOccupancyLimit(LengthInfoToUsedLength(<a class="code hl_variable" href="#a691cf5bc49f36f3001d8c980901de288">length_info_</a>.<a class="code hl_function" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a5361060db542ce3ebfd914aecb908f8c">Load</a>()))),</div>
<div class="line"><span class="lineno"> 1985</span>      <a class="code hl_variable" href="#afcb35ce36192fc425c67157f697c5226">grow_frontier_</a>(<a class="code hl_function" href="#a064c2e0057bdd3eff5edb1537bffd356">GetTableSize</a>()),</div>
<div class="line"><span class="lineno"> 1986</span>      <a class="code hl_variable" href="#a3cd88545c5e9cfb63d51e413f244f0b9">clock_pointer_mask_</a>(</div>
<div class="line"><span class="lineno"> 1987</span>          <a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94">BottomNBits</a>(UINT64_MAX, LengthInfoToMinShift(<a class="code hl_variable" href="#a691cf5bc49f36f3001d8c980901de288">length_info_</a>.<a class="code hl_function" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a5361060db542ce3ebfd914aecb908f8c">Load</a>()))) {</div>
<div class="line"><span class="lineno"> 1988</span>  <span class="keywordflow">if</span> (metadata_charge_policy ==</div>
<div class="line"><span class="lineno"> 1989</span>      CacheMetadataChargePolicy::kFullChargeCacheMetadata) {</div>
<div class="line"><span class="lineno"> 1990</span>    <span class="comment">// NOTE: ignoring page boundaries for simplicity</span></div>
<div class="line"><span class="lineno"> 1991</span>    <a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a83cfd21cdc4064eaad12cf25f7dc0011">usage_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631">FetchAddRelaxed</a>(<span class="keywordtype">size_t</span>{<a class="code hl_function" href="#a064c2e0057bdd3eff5edb1537bffd356">GetTableSize</a>()} * <span class="keyword">sizeof</span>(HandleImpl));</div>
<div class="line"><span class="lineno"> 1992</span>  }</div>
<div class="line"><span class="lineno"> 1993</span> </div>
<div class="line"><span class="lineno"> 1994</span>  <span class="keyword">static_assert</span>(<span class="keyword">sizeof</span>(HandleImpl) == 64U,</div>
<div class="line"><span class="lineno"> 1995</span>                <span class="stringliteral">&quot;Expecting size / alignment with common cache line size&quot;</span>);</div>
<div class="line"><span class="lineno"> 1996</span> </div>
<div class="line"><span class="lineno"> 1997</span>  <span class="comment">// Populate head pointers</span></div>
<div class="line"><span class="lineno"> 1998</span>  uint64_t length_info = <a class="code hl_variable" href="#a691cf5bc49f36f3001d8c980901de288">length_info_</a>.<a class="code hl_function" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a5361060db542ce3ebfd914aecb908f8c">Load</a>();</div>
<div class="line"><span class="lineno"> 1999</span>  <span class="keywordtype">int</span> min_shift = LengthInfoToMinShift(length_info);</div>
<div class="line"><span class="lineno"> 2000</span>  <span class="keywordtype">int</span> max_shift = min_shift + 1;</div>
<div class="line"><span class="lineno"> 2001</span>  <span class="keywordtype">size_t</span> major = uint64_t{1} &lt;&lt; min_shift;</div>
<div class="line"><span class="lineno"> 2002</span>  <span class="keywordtype">size_t</span> used_length = <a class="code hl_function" href="#a064c2e0057bdd3eff5edb1537bffd356">GetTableSize</a>();</div>
<div class="line"><span class="lineno"> 2003</span> </div>
<div class="line"><span class="lineno"> 2004</span>  assert(major &lt;= used_length);</div>
<div class="line"><span class="lineno"> 2005</span>  assert(used_length &lt;= major * 2);</div>
<div class="line"><span class="lineno"> 2006</span> </div>
<div class="line"><span class="lineno"> 2007</span>  <span class="comment">// Initialize the initial usable set of slots. This slightly odd iteration</span></div>
<div class="line"><span class="lineno"> 2008</span>  <span class="comment">// order makes it easier to get the correct shift amount on each head.</span></div>
<div class="line"><span class="lineno"> 2009</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; major; ++i) {</div>
<div class="line"><span class="lineno"> 2010</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><span class="lineno"> 2011</span>    <span class="keywordtype">int</span> shift;</div>
<div class="line"><span class="lineno"> 2012</span>    <span class="keywordtype">size_t</span> home;</div>
<div class="line"><span class="lineno"> 2013</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2014</span>    <span class="keywordflow">if</span> (major + i &lt; used_length) {</div>
<div class="line"><span class="lineno"> 2015</span>      <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>[i].head_next_with_shift.StoreRelaxed(</div>
<div class="line"><span class="lineno"> 2016</span>          MakeNextWithShiftEnd(i, max_shift));</div>
<div class="line"><span class="lineno"> 2017</span>      <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>[major + i].head_next_with_shift.StoreRelaxed(</div>
<div class="line"><span class="lineno"> 2018</span>          MakeNextWithShiftEnd(major + i, max_shift));</div>
<div class="line"><span class="lineno"> 2019</span><span class="preprocessor">#ifndef NDEBUG  </span><span class="comment">// Extra invariant checking</span></div>
<div class="line"><span class="lineno"> 2020</span>      GetHomeIndexAndShift(length_info, i, &amp;home, &amp;shift);</div>
<div class="line"><span class="lineno"> 2021</span>      assert(home == i);</div>
<div class="line"><span class="lineno"> 2022</span>      assert(shift == max_shift);</div>
<div class="line"><span class="lineno"> 2023</span>      GetHomeIndexAndShift(length_info, major + i, &amp;home, &amp;shift);</div>
<div class="line"><span class="lineno"> 2024</span>      assert(home == major + i);</div>
<div class="line"><span class="lineno"> 2025</span>      assert(shift == max_shift);</div>
<div class="line"><span class="lineno"> 2026</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2027</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2028</span>      <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>[i].head_next_with_shift.StoreRelaxed(</div>
<div class="line"><span class="lineno"> 2029</span>          MakeNextWithShiftEnd(i, min_shift));</div>
<div class="line"><span class="lineno"> 2030</span><span class="preprocessor">#ifndef NDEBUG  </span><span class="comment">// Extra invariant checking</span></div>
<div class="line"><span class="lineno"> 2031</span>      GetHomeIndexAndShift(length_info, i, &amp;home, &amp;shift);</div>
<div class="line"><span class="lineno"> 2032</span>      assert(home == i);</div>
<div class="line"><span class="lineno"> 2033</span>      assert(shift == min_shift);</div>
<div class="line"><span class="lineno"> 2034</span>      GetHomeIndexAndShift(length_info, major + i, &amp;home, &amp;shift);</div>
<div class="line"><span class="lineno"> 2035</span>      assert(home == i);</div>
<div class="line"><span class="lineno"> 2036</span>      assert(shift == min_shift);</div>
<div class="line"><span class="lineno"> 2037</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2038</span>    }</div>
<div class="line"><span class="lineno"> 2039</span>  }</div>
<div class="line"><span class="lineno"> 2040</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1AcqRelAtomic_html_a5361060db542ce3ebfd914aecb908f8c"><div class="ttname"><a href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a5361060db542ce3ebfd914aecb908f8c">ROCKSDB_NAMESPACE::AcqRelAtomic::Load</a></div><div class="ttdeci">T Load() const</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d02/atomic_8h_source.html#l00080">atomic.h:80</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1RelaxedAtomic_html_ab8c07210b81d7b64fc00ce2d30fc5631"><div class="ttname"><a href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631">ROCKSDB_NAMESPACE::RelaxedAtomic::FetchAddRelaxed</a></div><div class="ttdeci">T FetchAddRelaxed(T operand)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d02/atomic_8h_source.html#l00049">atomic.h:49</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_a064c2e0057bdd3eff5edb1537bffd356"><div class="ttname"><a href="#a064c2e0057bdd3eff5edb1537bffd356">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::GetTableSize</a></div><div class="ttdeci">size_t GetTableSize() const</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l02121">clock_cache.cc:2121</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_a12e42e93cd42660f9347bada7b5b12e4"><div class="ttname"><a href="#a12e42e93cd42660f9347bada7b5b12e4">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::CalcMaxUsableLength</a></div><div class="ttdeci">static size_t CalcMaxUsableLength(size_t capacity, size_t min_avg_value_size, CacheMetadataChargePolicy metadata_charge_policy)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l03571">clock_cache.cc:3571</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_a36ca56c367a512dc25dd00ba74a115e9"><div class="ttname"><a href="#a36ca56c367a512dc25dd00ba74a115e9">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::occupancy_limit_</a></div><div class="ttdeci">RelaxedAtomic&lt; size_t &gt; occupancy_limit_</div><div class="ttdef"><b>Definition</b> <a href="../../db/d81/clock__cache_8h_source.html#l00982">clock_cache.h:982</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_a3cd88545c5e9cfb63d51e413f244f0b9"><div class="ttname"><a href="#a3cd88545c5e9cfb63d51e413f244f0b9">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::clock_pointer_mask_</a></div><div class="ttdeci">RelaxedAtomic&lt; size_t &gt; clock_pointer_mask_</div><div class="ttdef"><b>Definition</b> <a href="../../db/d81/clock__cache_8h_source.html#l00991">clock_cache.h:991</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_a691cf5bc49f36f3001d8c980901de288"><div class="ttname"><a href="#a691cf5bc49f36f3001d8c980901de288">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::length_info_</a></div><div class="ttdeci">AcqRelAtomic&lt; uint64_t &gt; length_info_</div><div class="ttdef"><b>Definition</b> <a href="../../db/d81/clock__cache_8h_source.html#l00976">clock_cache.h:976</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_ac090a43a3dde16589fbaf9a3aab83c63"><div class="ttname"><a href="#ac090a43a3dde16589fbaf9a3aab83c63">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::array_</a></div><div class="ttdeci">const TypedMemMapping&lt; HandleImpl &gt; array_</div><div class="ttdef"><b>Definition</b> <a href="../../db/d81/clock__cache_8h_source.html#l00958">clock_cache.h:958</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_afcb35ce36192fc425c67157f697c5226"><div class="ttname"><a href="#afcb35ce36192fc425c67157f697c5226">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::grow_frontier_</a></div><div class="ttdeci">RelaxedAtomic&lt; size_t &gt; grow_frontier_</div><div class="ttdef"><b>Definition</b> <a href="../../db/d81/clock__cache_8h_source.html#l00987">clock_cache.h:987</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_html_a589b754f612e4acebf3403fd26f9a43e"><div class="ttname"><a href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a589b754f612e4acebf3403fd26f9a43e">ROCKSDB_NAMESPACE::clock_cache::BaseClockTable::BaseClockTable</a></div><div class="ttdeci">BaseClockTable(CacheMetadataChargePolicy metadata_charge_policy, MemoryAllocator *allocator, const Cache::EvictionCallback *eviction_callback, const uint32_t *hash_seed)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d81/clock__cache_8h_source.html#l00386">clock_cache.h:386</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_html_a83cfd21cdc4064eaad12cf25f7dc0011"><div class="ttname"><a href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a83cfd21cdc4064eaad12cf25f7dc0011">ROCKSDB_NAMESPACE::clock_cache::BaseClockTable::usage_</a></div><div class="ttdeci">AcqRelAtomic&lt; size_t &gt; usage_</div><div class="ttdef"><b>Definition</b> <a href="../../db/d81/clock__cache_8h_source.html#l00495">clock_cache.h:495</a></div></div>
<div class="ttc" id="anamespaceROCKSDB__NAMESPACE_html_af600c4fa93d07ebb44f669e76582de94"><div class="ttname"><a href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94">ROCKSDB_NAMESPACE::BottomNBits</a></div><div class="ttdeci">T BottomNBits(T v, int nbits)</div><div class="ttdef"><b>Definition</b> <a href="../../df/db1/math_8h_source.html#l00029">math.h:29</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9616b2306e5efc8080bd3f56e3d59945_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9616b2306e5efc8080bd3f56e3d59945_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9616b2306e5efc8080bd3f56e3d59945_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9616b2306e5efc8080bd3f56e3d59945_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,219,219"/>
<area shape="poly" title=" " alt="" coords="61,157,62,147,72,138,88,133,112,131,139,133,156,141,154,145,138,139,112,136,89,138,74,143,67,149,66,157"/>
<area shape="rect" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a589b754f612e4acebf3403fd26f9a43e" title=" " alt="" coords="268,5,478,67"/>
<area shape="poly" title=" " alt="" coords="150,155,204,115,265,77,274,72,276,77,268,81,207,120,154,159"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="283,115,464,160"/>
<area shape="poly" title=" " alt="" coords="219,165,267,155,268,161,220,170"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a12e42e93cd42660f9347bada7b5b12e4" title=" " alt="" coords="267,208,480,270"/>
<area shape="poly" title=" " alt="" coords="220,206,252,213,251,218,219,212"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a064c2e0057bdd3eff5edb1537bffd356" title=" " alt="" coords="267,317,480,379"/>
<area shape="poly" title=" " alt="" coords="165,217,310,307,307,311,162,222"/>
<area shape="poly" title=" " alt="" coords="324,115,322,105,331,96,348,90,373,89,401,91,418,97,416,102,400,96,373,94,349,96,334,101,327,107,329,114"/>
<area shape="poly" title=" " alt="" coords="322,207,324,197,333,189,350,183,373,181,401,184,417,191,415,196,399,189,373,187,351,189,336,193,328,200,327,208"/>
<area shape="poly" title=" " alt="" coords="322,317,324,307,333,298,350,293,373,291,401,293,417,301,415,305,399,299,373,296,351,298,336,303,328,309,327,317"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9616b2306e5efc8080bd3f56e3d59945_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9616b2306e5efc8080bd3f56e3d59945_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9616b2306e5efc8080bd3f56e3d59945_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9616b2306e5efc8080bd3f56e3d59945_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="146,17,133,11,112,8,94,10,82,15,76,21,75,29,70,29,71,19,79,10,92,5,112,3,135,5,148,13"/>
</map>
</div>

</div>
</div>
<a id="a696abeb6e3bbbb60bba3865b715721fc" name="a696abeb6e3bbbb60bba3865b715721fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a696abeb6e3bbbb60bba3865b715721fc">&#9670;&#160;</a></span>~AutoHyperClockTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::~AutoHyperClockTable </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l02042">2042</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2042</span>                                          {</div>
<div class="line"><span class="lineno"> 2043</span>  <span class="comment">// As usual, destructor assumes there are no references or active operations</span></div>
<div class="line"><span class="lineno"> 2044</span>  <span class="comment">// on any slot/element in the table.</span></div>
<div class="line"><span class="lineno"> 2045</span> </div>
<div class="line"><span class="lineno"> 2046</span>  <span class="comment">// It&#39;s possible that there were not enough Insert() after final concurrent</span></div>
<div class="line"><span class="lineno"> 2047</span>  <span class="comment">// Grow to ensure length_info_ (published GetTableSize()) is fully up to</span></div>
<div class="line"><span class="lineno"> 2048</span>  <span class="comment">// date. Probe for first unused slot to ensure we see the whole structure.</span></div>
<div class="line"><span class="lineno"> 2049</span>  <span class="keywordtype">size_t</span> used_end = <a class="code hl_function" href="#a064c2e0057bdd3eff5edb1537bffd356">GetTableSize</a>();</div>
<div class="line"><span class="lineno"> 2050</span>  <span class="keywordflow">while</span> (used_end &lt; <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>.<a class="code hl_function" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a28a017539929f61ec8037625acb2ee1e">Count</a>() &amp;&amp;</div>
<div class="line"><span class="lineno"> 2051</span>         array_[used_end].head_next_with_shift.LoadRelaxed() !=</div>
<div class="line"><span class="lineno"> 2052</span>             HandleImpl::kUnusedMarker) {</div>
<div class="line"><span class="lineno"> 2053</span>    used_end++;</div>
<div class="line"><span class="lineno"> 2054</span>  }</div>
<div class="line"><span class="lineno"> 2055</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><span class="lineno"> 2056</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = used_end; i &lt; <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>.<a class="code hl_function" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a28a017539929f61ec8037625acb2ee1e">Count</a>(); i++) {</div>
<div class="line"><span class="lineno"> 2057</span>    assert(array_[i].head_next_with_shift.LoadRelaxed() == 0);</div>
<div class="line"><span class="lineno"> 2058</span>    assert(array_[i].chain_next_with_shift.LoadRelaxed() == 0);</div>
<div class="line"><span class="lineno"> 2059</span>    assert(array_[i].meta.LoadRelaxed() == 0);</div>
<div class="line"><span class="lineno"> 2060</span>  }</div>
<div class="line"><span class="lineno"> 2061</span>  std::vector&lt;bool&gt; was_populated(used_end);</div>
<div class="line"><span class="lineno"> 2062</span>  std::vector&lt;bool&gt; was_pointed_to(used_end);</div>
<div class="line"><span class="lineno"> 2063</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2064</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; used_end; i++) {</div>
<div class="line"><span class="lineno"> 2065</span>    HandleImpl&amp; h = <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>[i];</div>
<div class="line"><span class="lineno"> 2066</span>    <span class="keywordflow">switch</span> (h.meta.LoadRelaxed() &gt;&gt; ClockHandle::kStateShift) {</div>
<div class="line"><span class="lineno"> 2067</span>      <span class="keywordflow">case</span> ClockHandle::kStateEmpty:</div>
<div class="line"><span class="lineno"> 2068</span>        <span class="comment">// noop</span></div>
<div class="line"><span class="lineno"> 2069</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2070</span>      <span class="keywordflow">case</span> ClockHandle::kStateInvisible:  <span class="comment">// rare but possible</span></div>
<div class="line"><span class="lineno"> 2071</span>      <span class="keywordflow">case</span> ClockHandle::kStateVisible:</div>
<div class="line"><span class="lineno"> 2072</span>        assert(GetRefcount(h.meta.LoadRelaxed()) == 0);</div>
<div class="line"><span class="lineno"> 2073</span>        h.FreeData(allocator_);</div>
<div class="line"><span class="lineno"> 2074</span><span class="preprocessor">#ifndef NDEBUG  </span><span class="comment">// Extra invariant checking</span></div>
<div class="line"><span class="lineno"> 2075</span>        <a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a83cfd21cdc4064eaad12cf25f7dc0011">usage_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6eee24b94e05b32724d318d80b24397d">FetchSubRelaxed</a>(h.total_charge);</div>
<div class="line"><span class="lineno"> 2076</span>        <a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ac77e847a676d7b1c9b23386e8fc0671b">occupancy_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6eee24b94e05b32724d318d80b24397d">FetchSubRelaxed</a>(1U);</div>
<div class="line"><span class="lineno"> 2077</span>        was_populated[i] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2078</span>        <span class="keywordflow">if</span> (!HandleImpl::IsEnd(h.chain_next_with_shift.LoadRelaxed())) {</div>
<div class="line"><span class="lineno"> 2079</span>          assert((h.chain_next_with_shift.LoadRelaxed() &amp;</div>
<div class="line"><span class="lineno"> 2080</span>                  HandleImpl::kHeadLocked) == 0);</div>
<div class="line"><span class="lineno"> 2081</span>          <span class="keywordtype">size_t</span> next =</div>
<div class="line"><span class="lineno"> 2082</span>              GetNextFromNextWithShift(h.chain_next_with_shift.LoadRelaxed());</div>
<div class="line"><span class="lineno"> 2083</span>          assert(!was_pointed_to[next]);</div>
<div class="line"><span class="lineno"> 2084</span>          was_pointed_to[next] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2085</span>        }</div>
<div class="line"><span class="lineno"> 2086</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2087</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2088</span>      <span class="comment">// otherwise</span></div>
<div class="line"><span class="lineno"> 2089</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2090</span>        assert(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2091</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2092</span>    }</div>
<div class="line"><span class="lineno"> 2093</span><span class="preprocessor">#ifndef NDEBUG  </span><span class="comment">// Extra invariant checking</span></div>
<div class="line"><span class="lineno"> 2094</span>    <span class="keywordflow">if</span> (!HandleImpl::IsEnd(h.head_next_with_shift.LoadRelaxed())) {</div>
<div class="line"><span class="lineno"> 2095</span>      <span class="keywordtype">size_t</span> next =</div>
<div class="line"><span class="lineno"> 2096</span>          GetNextFromNextWithShift(h.head_next_with_shift.LoadRelaxed());</div>
<div class="line"><span class="lineno"> 2097</span>      assert(!was_pointed_to[next]);</div>
<div class="line"><span class="lineno"> 2098</span>      was_pointed_to[next] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2099</span>    }</div>
<div class="line"><span class="lineno"> 2100</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2101</span>  }</div>
<div class="line"><span class="lineno"> 2102</span><span class="preprocessor">#ifndef NDEBUG  </span><span class="comment">// Extra invariant checking</span></div>
<div class="line"><span class="lineno"> 2103</span>  <span class="comment">// This check is not perfect, but should detect most reasonable cases</span></div>
<div class="line"><span class="lineno"> 2104</span>  <span class="comment">// of abandonned or floating entries, etc.  (A floating cycle would not</span></div>
<div class="line"><span class="lineno"> 2105</span>  <span class="comment">// be reported as bad.)</span></div>
<div class="line"><span class="lineno"> 2106</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; used_end; i++) {</div>
<div class="line"><span class="lineno"> 2107</span>    <span class="keywordflow">if</span> (was_populated[i]) {</div>
<div class="line"><span class="lineno"> 2108</span>      assert(was_pointed_to[i]);</div>
<div class="line"><span class="lineno"> 2109</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2110</span>      assert(!was_pointed_to[i]);</div>
<div class="line"><span class="lineno"> 2111</span>    }</div>
<div class="line"><span class="lineno"> 2112</span>  }</div>
<div class="line"><span class="lineno"> 2113</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2114</span> </div>
<div class="line"><span class="lineno"> 2115</span>  <span class="comment">// Metadata charging only follows the published table size</span></div>
<div class="line"><span class="lineno"> 2116</span>  assert(<a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a83cfd21cdc4064eaad12cf25f7dc0011">usage_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6a8401cbb9ead0bbb0def8fbfbabc97d">LoadRelaxed</a>() == 0 ||</div>
<div class="line"><span class="lineno"> 2117</span>         <a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a83cfd21cdc4064eaad12cf25f7dc0011">usage_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6a8401cbb9ead0bbb0def8fbfbabc97d">LoadRelaxed</a>() == <a class="code hl_function" href="#a064c2e0057bdd3eff5edb1537bffd356">GetTableSize</a>() * <span class="keyword">sizeof</span>(HandleImpl));</div>
<div class="line"><span class="lineno"> 2118</span>  assert(<a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ac77e847a676d7b1c9b23386e8fc0671b">occupancy_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6a8401cbb9ead0bbb0def8fbfbabc97d">LoadRelaxed</a>() == 0);</div>
<div class="line"><span class="lineno"> 2119</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1RelaxedAtomic_html_a6a8401cbb9ead0bbb0def8fbfbabc97d"><div class="ttname"><a href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6a8401cbb9ead0bbb0def8fbfbabc97d">ROCKSDB_NAMESPACE::RelaxedAtomic::LoadRelaxed</a></div><div class="ttdeci">T LoadRelaxed() const</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d02/atomic_8h_source.html#l00037">atomic.h:37</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1RelaxedAtomic_html_a6eee24b94e05b32724d318d80b24397d"><div class="ttname"><a href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6eee24b94e05b32724d318d80b24397d">ROCKSDB_NAMESPACE::RelaxedAtomic::FetchSubRelaxed</a></div><div class="ttdeci">T FetchSubRelaxed(T operand)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d02/atomic_8h_source.html#l00052">atomic.h:52</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1TypedMemMapping_html_a28a017539929f61ec8037625acb2ee1e"><div class="ttname"><a href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a28a017539929f61ec8037625acb2ee1e">ROCKSDB_NAMESPACE::TypedMemMapping::Count</a></div><div class="ttdeci">size_t Count() const</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d5a/mmap_8h_source.html#l00085">mmap.h:85</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_html_ac77e847a676d7b1c9b23386e8fc0671b"><div class="ttname"><a href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ac77e847a676d7b1c9b23386e8fc0671b">ROCKSDB_NAMESPACE::clock_cache::BaseClockTable::occupancy_</a></div><div class="ttdeci">AcqRelAtomic&lt; size_t &gt; occupancy_</div><div class="ttdef"><b>Definition</b> <a href="../../db/d81/clock__cache_8h_source.html#l00492">clock_cache.h:492</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a696abeb6e3bbbb60bba3865b715721fc_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a696abeb6e3bbbb60bba3865b715721fc_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a696abeb6e3bbbb60bba3865b715721fc_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a696abeb6e3bbbb60bba3865b715721fc_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="61,29,62,19,72,10,88,5,112,3,139,5,156,13,154,17,138,11,112,8,89,10,74,15,67,21,66,29"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a064c2e0057bdd3eff5edb1537bffd356" title=" " alt="" coords="267,29,480,91"/>
<area shape="poly" title=" " alt="" coords="219,58,251,58,251,63,219,63"/>
<area shape="poly" title=" " alt="" coords="322,29,324,19,333,10,350,5,373,3,401,5,417,13,415,17,399,11,373,8,351,10,336,15,328,21,327,29"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a696abeb6e3bbbb60bba3865b715721fc_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a696abeb6e3bbbb60bba3865b715721fc_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a696abeb6e3bbbb60bba3865b715721fc_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a696abeb6e3bbbb60bba3865b715721fc_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="146,17,133,11,112,8,94,10,82,15,76,21,75,29,70,29,71,19,79,10,92,5,112,3,135,5,148,13"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">멤버 함수 문서화</h2>
<a id="a12e42e93cd42660f9347bada7b5b12e4" name="a12e42e93cd42660f9347bada7b5b12e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12e42e93cd42660f9347bada7b5b12e4">&#9670;&#160;</a></span>CalcMaxUsableLength()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::CalcMaxUsableLength </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>capacity</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>min_avg_value_size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#ad6fbfb4d192b433af6ebde26a12775dc">CacheMetadataChargePolicy</a></td>          <td class="paramname"><span class="paramname"><em>metadata_charge_policy</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l03571">3571</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3573</span>                                                      {</div>
<div class="line"><span class="lineno"> 3574</span>  <span class="keywordtype">double</span> min_avg_slot_charge = min_avg_value_size * <a class="code hl_variable" href="#a98620a4cd334f9067756d38932c75d5f">kMaxLoadFactor</a>;</div>
<div class="line"><span class="lineno"> 3575</span>  <span class="keywordflow">if</span> (metadata_charge_policy == kFullChargeCacheMetadata) {</div>
<div class="line"><span class="lineno"> 3576</span>    min_avg_slot_charge += <span class="keyword">sizeof</span>(HandleImpl);</div>
<div class="line"><span class="lineno"> 3577</span>  }</div>
<div class="line"><span class="lineno"> 3578</span>  assert(min_avg_slot_charge &gt; 0.0);</div>
<div class="line"><span class="lineno"> 3579</span>  <span class="keywordtype">size_t</span> num_slots =</div>
<div class="line"><span class="lineno"> 3580</span>      <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(capacity / min_avg_slot_charge + 0.999999);</div>
<div class="line"><span class="lineno"> 3581</span> </div>
<div class="line"><span class="lineno"> 3582</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> slots_per_page = port::kPageSize / <span class="keyword">sizeof</span>(HandleImpl);</div>
<div class="line"><span class="lineno"> 3583</span> </div>
<div class="line"><span class="lineno"> 3584</span>  <span class="comment">// Round up to page size</span></div>
<div class="line"><span class="lineno"> 3585</span>  <span class="keywordflow">return</span> ((num_slots + slots_per_page - 1) / slots_per_page) * slots_per_page;</div>
<div class="line"><span class="lineno"> 3586</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_a98620a4cd334f9067756d38932c75d5f"><div class="ttname"><a href="#a98620a4cd334f9067756d38932c75d5f">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::kMaxLoadFactor</a></div><div class="ttdeci">static constexpr double kMaxLoadFactor</div><div class="ttdef"><b>Definition</b> <a href="../../db/d81/clock__cache_8h_source.html#l00904">clock_cache.h:904</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a12e42e93cd42660f9347bada7b5b12e4_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a12e42e93cd42660f9347bada7b5b12e4_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a12e42e93cd42660f9347bada7b5b12e4_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a12e42e93cd42660f9347bada7b5b12e4_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="70,29,71,19,79,10,92,5,112,3,135,5,148,13,146,17,133,11,112,8,94,10,82,15,76,21,75,29"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a12e42e93cd42660f9347bada7b5b12e4_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a12e42e93cd42660f9347bada7b5b12e4_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a12e42e93cd42660f9347bada7b5b12e4_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a12e42e93cd42660f9347bada7b5b12e4_icgraph">
<area shape="rect" title=" " alt="" coords="267,29,480,91"/>
<area shape="poly" title=" " alt="" coords="415,17,399,11,373,8,351,10,336,15,328,21,327,29,322,29,324,19,333,10,350,5,373,3,401,5,417,13"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a9616b2306e5efc8080bd3f56e3d59945" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="251,63,219,63,219,58,251,58"/>
<area shape="poly" title=" " alt="" coords="154,17,138,11,112,8,89,10,74,15,67,21,66,29,61,29,62,19,72,10,88,5,112,3,139,5,156,13"/>
</map>
</div>

</div>
</div>
<a id="a5e26beba887f4e95c1c53b5ae2eaacdd" name="a5e26beba887f4e95c1c53b5ae2eaacdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e26beba887f4e95c1c53b5ae2eaacdd">&#9670;&#160;</a></span>CatchUpLengthInfoNoWait()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::CatchUpLengthInfoNoWait </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>known_usable_grow_home</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l02259">2259</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2260</span>                                   {</div>
<div class="line"><span class="lineno"> 2261</span>  uint64_t current_length_info = <a class="code hl_variable" href="#a691cf5bc49f36f3001d8c980901de288">length_info_</a>.<a class="code hl_function" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a5361060db542ce3ebfd914aecb908f8c">Load</a>();</div>
<div class="line"><span class="lineno"> 2262</span>  <span class="keywordtype">size_t</span> published_usable_size = LengthInfoToUsedLength(current_length_info);</div>
<div class="line"><span class="lineno"> 2263</span>  <span class="keywordflow">while</span> (published_usable_size &lt;= known_usable_grow_home) {</div>
<div class="line"><span class="lineno"> 2264</span>    <span class="comment">// For when published_usable_size was grow_home</span></div>
<div class="line"><span class="lineno"> 2265</span>    <span class="keywordtype">size_t</span> next_usable_size = published_usable_size + 1;</div>
<div class="line"><span class="lineno"> 2266</span>    uint64_t next_length_info = UsedLengthToLengthInfo(next_usable_size);</div>
<div class="line"><span class="lineno"> 2267</span> </div>
<div class="line"><span class="lineno"> 2268</span>    <span class="comment">// known_usable_grow_home is known to be ready for Lookup/Insert with</span></div>
<div class="line"><span class="lineno"> 2269</span>    <span class="comment">// the new shift amount, but between that and published usable size, we</span></div>
<div class="line"><span class="lineno"> 2270</span>    <span class="comment">// need to check.</span></div>
<div class="line"><span class="lineno"> 2271</span>    <span class="keywordflow">if</span> (published_usable_size &lt; known_usable_grow_home) {</div>
<div class="line"><span class="lineno"> 2272</span>      <span class="keywordtype">int</span> old_shift = <a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a74a1b2239413fa672392330a886188ec">FloorLog2</a>(next_usable_size - 1);</div>
<div class="line"><span class="lineno"> 2273</span>      <span class="keywordtype">size_t</span> old_home = <a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94">BottomNBits</a>(published_usable_size, old_shift);</div>
<div class="line"><span class="lineno"> 2274</span>      <span class="keywordtype">int</span> shift = GetShiftFromNextWithShift(</div>
<div class="line"><span class="lineno"> 2275</span>          array_[old_home].head_next_with_shift.Load());</div>
<div class="line"><span class="lineno"> 2276</span>      <span class="keywordflow">if</span> (shift &lt;= old_shift) {</div>
<div class="line"><span class="lineno"> 2277</span>        <span class="comment">// Not ready</span></div>
<div class="line"><span class="lineno"> 2278</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2279</span>      }</div>
<div class="line"><span class="lineno"> 2280</span>    }</div>
<div class="line"><span class="lineno"> 2281</span>    <span class="comment">// CAS update length_info_. This only moves in one direction, so if CAS</span></div>
<div class="line"><span class="lineno"> 2282</span>    <span class="comment">// fails, someone else made progress like we are trying, and we can just</span></div>
<div class="line"><span class="lineno"> 2283</span>    <span class="comment">// pick up the new value and keep going as appropriate.</span></div>
<div class="line"><span class="lineno"> 2284</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a691cf5bc49f36f3001d8c980901de288">length_info_</a>.<a class="code hl_function" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a72a7f86c31b62eb4963ffed07bbbcd97">CasStrong</a>(current_length_info, next_length_info)) {</div>
<div class="line"><span class="lineno"> 2285</span>      current_length_info = next_length_info;</div>
<div class="line"><span class="lineno"> 2286</span>      <span class="comment">// Update usage_ if metadata charge policy calls for it</span></div>
<div class="line"><span class="lineno"> 2287</span>      <span class="keywordflow">if</span> (metadata_charge_policy_ ==</div>
<div class="line"><span class="lineno"> 2288</span>          CacheMetadataChargePolicy::kFullChargeCacheMetadata) {</div>
<div class="line"><span class="lineno"> 2289</span>        <span class="comment">// NOTE: ignoring page boundaries for simplicity</span></div>
<div class="line"><span class="lineno"> 2290</span>        <a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a83cfd21cdc4064eaad12cf25f7dc0011">usage_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631">FetchAddRelaxed</a>(<span class="keyword">sizeof</span>(HandleImpl));</div>
<div class="line"><span class="lineno"> 2291</span>      }</div>
<div class="line"><span class="lineno"> 2292</span>    }</div>
<div class="line"><span class="lineno"> 2293</span>    published_usable_size = LengthInfoToUsedLength(current_length_info);</div>
<div class="line"><span class="lineno"> 2294</span>  }</div>
<div class="line"><span class="lineno"> 2295</span> </div>
<div class="line"><span class="lineno"> 2296</span>  <span class="comment">// After updating lengh_info_ we can update occupancy_limit_,</span></div>
<div class="line"><span class="lineno"> 2297</span>  <span class="comment">// allowing for later operations to update it before us.</span></div>
<div class="line"><span class="lineno"> 2298</span>  <span class="comment">// Note: there is no AcqRelAtomic max operation, so we have to use a CAS loop</span></div>
<div class="line"><span class="lineno"> 2299</span>  <span class="keywordtype">size_t</span> old_occupancy_limit = <a class="code hl_variable" href="#a36ca56c367a512dc25dd00ba74a115e9">occupancy_limit_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6a8401cbb9ead0bbb0def8fbfbabc97d">LoadRelaxed</a>();</div>
<div class="line"><span class="lineno"> 2300</span>  <span class="keywordtype">size_t</span> new_occupancy_limit = CalcOccupancyLimit(published_usable_size);</div>
<div class="line"><span class="lineno"> 2301</span>  <span class="keywordflow">while</span> (old_occupancy_limit &lt; new_occupancy_limit) {</div>
<div class="line"><span class="lineno"> 2302</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a36ca56c367a512dc25dd00ba74a115e9">occupancy_limit_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a7f03c00f2d2f98350481bebd874a6cd6">CasWeakRelaxed</a>(old_occupancy_limit,</div>
<div class="line"><span class="lineno"> 2303</span>                                        new_occupancy_limit)) {</div>
<div class="line"><span class="lineno"> 2304</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2305</span>    }</div>
<div class="line"><span class="lineno"> 2306</span>  }</div>
<div class="line"><span class="lineno"> 2307</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1AcqRelAtomic_html_a72a7f86c31b62eb4963ffed07bbbcd97"><div class="ttname"><a href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a72a7f86c31b62eb4963ffed07bbbcd97">ROCKSDB_NAMESPACE::AcqRelAtomic::CasStrong</a></div><div class="ttdeci">bool CasStrong(T &amp;expected, T desired)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d02/atomic_8h_source.html#l00087">atomic.h:87</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1RelaxedAtomic_html_a7f03c00f2d2f98350481bebd874a6cd6"><div class="ttname"><a href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a7f03c00f2d2f98350481bebd874a6cd6">ROCKSDB_NAMESPACE::RelaxedAtomic::CasWeakRelaxed</a></div><div class="ttdeci">bool CasWeakRelaxed(T &amp;expected, T desired)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d02/atomic_8h_source.html#l00038">atomic.h:38</a></div></div>
<div class="ttc" id="anamespaceROCKSDB__NAMESPACE_html_a74a1b2239413fa672392330a886188ec"><div class="ttname"><a href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a74a1b2239413fa672392330a886188ec">ROCKSDB_NAMESPACE::FloorLog2</a></div><div class="ttdeci">int FloorLog2(T v)</div><div class="ttdef"><b>Definition</b> <a href="../../df/db1/math_8h_source.html#l00050">math.h:50</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5e26beba887f4e95c1c53b5ae2eaacdd_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5e26beba887f4e95c1c53b5ae2eaacdd_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5e26beba887f4e95c1c53b5ae2eaacdd_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5e26beba887f4e95c1c53b5ae2eaacdd_cgraph">
<area shape="rect" title=" " alt="" coords="5,68,241,129"/>
<area shape="poly" title=" " alt="" coords="73,67,74,57,83,48,100,43,123,41,150,44,166,51,164,56,148,49,123,46,101,48,86,53,79,59,78,68"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="289,29,470,74"/>
<area shape="poly" title=" " alt="" coords="241,74,273,68,274,74,242,79"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a74a1b2239413fa672392330a886188ec" title=" " alt="" coords="289,123,470,167"/>
<area shape="poly" title=" " alt="" coords="242,117,274,123,273,128,241,122"/>
<area shape="poly" title=" " alt="" coords="331,29,329,19,337,10,354,5,379,3,407,5,423,12,421,17,406,10,379,8,355,10,340,15,334,21,336,28"/>
<area shape="poly" title=" " alt="" coords="331,123,329,112,337,104,354,98,379,96,407,99,423,105,421,110,406,104,379,101,355,103,340,108,334,114,336,122"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5e26beba887f4e95c1c53b5ae2eaacdd_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5e26beba887f4e95c1c53b5ae2eaacdd_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5e26beba887f4e95c1c53b5ae2eaacdd_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5e26beba887f4e95c1c53b5ae2eaacdd_icgraph">
<area shape="rect" title=" " alt="" coords="528,84,763,146"/>
<area shape="poly" title=" " alt="" coords="689,72,673,65,646,63,622,65,606,69,599,76,598,84,592,83,594,73,604,65,621,59,646,57,674,60,691,67"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a6ff266928e356a814d3a1688aedaac56" title=" " alt="" coords="267,29,480,91"/>
<area shape="poly" title=" " alt="" coords="512,91,480,84,481,79,513,86"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a5ca412446df4200dd55e020e802d99f2" title=" " alt="" coords="267,139,480,200"/>
<area shape="poly" title=" " alt="" coords="513,144,481,151,480,145,512,139"/>
<area shape="poly" title=" " alt="" coords="415,17,399,11,373,8,351,10,336,15,328,21,327,29,322,29,324,19,333,10,350,5,373,3,401,5,417,13"/>
<area shape="poly" title=" " alt="" coords="415,127,399,120,373,117,351,119,336,124,328,131,327,139,322,138,324,128,333,119,350,114,373,112,401,115,417,122"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#ae8566ed911e3ebb602e88d9abf773ac0" title=" " alt="" coords="5,139,219,200"/>
<area shape="poly" title=" " alt="" coords="251,172,219,172,219,167,251,167"/>
<area shape="poly" title=" " alt="" coords="154,127,138,120,112,117,89,119,74,124,67,131,66,139,61,138,62,128,72,119,88,114,112,112,139,115,156,122"/>
</map>
</div>

</div>
</div>
<a id="a6ff266928e356a814d3a1688aedaac56" name="a6ff266928e356a814d3a1688aedaac56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ff266928e356a814d3a1688aedaac56">&#9670;&#160;</a></span>DoInsert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AutoHyperClockTable::HandleImpl * ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::DoInsert </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d57/structROCKSDB__NAMESPACE_1_1clock__cache_1_1ClockHandleBasicData.html">ClockHandleBasicData</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>proto</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>initial_countdown</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>take_ref</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/dbb/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1InsertState.html">InsertState</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l02873">2873</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2875</span>                                       {</div>
<div class="line"><span class="lineno"> 2876</span>  <span class="keywordtype">size_t</span> home;</div>
<div class="line"><span class="lineno"> 2877</span>  <span class="keywordtype">int</span> orig_home_shift;</div>
<div class="line"><span class="lineno"> 2878</span>  GetHomeIndexAndShift(state.saved_length_info, proto.hashed_key[1], &amp;home,</div>
<div class="line"><span class="lineno"> 2879</span>                       &amp;orig_home_shift);</div>
<div class="line"><span class="lineno"> 2880</span>  HandleImpl* <span class="keyword">const</span> arr = <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>.<a class="code hl_function" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a9e0a723fcd917e570cf4207a40eef092">Get</a>();</div>
<div class="line"><span class="lineno"> 2881</span> </div>
<div class="line"><span class="lineno"> 2882</span>  <span class="comment">// We could go searching through the chain for any duplicate, but that&#39;s</span></div>
<div class="line"><span class="lineno"> 2883</span>  <span class="comment">// not typically helpful, except for the REDUNDANT block cache stats.</span></div>
<div class="line"><span class="lineno"> 2884</span>  <span class="comment">// (Inferior duplicates will age out with eviction.) However, we do skip</span></div>
<div class="line"><span class="lineno"> 2885</span>  <span class="comment">// insertion if the home slot (or some other we happen to probe) already</span></div>
<div class="line"><span class="lineno"> 2886</span>  <span class="comment">// has a match (already_matches below). This helps to keep better locality</span></div>
<div class="line"><span class="lineno"> 2887</span>  <span class="comment">// when we can.</span></div>
<div class="line"><span class="lineno"> 2888</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2889</span>  <span class="comment">// And we can do that as part of searching for an available slot to</span></div>
<div class="line"><span class="lineno"> 2890</span>  <span class="comment">// insert the new entry, because our preferred location and first slot</span></div>
<div class="line"><span class="lineno"> 2891</span>  <span class="comment">// checked will be the home slot.</span></div>
<div class="line"><span class="lineno"> 2892</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2893</span>  <span class="comment">// As the table initially grows to size, few entries will be in the same</span></div>
<div class="line"><span class="lineno"> 2894</span>  <span class="comment">// cache line as the chain head. However, churn in the cache relatively</span></div>
<div class="line"><span class="lineno"> 2895</span>  <span class="comment">// quickly improves the proportion of entries sharing that cache line with</span></div>
<div class="line"><span class="lineno"> 2896</span>  <span class="comment">// the chain head. Data:</span></div>
<div class="line"><span class="lineno"> 2897</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2898</span>  <span class="comment">// Initial population only: (cache_bench with -ops_per_thread=1)</span></div>
<div class="line"><span class="lineno"> 2899</span>  <span class="comment">// Entries at home count: 29,202 (out of 129,170 entries in 94,411 chains)</span></div>
<div class="line"><span class="lineno"> 2900</span>  <span class="comment">// Approximate average cache lines read to find an existing entry:</span></div>
<div class="line"><span class="lineno"> 2901</span>  <span class="comment">//           129.2 / 94.4 [without the heads]</span></div>
<div class="line"><span class="lineno"> 2902</span>  <span class="comment">// + (94.4 - 29.2) / 94.4 [the heads not included with entries]</span></div>
<div class="line"><span class="lineno"> 2903</span>  <span class="comment">// = 2.06 cache lines</span></div>
<div class="line"><span class="lineno"> 2904</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2905</span>  <span class="comment">// After 10 million ops: (-threads=10 -ops_per_thread=100000)</span></div>
<div class="line"><span class="lineno"> 2906</span>  <span class="comment">// Entries at home count: 67,556 (out of 129,359 entries in 94,756 chains)</span></div>
<div class="line"><span class="lineno"> 2907</span>  <span class="comment">// That&#39;s a majority of entries and more than 2/3rds of chains.</span></div>
<div class="line"><span class="lineno"> 2908</span>  <span class="comment">// Approximate average cache lines read to find an existing entry:</span></div>
<div class="line"><span class="lineno"> 2909</span>  <span class="comment">// = 1.65 cache lines</span></div>
<div class="line"><span class="lineno"> 2910</span> </div>
<div class="line"><span class="lineno"> 2911</span>  <span class="comment">// Even if we aren&#39;t saving a ref to this entry (take_ref == false), we need</span></div>
<div class="line"><span class="lineno"> 2912</span>  <span class="comment">// to keep a reference while we are inserting the entry into a chain, so that</span></div>
<div class="line"><span class="lineno"> 2913</span>  <span class="comment">// it is not erased by another thread while trying to insert it on the chain.</span></div>
<div class="line"><span class="lineno"> 2914</span>  <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> initial_take_ref = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2915</span> </div>
<div class="line"><span class="lineno"> 2916</span>  <span class="keywordtype">size_t</span> used_length = LengthInfoToUsedLength(state.saved_length_info);</div>
<div class="line"><span class="lineno"> 2917</span>  assert(home &lt; used_length);</div>
<div class="line"><span class="lineno"> 2918</span> </div>
<div class="line"><span class="lineno"> 2919</span>  <span class="keywordtype">size_t</span> idx = home;</div>
<div class="line"><span class="lineno"> 2920</span>  <span class="keywordtype">bool</span> already_matches = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2921</span>  <span class="keywordtype">bool</span> already_matches_ignore = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2922</span>  <span class="keywordflow">if</span> (TryInsert(proto, arr[idx], initial_countdown, initial_take_ref,</div>
<div class="line"><span class="lineno"> 2923</span>                &amp;already_matches)) {</div>
<div class="line"><span class="lineno"> 2924</span>    assert(idx == home);</div>
<div class="line"><span class="lineno"> 2925</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (already_matches) {</div>
<div class="line"><span class="lineno"> 2926</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2927</span>    <span class="comment">// Here we try to populate newly-opened slots in the table, but not</span></div>
<div class="line"><span class="lineno"> 2928</span>    <span class="comment">// when we can add something to its home slot. This makes the structure</span></div>
<div class="line"><span class="lineno"> 2929</span>    <span class="comment">// more performant more quickly on (initial) growth. We ignore &quot;already</span></div>
<div class="line"><span class="lineno"> 2930</span>    <span class="comment">// matches&quot; in this case because it is unlikely and difficult to</span></div>
<div class="line"><span class="lineno"> 2931</span>    <span class="comment">// incorporate logic for here cleanly and efficiently.</span></div>
<div class="line"><span class="lineno"> 2932</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d6/dd6/likely_8h.html#ab10d0a221f4d7a706701b806c8135fd7">UNLIKELY</a>(state.likely_empty_slot &gt; 0) &amp;&amp;</div>
<div class="line"><span class="lineno"> 2933</span>             TryInsert(proto, arr[state.likely_empty_slot], initial_countdown,</div>
<div class="line"><span class="lineno"> 2934</span>                       initial_take_ref, &amp;already_matches_ignore)) {</div>
<div class="line"><span class="lineno"> 2935</span>    idx = state.likely_empty_slot;</div>
<div class="line"><span class="lineno"> 2936</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2937</span>    <span class="comment">// We need to search for an available slot outside of the home.</span></div>
<div class="line"><span class="lineno"> 2938</span>    <span class="comment">// Linear hashing provides nice resizing but does typically mean</span></div>
<div class="line"><span class="lineno"> 2939</span>    <span class="comment">// that some heads (home locations) have (in expectation) twice as</span></div>
<div class="line"><span class="lineno"> 2940</span>    <span class="comment">// many entries mapped to them as other heads. For example if the</span></div>
<div class="line"><span class="lineno"> 2941</span>    <span class="comment">// usable length is 80, then heads 16-63 are (in expectation) twice</span></div>
<div class="line"><span class="lineno"> 2942</span>    <span class="comment">// as loaded as heads 0-15 and 64-79, which are using another hash bit.</span></div>
<div class="line"><span class="lineno"> 2943</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2944</span>    <span class="comment">// This means that if we just use linear probing (by a small constant)</span></div>
<div class="line"><span class="lineno"> 2945</span>    <span class="comment">// to find an available slot, part of the structure could easily fill up</span></div>
<div class="line"><span class="lineno"> 2946</span>    <span class="comment">// and resort to linear time operations even when the overall load factor</span></div>
<div class="line"><span class="lineno"> 2947</span>    <span class="comment">// is only modestly high, like 70%. Even though each slot has its own CPU</span></div>
<div class="line"><span class="lineno"> 2948</span>    <span class="comment">// cache line, there appears to be a small locality benefit (e.g. TLB and</span></div>
<div class="line"><span class="lineno"> 2949</span>    <span class="comment">// paging) to iterating one by one, as long as we don&#39;t afoul of the</span></div>
<div class="line"><span class="lineno"> 2950</span>    <span class="comment">// linear hashing imbalance.</span></div>
<div class="line"><span class="lineno"> 2951</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2952</span>    <span class="comment">// In a traditional non-concurrent structure, we could keep a &quot;free list&quot;</span></div>
<div class="line"><span class="lineno"> 2953</span>    <span class="comment">// to ensure immediate access to an available slot, but maintaining such</span></div>
<div class="line"><span class="lineno"> 2954</span>    <span class="comment">// a structure could require more cross-thread coordination to ensure</span></div>
<div class="line"><span class="lineno"> 2955</span>    <span class="comment">// all entries are eventually available to all threads.</span></div>
<div class="line"><span class="lineno"> 2956</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2957</span>    <span class="comment">// The way we solve this problem is to use unit-increment linear probing</span></div>
<div class="line"><span class="lineno"> 2958</span>    <span class="comment">// with a small bound, and then fall back on big jumps to have a good</span></div>
<div class="line"><span class="lineno"> 2959</span>    <span class="comment">// chance of finding a slot in an under-populated region quickly if that</span></div>
<div class="line"><span class="lineno"> 2960</span>    <span class="comment">// doesn&#39;t work.</span></div>
<div class="line"><span class="lineno"> 2961</span>    <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><span class="lineno"> 2962</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> kMaxLinearProbe = 4;</div>
<div class="line"><span class="lineno"> 2963</span>    <span class="keywordflow">for</span> (; i &lt; kMaxLinearProbe; i++) {</div>
<div class="line"><span class="lineno"> 2964</span>      idx++;</div>
<div class="line"><span class="lineno"> 2965</span>      <span class="keywordflow">if</span> (idx &gt;= used_length) {</div>
<div class="line"><span class="lineno"> 2966</span>        idx -= used_length;</div>
<div class="line"><span class="lineno"> 2967</span>      }</div>
<div class="line"><span class="lineno"> 2968</span>      <span class="keywordflow">if</span> (TryInsert(proto, arr[idx], initial_countdown, initial_take_ref,</div>
<div class="line"><span class="lineno"> 2969</span>                    &amp;already_matches)) {</div>
<div class="line"><span class="lineno"> 2970</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2971</span>      }</div>
<div class="line"><span class="lineno"> 2972</span>      <span class="keywordflow">if</span> (already_matches) {</div>
<div class="line"><span class="lineno"> 2973</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2974</span>      }</div>
<div class="line"><span class="lineno"> 2975</span>    }</div>
<div class="line"><span class="lineno"> 2976</span>    <span class="keywordflow">if</span> (i == kMaxLinearProbe) {</div>
<div class="line"><span class="lineno"> 2977</span>      <span class="comment">// Keep searching, but change to a search method that should quickly</span></div>
<div class="line"><span class="lineno"> 2978</span>      <span class="comment">// find any under-populated region. Switching to an increment based</span></div>
<div class="line"><span class="lineno"> 2979</span>      <span class="comment">// on the golden ratio helps with that, but we also inject some minor</span></div>
<div class="line"><span class="lineno"> 2980</span>      <span class="comment">// variation (less than 2%, 1 in 2^6) to avoid clustering effects on</span></div>
<div class="line"><span class="lineno"> 2981</span>      <span class="comment">// this larger increment (if it were a fixed value in steady state</span></div>
<div class="line"><span class="lineno"> 2982</span>      <span class="comment">// operation). Here we are primarily using upper bits of hashed_key[1]</span></div>
<div class="line"><span class="lineno"> 2983</span>      <span class="comment">// while home is based on lowest bits.</span></div>
<div class="line"><span class="lineno"> 2984</span>      uint64_t incr_ratio = 0x9E3779B185EBCA87U + (proto.hashed_key[1] &gt;&gt; 6);</div>
<div class="line"><span class="lineno"> 2985</span>      <span class="keywordtype">size_t</span> incr = <a class="code hl_function" href="../../da/df2/hash__test_8cc.html#a652881b3f38b0f0b3eee76a28123bbfe">FastRange64</a>(incr_ratio, used_length);</div>
<div class="line"><span class="lineno"> 2986</span>      assert(incr &gt; 0);</div>
<div class="line"><span class="lineno"> 2987</span>      <span class="keywordtype">size_t</span> start = idx;</div>
<div class="line"><span class="lineno"> 2988</span>      <span class="keywordflow">for</span> (;; i++) {</div>
<div class="line"><span class="lineno"> 2989</span>        idx += incr;</div>
<div class="line"><span class="lineno"> 2990</span>        <span class="keywordflow">if</span> (idx &gt;= used_length) {</div>
<div class="line"><span class="lineno"> 2991</span>          <span class="comment">// Wrap around (faster than %)</span></div>
<div class="line"><span class="lineno"> 2992</span>          idx -= used_length;</div>
<div class="line"><span class="lineno"> 2993</span>        }</div>
<div class="line"><span class="lineno"> 2994</span>        <span class="keywordflow">if</span> (idx == start) {</div>
<div class="line"><span class="lineno"> 2995</span>          <span class="comment">// We have just completed a cycle that might not have covered all</span></div>
<div class="line"><span class="lineno"> 2996</span>          <span class="comment">// slots. (incr and used_length could have common factors.)</span></div>
<div class="line"><span class="lineno"> 2997</span>          <span class="comment">// Increment for the next cycle, which eventually ensures complete</span></div>
<div class="line"><span class="lineno"> 2998</span>          <span class="comment">// iteration over the set of slots before repeating.</span></div>
<div class="line"><span class="lineno"> 2999</span>          idx++;</div>
<div class="line"><span class="lineno"> 3000</span>          <span class="keywordflow">if</span> (idx &gt;= used_length) {</div>
<div class="line"><span class="lineno"> 3001</span>            idx -= used_length;</div>
<div class="line"><span class="lineno"> 3002</span>          }</div>
<div class="line"><span class="lineno"> 3003</span>          start++;</div>
<div class="line"><span class="lineno"> 3004</span>          <span class="keywordflow">if</span> (start &gt;= used_length) {</div>
<div class="line"><span class="lineno"> 3005</span>            start -= used_length;</div>
<div class="line"><span class="lineno"> 3006</span>          }</div>
<div class="line"><span class="lineno"> 3007</span>          <span class="keywordflow">if</span> (i &gt;= used_length) {</div>
<div class="line"><span class="lineno"> 3008</span>            used_length = LengthInfoToUsedLength(<a class="code hl_variable" href="#a691cf5bc49f36f3001d8c980901de288">length_info_</a>.<a class="code hl_function" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a5361060db542ce3ebfd914aecb908f8c">Load</a>());</div>
<div class="line"><span class="lineno"> 3009</span>            <span class="keywordflow">if</span> (i &gt;= used_length * 2) {</div>
<div class="line"><span class="lineno"> 3010</span>              <span class="comment">// Cycling back should not happen unless there is enough random</span></div>
<div class="line"><span class="lineno"> 3011</span>              <span class="comment">// churn in parallel that we happen to hit each slot at a time</span></div>
<div class="line"><span class="lineno"> 3012</span>              <span class="comment">// that it&#39;s occupied, which is really only feasible for small</span></div>
<div class="line"><span class="lineno"> 3013</span>              <span class="comment">// structures, though with linear probing to find empty slots,</span></div>
<div class="line"><span class="lineno"> 3014</span>              <span class="comment">// &quot;small&quot; here might be larger than for double hashing.</span></div>
<div class="line"><span class="lineno"> 3015</span>              assert(used_length &lt;= 256);</div>
<div class="line"><span class="lineno"> 3016</span>              <span class="comment">// Fall back on standalone insert in case something goes awry to</span></div>
<div class="line"><span class="lineno"> 3017</span>              <span class="comment">// cause this</span></div>
<div class="line"><span class="lineno"> 3018</span>              <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 3019</span>            }</div>
<div class="line"><span class="lineno"> 3020</span>          }</div>
<div class="line"><span class="lineno"> 3021</span>        }</div>
<div class="line"><span class="lineno"> 3022</span>        <span class="keywordflow">if</span> (TryInsert(proto, arr[idx], initial_countdown, initial_take_ref,</div>
<div class="line"><span class="lineno"> 3023</span>                      &amp;already_matches)) {</div>
<div class="line"><span class="lineno"> 3024</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3025</span>        }</div>
<div class="line"><span class="lineno"> 3026</span>        <span class="keywordflow">if</span> (already_matches) {</div>
<div class="line"><span class="lineno"> 3027</span>          <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 3028</span>        }</div>
<div class="line"><span class="lineno"> 3029</span>      }</div>
<div class="line"><span class="lineno"> 3030</span>    }</div>
<div class="line"><span class="lineno"> 3031</span>  }</div>
<div class="line"><span class="lineno"> 3032</span> </div>
<div class="line"><span class="lineno"> 3033</span>  <span class="comment">// Now insert into chain using head pointer</span></div>
<div class="line"><span class="lineno"> 3034</span>  uint64_t next_with_shift;</div>
<div class="line"><span class="lineno"> 3035</span>  <span class="keywordtype">int</span> home_shift = orig_home_shift;</div>
<div class="line"><span class="lineno"> 3036</span> </div>
<div class="line"><span class="lineno"> 3037</span>  <span class="comment">// Might need to retry</span></div>
<div class="line"><span class="lineno"> 3038</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0;; ++i) {</div>
<div class="line"><span class="lineno"> 3039</span>    <a class="code hl_define" href="../../d0/d8b/clock__cache_8cc.html#afe85b67c91564218df748652e3d954f1">CHECK_TOO_MANY_ITERATIONS</a>(i);</div>
<div class="line"><span class="lineno"> 3040</span>    next_with_shift = arr[home].head_next_with_shift.Load();</div>
<div class="line"><span class="lineno"> 3041</span>    <span class="keywordtype">int</span> shift = GetShiftFromNextWithShift(next_with_shift);</div>
<div class="line"><span class="lineno"> 3042</span> </div>
<div class="line"><span class="lineno"> 3043</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d6/dd6/likely_8h.html#ab10d0a221f4d7a706701b806c8135fd7">UNLIKELY</a>(shift != home_shift)) {</div>
<div class="line"><span class="lineno"> 3044</span>      <span class="comment">// NOTE: shift increases with table growth</span></div>
<div class="line"><span class="lineno"> 3045</span>      <span class="keywordflow">if</span> (shift &gt; home_shift) {</div>
<div class="line"><span class="lineno"> 3046</span>        <span class="comment">// Must be grow in progress or completed since reading length_info.</span></div>
<div class="line"><span class="lineno"> 3047</span>        <span class="comment">// Pull out one more hash bit. (See Lookup() for why we can&#39;t</span></div>
<div class="line"><span class="lineno"> 3048</span>        <span class="comment">// safely jump to the shift that was read.)</span></div>
<div class="line"><span class="lineno"> 3049</span>        home_shift++;</div>
<div class="line"><span class="lineno"> 3050</span>        uint64_t hash_bit_mask = uint64_t{1} &lt;&lt; (home_shift - 1);</div>
<div class="line"><span class="lineno"> 3051</span>        assert((home &amp; hash_bit_mask) == 0);</div>
<div class="line"><span class="lineno"> 3052</span>        <span class="comment">// BEGIN leftover updates to length_info_ for Grow()</span></div>
<div class="line"><span class="lineno"> 3053</span>        <span class="keywordtype">size_t</span> grow_home = home + hash_bit_mask;</div>
<div class="line"><span class="lineno"> 3054</span>        assert(arr[grow_home].head_next_with_shift.Load() !=</div>
<div class="line"><span class="lineno"> 3055</span>               HandleImpl::kUnusedMarker);</div>
<div class="line"><span class="lineno"> 3056</span>        <a class="code hl_function" href="#a5e26beba887f4e95c1c53b5ae2eaacdd">CatchUpLengthInfoNoWait</a>(grow_home);</div>
<div class="line"><span class="lineno"> 3057</span>        <span class="comment">// END leftover updates to length_info_ for Grow()</span></div>
<div class="line"><span class="lineno"> 3058</span>        home += proto.hashed_key[1] &amp; hash_bit_mask;</div>
<div class="line"><span class="lineno"> 3059</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3060</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3061</span>        <span class="comment">// Should not happen because length_info_ is only updated after both</span></div>
<div class="line"><span class="lineno"> 3062</span>        <span class="comment">// old and new home heads are marked with new shift</span></div>
<div class="line"><span class="lineno"> 3063</span>        assert(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3064</span>      }</div>
<div class="line"><span class="lineno"> 3065</span>    }</div>
<div class="line"><span class="lineno"> 3066</span> </div>
<div class="line"><span class="lineno"> 3067</span>    <span class="comment">// Values to update to</span></div>
<div class="line"><span class="lineno"> 3068</span>    uint64_t head_next_with_shift = MakeNextWithShift(idx, home_shift);</div>
<div class="line"><span class="lineno"> 3069</span>    uint64_t chain_next_with_shift = next_with_shift;</div>
<div class="line"><span class="lineno"> 3070</span> </div>
<div class="line"><span class="lineno"> 3071</span>    <span class="comment">// Preserve the locked state in head, without propagating to chain next</span></div>
<div class="line"><span class="lineno"> 3072</span>    <span class="comment">// where it is meaningless (and not allowed)</span></div>
<div class="line"><span class="lineno"> 3073</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d6/dd6/likely_8h.html#ab10d0a221f4d7a706701b806c8135fd7">UNLIKELY</a>((next_with_shift &amp; HandleImpl::kNextEndFlags) ==</div>
<div class="line"><span class="lineno"> 3074</span>                 HandleImpl::kHeadLocked)) {</div>
<div class="line"><span class="lineno"> 3075</span>      head_next_with_shift |= HandleImpl::kHeadLocked;</div>
<div class="line"><span class="lineno"> 3076</span>      chain_next_with_shift &amp;= ~HandleImpl::kHeadLocked;</div>
<div class="line"><span class="lineno"> 3077</span>    }</div>
<div class="line"><span class="lineno"> 3078</span> </div>
<div class="line"><span class="lineno"> 3079</span>    arr[idx].chain_next_with_shift.Store(chain_next_with_shift);</div>
<div class="line"><span class="lineno"> 3080</span>    <span class="keywordflow">if</span> (arr[home].head_next_with_shift.CasWeak(next_with_shift,</div>
<div class="line"><span class="lineno"> 3081</span>                                               head_next_with_shift)) {</div>
<div class="line"><span class="lineno"> 3082</span>      <span class="comment">// Success</span></div>
<div class="line"><span class="lineno"> 3083</span>      <span class="keywordflow">if</span> (!take_ref) {</div>
<div class="line"><span class="lineno"> 3084</span>        Unref(arr[idx]);</div>
<div class="line"><span class="lineno"> 3085</span>      }</div>
<div class="line"><span class="lineno"> 3086</span>      <span class="keywordflow">return</span> arr + idx;</div>
<div class="line"><span class="lineno"> 3087</span>    }</div>
<div class="line"><span class="lineno"> 3088</span>  }</div>
<div class="line"><span class="lineno"> 3089</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1TypedMemMapping_html_a9e0a723fcd917e570cf4207a40eef092"><div class="ttname"><a href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a9e0a723fcd917e570cf4207a40eef092">ROCKSDB_NAMESPACE::TypedMemMapping::Get</a></div><div class="ttdeci">T * Get() const</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d5a/mmap_8h_source.html#l00084">mmap.h:84</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_a5e26beba887f4e95c1c53b5ae2eaacdd"><div class="ttname"><a href="#a5e26beba887f4e95c1c53b5ae2eaacdd">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::CatchUpLengthInfoNoWait</a></div><div class="ttdeci">void CatchUpLengthInfoNoWait(size_t known_usable_grow_home)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l02259">clock_cache.cc:2259</a></div></div>
<div class="ttc" id="aclock__cache_8cc_html_afe85b67c91564218df748652e3d954f1"><div class="ttname"><a href="../../d0/d8b/clock__cache_8cc.html#afe85b67c91564218df748652e3d954f1">CHECK_TOO_MANY_ITERATIONS</a></div><div class="ttdeci">#define CHECK_TOO_MANY_ITERATIONS(i)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l02143">clock_cache.cc:2143</a></div></div>
<div class="ttc" id="ahash__test_8cc_html_a652881b3f38b0f0b3eee76a28123bbfe"><div class="ttname"><a href="../../da/df2/hash__test_8cc.html#a652881b3f38b0f0b3eee76a28123bbfe">FastRange64</a></div><div class="ttdeci">size_t FastRange64(uint64_t hash, size_t range)</div><div class="ttdef"><b>Definition</b> <a href="../../da/df2/hash__test_8cc_source.html#l00561">hash_test.cc:561</a></div></div>
<div class="ttc" id="alikely_8h_html_ab10d0a221f4d7a706701b806c8135fd7"><div class="ttname"><a href="../../d6/dd6/likely_8h.html#ab10d0a221f4d7a706701b806c8135fd7">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dd6/likely_8h_source.html#l00017">likely.h:17</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6ff266928e356a814d3a1688aedaac56_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6ff266928e356a814d3a1688aedaac56_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6ff266928e356a814d3a1688aedaac56_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6ff266928e356a814d3a1688aedaac56_cgraph">
<area shape="rect" title=" " alt="" coords="5,102,219,164"/>
<area shape="poly" title=" " alt="" coords="59,102,60,92,70,83,87,77,112,76,140,78,158,85,156,90,139,83,112,81,88,83,73,88,65,94,64,102"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a5e26beba887f4e95c1c53b5ae2eaacdd" title=" " alt="" coords="267,68,502,129"/>
<area shape="poly" title=" " alt="" coords="219,117,251,113,252,118,219,122"/>
<area shape="rect" href="../../da/df2/hash__test_8cc.html#a652881b3f38b0f0b3eee76a28123bbfe" title=" " alt="" coords="332,154,437,182"/>
<area shape="poly" title=" " alt="" coords="219,144,316,156,316,162,219,149"/>
<area shape="poly" title=" " alt="" coords="334,67,335,57,345,48,361,43,384,41,411,44,428,51,425,56,410,49,384,46,362,48,347,53,340,59,339,68"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="550,29,731,74"/>
<area shape="poly" title=" " alt="" coords="502,74,534,68,535,74,503,79"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a74a1b2239413fa672392330a886188ec" title=" " alt="" coords="550,123,731,167"/>
<area shape="poly" title=" " alt="" coords="503,117,535,123,534,128,502,122"/>
<area shape="poly" title=" " alt="" coords="592,29,591,19,599,10,616,5,641,3,668,5,685,12,683,17,667,10,641,8,617,10,602,15,596,21,597,28"/>
<area shape="poly" title=" " alt="" coords="592,123,591,112,599,104,616,98,641,96,668,99,685,105,683,110,667,104,641,101,617,103,602,108,596,114,597,122"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6ff266928e356a814d3a1688aedaac56_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6ff266928e356a814d3a1688aedaac56_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6ff266928e356a814d3a1688aedaac56_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6ff266928e356a814d3a1688aedaac56_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="146,17,133,11,112,8,94,10,82,15,76,21,75,29,70,29,71,19,79,10,92,5,112,3,135,5,148,13"/>
</map>
</div>

</div>
</div>
<a id="aa5b762aa6657b81ad29f6cd51ea9f305" name="aa5b762aa6657b81ad29f6cd51ea9f305"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5b762aa6657b81ad29f6cd51ea9f305">&#9670;&#160;</a></span>Erase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::Erase </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af4c4e4074a950ca9c8bc7e635a784bf7">UniqueId64x2</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>hashed_key</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l03433">3433</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3433</span>                                                              {</div>
<div class="line"><span class="lineno"> 3434</span>  <span class="comment">// Don&#39;t need to be efficient.</span></div>
<div class="line"><span class="lineno"> 3435</span>  <span class="comment">// Might be one match masking another, so loop.</span></div>
<div class="line"><span class="lineno"> 3436</span>  <span class="keywordflow">while</span> (HandleImpl* h = <a class="code hl_function" href="#af9c1fa5039809f0efeb200afc4db8bf8">Lookup</a>(hashed_key)) {</div>
<div class="line"><span class="lineno"> 3437</span>    <span class="keywordtype">bool</span> gone =</div>
<div class="line"><span class="lineno"> 3438</span>        <a class="code hl_function" href="#a53060e46ed4e542a6db7f0e6bdae9c8a">TryEraseHandle</a>(h, <span class="comment">/*holding_ref=*/</span><span class="keyword">true</span>, <span class="comment">/*mark_invisible=*/</span><span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3439</span>    <span class="keywordflow">if</span> (!gone) {</div>
<div class="line"><span class="lineno"> 3440</span>      <span class="comment">// Only marked invisible, which is ok.</span></div>
<div class="line"><span class="lineno"> 3441</span>      <span class="comment">// Pretend we never took the reference from Lookup.</span></div>
<div class="line"><span class="lineno"> 3442</span>      Unref(*h);</div>
<div class="line"><span class="lineno"> 3443</span>    }</div>
<div class="line"><span class="lineno"> 3444</span>  }</div>
<div class="line"><span class="lineno"> 3445</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_a53060e46ed4e542a6db7f0e6bdae9c8a"><div class="ttname"><a href="#a53060e46ed4e542a6db7f0e6bdae9c8a">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::TryEraseHandle</a></div><div class="ttdeci">bool TryEraseHandle(HandleImpl *h, bool holding_ref, bool mark_invisible)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l03335">clock_cache.cc:3335</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_af9c1fa5039809f0efeb200afc4db8bf8"><div class="ttname"><a href="#af9c1fa5039809f0efeb200afc4db8bf8">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::Lookup</a></div><div class="ttdeci">HandleImpl * Lookup(const UniqueId64x2 &amp;hashed_key)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l03091">clock_cache.cc:3091</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_aa5b762aa6657b81ad29f6cd51ea9f305_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_aa5b762aa6657b81ad29f6cd51ea9f305_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_aa5b762aa6657b81ad29f6cd51ea9f305_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_aa5b762aa6657b81ad29f6cd51ea9f305_cgraph">
<area shape="rect" title=" " alt="" coords="5,139,219,201"/>
<area shape="poly" title=" " alt="" coords="61,139,62,129,72,120,88,115,112,113,139,115,156,123,154,128,138,121,112,118,89,120,74,125,67,131,66,140"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#af9c1fa5039809f0efeb200afc4db8bf8" title=" " alt="" coords="267,67,480,129"/>
<area shape="poly" title=" " alt="" coords="219,138,251,129,252,134,220,143"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a53060e46ed4e542a6db7f0e6bdae9c8a" title=" " alt="" coords="267,194,480,256"/>
<area shape="poly" title=" " alt="" coords="220,190,252,197,251,202,219,195"/>
<area shape="poly" title=" " alt="" coords="322,67,324,57,333,48,350,43,373,41,401,43,417,51,415,56,399,49,373,46,351,48,336,53,328,59,327,68"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="1340,43,1521,87"/>
<area shape="poly" title=" " alt="" coords="440,64,483,49,527,37,640,18,736,8,821,3,900,4,1066,17,1276,37,1325,43,1325,48,1276,42,1065,22,900,9,821,9,736,13,641,24,529,42,484,54,442,69"/>
<area shape="rect" href="../../d9/d54/classROCKSDB__NAMESPACE_1_1Random.html#a4c57e895d1948533257b40c47d833ea5" title=" " alt="" coords="542,76,727,121"/>
<area shape="poly" title=" " alt="" coords="481,96,527,96,527,101,481,101"/>
<area shape="poly" title=" " alt="" coords="1380,42,1379,32,1387,23,1405,18,1431,16,1459,18,1476,25,1474,30,1458,24,1431,21,1406,23,1390,28,1384,34,1385,42"/>
<area shape="poly" title=" " alt="" coords="585,76,584,66,592,57,609,51,635,49,663,52,680,58,678,63,662,57,635,55,610,56,595,61,589,67,590,75"/>
<area shape="rect" href="../../d9/d54/classROCKSDB__NAMESPACE_1_1Random.html#a888cf2ca1df96e1684d405ae41c2407a" title=" " alt="" coords="805,64,987,109"/>
<area shape="poly" title=" " alt="" coords="727,91,790,88,790,94,727,97"/>
<area shape="rect" href="../../d9/d54/classROCKSDB__NAMESPACE_1_1Random.html#a36e0813921e89bdf5af60a3a58a33565" title=" " alt="" coords="1073,52,1254,97"/>
<area shape="poly" title=" " alt="" coords="987,79,1057,76,1057,82,987,85"/>
<area shape="poly" title=" " alt="" coords="322,194,324,183,333,175,350,169,373,167,401,170,417,177,415,182,399,175,373,173,351,175,336,179,328,186,327,194"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a24212c074c37a92800c31882b2907f8d" title=" " alt="" coords="528,203,741,265"/>
<area shape="poly" title=" " alt="" coords="481,226,513,227,512,233,481,231"/>
<area shape="poly" title=" " alt="" coords="583,203,585,193,594,184,611,179,635,177,662,179,679,187,677,192,661,185,635,182,612,184,597,189,590,195,589,204"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a353c1aa19f1e338db90086bdca07407b" title=" " alt="" coords="789,213,1003,274"/>
<area shape="poly" title=" " alt="" coords="742,235,774,237,774,242,742,241"/>
<area shape="poly" title=" " alt="" coords="845,212,846,202,856,194,872,188,896,186,923,189,940,196,938,201,922,194,896,191,873,193,858,198,851,205,850,213"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#afe0c39ddafa0f49b10f9fe77ad8e702b" title=" " alt="" coords="1590,199,1804,278"/>
<area shape="poly" title=" " alt="" coords="1003,240,1575,236,1575,242,1003,246"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a30417ab9b027b7113a0573d4fa6c7edb" title=" " alt="" coords="1585,449,1809,510"/>
<area shape="poly" title=" " alt="" coords="919,273,974,342,1010,378,1052,408,1115,438,1181,461,1250,478,1319,488,1388,494,1453,496,1570,492,1570,497,1453,501,1388,499,1319,494,1249,483,1180,466,1113,443,1049,413,1007,382,970,346,915,276"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a4c68c3c5ccbe3c20bd71313b1a0f8e10" title=" " alt="" coords="1057,145,1270,206"/>
<area shape="poly" title=" " alt="" coords="1002,214,1041,204,1043,209,1004,219"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#ad0040262551e4d03603956bb5cea8b07" title=" " alt="" coords="1051,337,1276,398"/>
<area shape="poly" title=" " alt="" coords="966,273,1083,327,1080,332,963,277"/>
<area shape="poly" title=" " alt="" coords="1239,142,1360,91,1362,96,1241,147"/>
<area shape="poly" title=" " alt="" coords="1271,185,1575,221,1575,227,1270,191"/>
<area shape="poly" title=" " alt="" coords="1111,144,1112,134,1122,125,1139,120,1163,118,1191,121,1208,128,1206,133,1190,126,1163,123,1140,125,1125,130,1117,137,1116,145"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a13edad9a2ec43bc685dd5a1aaf70c21f" title=" " alt="" coords="1324,276,1537,355"/>
<area shape="poly" title=" " alt="" coords="1225,205,1342,266,1339,271,1223,209"/>
<area shape="poly" title=" " alt="" coords="1537,282,1575,271,1576,276,1538,287"/>
<area shape="poly" title=" " alt="" coords="1518,353,1539,365,1563,385,1587,405,1634,438,1631,442,1584,410,1560,389,1536,370,1516,358"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#af094887ce078b9180b272800614bd2ee" title=" " alt="" coords="1590,316,1804,395"/>
<area shape="poly" title=" " alt="" coords="1538,329,1575,335,1574,340,1537,334"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631" title=" " alt="" coords="1857,333,2098,378"/>
<area shape="poly" title=" " alt="" coords="1804,353,1841,353,1841,358,1804,358"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a451c426fc0333c92fe9da85c3c1abd4a" title=" " alt="" coords="1324,379,1537,458"/>
<area shape="poly" title=" " alt="" coords="1277,386,1309,392,1308,398,1276,392"/>
<area shape="poly" title=" " alt="" coords="1537,391,1575,382,1576,387,1538,396"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_aa5b762aa6657b81ad29f6cd51ea9f305_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_aa5b762aa6657b81ad29f6cd51ea9f305_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_aa5b762aa6657b81ad29f6cd51ea9f305_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_aa5b762aa6657b81ad29f6cd51ea9f305_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="146,17,133,11,112,8,94,10,82,15,76,21,75,29,70,29,71,19,79,10,92,5,112,3,135,5,148,13"/>
</map>
</div>

</div>
</div>
<a id="acecc474c0a88e9db56f62463c297fee0" name="acecc474c0a88e9db56f62463c297fee0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acecc474c0a88e9db56f62463c297fee0">&#9670;&#160;</a></span>EraseUnRefEntries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::EraseUnRefEntries </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l03447">3447</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3447</span>                                            {</div>
<div class="line"><span class="lineno"> 3448</span>  <span class="keywordtype">size_t</span> usable_size = <a class="code hl_function" href="#a064c2e0057bdd3eff5edb1537bffd356">GetTableSize</a>();</div>
<div class="line"><span class="lineno"> 3449</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; usable_size; i++) {</div>
<div class="line"><span class="lineno"> 3450</span>    HandleImpl&amp; h = <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>[i];</div>
<div class="line"><span class="lineno"> 3451</span> </div>
<div class="line"><span class="lineno"> 3452</span>    uint64_t old_meta = h.meta.LoadRelaxed();</div>
<div class="line"><span class="lineno"> 3453</span>    <span class="keywordflow">if</span> (old_meta &amp; (uint64_t{ClockHandle::kStateShareableBit}</div>
<div class="line"><span class="lineno"> 3454</span>                    &lt;&lt; ClockHandle::kStateShift) &amp;&amp;</div>
<div class="line"><span class="lineno"> 3455</span>        GetRefcount(old_meta) == 0 &amp;&amp;</div>
<div class="line"><span class="lineno"> 3456</span>        h.meta.CasStrong(old_meta, uint64_t{ClockHandle::kStateConstruction}</div>
<div class="line"><span class="lineno"> 3457</span>                                       &lt;&lt; ClockHandle::kStateShift)) {</div>
<div class="line"><span class="lineno"> 3458</span>      <span class="comment">// Took ownership</span></div>
<div class="line"><span class="lineno"> 3459</span>      h.FreeData(allocator_);</div>
<div class="line"><span class="lineno"> 3460</span>      <a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a83cfd21cdc4064eaad12cf25f7dc0011">usage_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6eee24b94e05b32724d318d80b24397d">FetchSubRelaxed</a>(h.total_charge);</div>
<div class="line"><span class="lineno"> 3461</span>      <span class="comment">// NOTE: could be more efficient with a dedicated variant of</span></div>
<div class="line"><span class="lineno"> 3462</span>      <span class="comment">// PurgeImpl, but this is not a common operation</span></div>
<div class="line"><span class="lineno"> 3463</span>      <a class="code hl_function" href="#a24212c074c37a92800c31882b2907f8d">Remove</a>(&amp;h);</div>
<div class="line"><span class="lineno"> 3464</span>      MarkEmpty(h);</div>
<div class="line"><span class="lineno"> 3465</span>      <a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ac77e847a676d7b1c9b23386e8fc0671b">occupancy_</a>.<a class="code hl_function" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a215ec373e21f9b51cdc18cfb082d7bca">FetchSub</a>(1U);</div>
<div class="line"><span class="lineno"> 3466</span>    }</div>
<div class="line"><span class="lineno"> 3467</span>  }</div>
<div class="line"><span class="lineno"> 3468</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1AcqRelAtomic_html_a215ec373e21f9b51cdc18cfb082d7bca"><div class="ttname"><a href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a215ec373e21f9b51cdc18cfb082d7bca">ROCKSDB_NAMESPACE::AcqRelAtomic::FetchSub</a></div><div class="ttdeci">T FetchSub(T operand)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d02/atomic_8h_source.html#l00097">atomic.h:97</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_a24212c074c37a92800c31882b2907f8d"><div class="ttname"><a href="#a24212c074c37a92800c31882b2907f8d">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::Remove</a></div><div class="ttdeci">void Remove(HandleImpl *h)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l03327">clock_cache.cc:3327</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_acecc474c0a88e9db56f62463c297fee0_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_acecc474c0a88e9db56f62463c297fee0_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_acecc474c0a88e9db56f62463c297fee0_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_acecc474c0a88e9db56f62463c297fee0_cgraph">
<area shape="rect" title=" " alt="" coords="5,122,219,184"/>
<area shape="poly" title=" " alt="" coords="61,121,62,111,72,103,88,97,112,95,139,98,156,105,154,110,138,103,112,100,89,102,74,107,67,114,66,122"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a064c2e0057bdd3eff5edb1537bffd356" title=" " alt="" coords="267,67,480,129"/>
<area shape="poly" title=" " alt="" coords="219,128,251,121,252,126,220,133"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a24212c074c37a92800c31882b2907f8d" title=" " alt="" coords="267,176,480,238"/>
<area shape="poly" title=" " alt="" coords="220,172,252,179,251,184,219,178"/>
<area shape="poly" title=" " alt="" coords="322,67,324,57,333,48,350,42,373,41,401,43,417,50,415,55,399,48,373,46,351,48,336,53,328,59,327,67"/>
<area shape="poly" title=" " alt="" coords="322,176,324,166,333,157,350,152,373,150,401,153,417,160,415,165,399,158,373,155,351,157,336,162,328,168,327,177"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a353c1aa19f1e338db90086bdca07407b" title=" " alt="" coords="528,176,741,238"/>
<area shape="poly" title=" " alt="" coords="481,205,513,205,513,210,481,210"/>
<area shape="poly" title=" " alt="" coords="583,176,585,166,594,157,611,152,635,150,662,153,679,160,677,165,661,158,635,155,612,157,597,162,590,168,589,177"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#afe0c39ddafa0f49b10f9fe77ad8e702b" title=" " alt="" coords="1329,5,1542,84"/>
<area shape="poly" title=" " alt="" coords="670,174,723,133,788,96,854,70,923,52,994,38,1065,30,1199,25,1314,29,1313,34,1199,30,1065,35,995,44,925,57,856,76,790,100,726,137,673,178"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a30417ab9b027b7113a0573d4fa6c7edb" title=" " alt="" coords="1324,142,1547,204"/>
<area shape="poly" title=" " alt="" coords="739,236,851,262,986,281,1059,286,1132,285,1205,278,1275,263,1331,241,1381,211,1384,215,1334,246,1277,269,1206,283,1132,290,1059,291,986,287,850,267,738,241"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a4c68c3c5ccbe3c20bd71313b1a0f8e10" title=" " alt="" coords="795,134,1009,196"/>
<area shape="poly" title=" " alt="" coords="741,188,780,181,781,187,742,193"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#ad0040262551e4d03603956bb5cea8b07" title=" " alt="" coords="789,332,1015,394"/>
<area shape="poly" title=" " alt="" coords="681,236,791,308,819,323,817,328,788,312,678,241"/>
<area shape="poly" title=" " alt="" coords="942,131,997,96,1062,67,1125,52,1191,42,1314,36,1314,42,1191,48,1126,57,1064,73,999,101,945,136"/>
<area shape="poly" title=" " alt="" coords="850,133,851,123,861,115,878,109,902,107,930,110,947,117,945,122,929,115,902,112,879,114,863,119,856,126,855,134"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="1079,209,1260,254"/>
<area shape="poly" title=" " alt="" coords="1010,189,1064,202,1063,208,1008,194"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a13edad9a2ec43bc685dd5a1aaf70c21f" title=" " alt="" coords="1063,83,1276,161"/>
<area shape="poly" title=" " alt="" coords="1009,145,1047,139,1048,144,1010,150"/>
<area shape="poly" title=" " alt="" coords="1119,209,1117,199,1126,190,1143,184,1169,182,1198,185,1215,191,1213,196,1197,190,1169,188,1144,190,1129,194,1122,200,1124,208"/>
<area shape="poly" title=" " alt="" coords="1276,88,1313,77,1315,83,1277,94"/>
<area shape="poly" title=" " alt="" coords="1277,140,1309,146,1308,151,1276,145"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#af094887ce078b9180b272800614bd2ee" title=" " alt="" coords="1329,295,1542,373"/>
<area shape="poly" title=" " alt="" coords="1261,160,1278,171,1329,217,1390,281,1386,285,1325,221,1274,175,1258,164"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631" title=" " alt="" coords="1595,312,1837,356"/>
<area shape="poly" title=" " alt="" coords="1543,331,1580,331,1580,337,1543,337"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a451c426fc0333c92fe9da85c3c1abd4a" title=" " alt="" coords="1063,329,1276,408"/>
<area shape="poly" title=" " alt="" coords="1015,363,1047,364,1047,369,1015,368"/>
<area shape="poly" title=" " alt="" coords="1276,352,1313,347,1314,353,1277,357"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_acecc474c0a88e9db56f62463c297fee0_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_acecc474c0a88e9db56f62463c297fee0_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_acecc474c0a88e9db56f62463c297fee0_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_acecc474c0a88e9db56f62463c297fee0_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="146,17,133,11,112,8,94,10,82,15,76,21,75,29,70,29,71,19,79,10,92,5,112,3,135,5,148,13"/>
</map>
</div>

</div>
</div>
<a id="a9055868cef9d318a6d4bc97cc2f55c8d" name="a9055868cef9d318a6d4bc97cc2f55c8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9055868cef9d318a6d4bc97cc2f55c8d">&#9670;&#160;</a></span>Evict()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::Evict </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>requested_charge</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/dbb/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1InsertState.html">InsertState</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d35/structROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_1_1EvictionData.html">EvictionData</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>eviction_effort_cap</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l03470">3470</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3472</span>                                                              {</div>
<div class="line"><span class="lineno"> 3473</span>  <span class="comment">// precondition</span></div>
<div class="line"><span class="lineno"> 3474</span>  assert(requested_charge &gt; 0);</div>
<div class="line"><span class="lineno"> 3475</span> </div>
<div class="line"><span class="lineno"> 3476</span>  <span class="comment">// We need the clock pointer to seemlessly &quot;wrap around&quot; at the end of the</span></div>
<div class="line"><span class="lineno"> 3477</span>  <span class="comment">// table, and to be reasonably stable under Grow operations. This is</span></div>
<div class="line"><span class="lineno"> 3478</span>  <span class="comment">// challenging when the linear hashing progressively opens additional</span></div>
<div class="line"><span class="lineno"> 3479</span>  <span class="comment">// most-significant-hash-bits in determining home locations.</span></div>
<div class="line"><span class="lineno"> 3480</span> </div>
<div class="line"><span class="lineno"> 3481</span>  <span class="comment">// TODO: make a tuning parameter?</span></div>
<div class="line"><span class="lineno"> 3482</span>  <span class="comment">// Up to 2x this number of homes will be evicted per step. In very rare</span></div>
<div class="line"><span class="lineno"> 3483</span>  <span class="comment">// cases, possibly more, as homes of an out-of-date generation will be</span></div>
<div class="line"><span class="lineno"> 3484</span>  <span class="comment">// resolved to multiple in a newer generation.</span></div>
<div class="line"><span class="lineno"> 3485</span>  <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> step_size = 4;</div>
<div class="line"><span class="lineno"> 3486</span> </div>
<div class="line"><span class="lineno"> 3487</span>  <span class="comment">// A clock_pointer_mask_ field separate from length_info_ enables us to use</span></div>
<div class="line"><span class="lineno"> 3488</span>  <span class="comment">// the same mask (way of dividing up the space among evicting threads) for</span></div>
<div class="line"><span class="lineno"> 3489</span>  <span class="comment">// iterating over the whole structure before considering changing the mask</span></div>
<div class="line"><span class="lineno"> 3490</span>  <span class="comment">// at the beginning of each pass. This ensures we do not have a large portion</span></div>
<div class="line"><span class="lineno"> 3491</span>  <span class="comment">// of the space that receives redundant or missed clock updates. However,</span></div>
<div class="line"><span class="lineno"> 3492</span>  <span class="comment">// with two variables, for each update to clock_pointer_mask (&lt; 64 ever in</span></div>
<div class="line"><span class="lineno"> 3493</span>  <span class="comment">// the life of the cache), there will be a brief period where concurrent</span></div>
<div class="line"><span class="lineno"> 3494</span>  <span class="comment">// eviction threads could use the old mask value, possibly causing redundant</span></div>
<div class="line"><span class="lineno"> 3495</span>  <span class="comment">// or missed clock updates for a *small* portion of the table.</span></div>
<div class="line"><span class="lineno"> 3496</span>  <span class="keywordtype">size_t</span> clock_pointer_mask = <a class="code hl_variable" href="#a3cd88545c5e9cfb63d51e413f244f0b9">clock_pointer_mask_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6a8401cbb9ead0bbb0def8fbfbabc97d">LoadRelaxed</a>();</div>
<div class="line"><span class="lineno"> 3497</span> </div>
<div class="line"><span class="lineno"> 3498</span>  uint64_t max_clock_pointer = 0;  <span class="comment">// unset</span></div>
<div class="line"><span class="lineno"> 3499</span> </div>
<div class="line"><span class="lineno"> 3500</span>  <span class="comment">// TODO: consider updating during a long eviction</span></div>
<div class="line"><span class="lineno"> 3501</span>  <span class="keywordtype">size_t</span> used_length = LengthInfoToUsedLength(state.saved_length_info);</div>
<div class="line"><span class="lineno"> 3502</span> </div>
<div class="line"><span class="lineno"> 3503</span>  autovector&lt;HandleImpl*&gt; to_finish_eviction;</div>
<div class="line"><span class="lineno"> 3504</span> </div>
<div class="line"><span class="lineno"> 3505</span>  <span class="comment">// Loop until enough freed, or limit reached (see bottom of loop)</span></div>
<div class="line"><span class="lineno"> 3506</span>  <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><span class="lineno"> 3507</span>    <span class="comment">// First (concurrent) increment clock pointer</span></div>
<div class="line"><span class="lineno"> 3508</span>    uint64_t old_clock_pointer = <a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#aaf422722f1e9ff79fd0f8d1952068b57">clock_pointer_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631">FetchAddRelaxed</a>(step_size);</div>
<div class="line"><span class="lineno"> 3509</span> </div>
<div class="line"><span class="lineno"> 3510</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d6/dd6/likely_8h.html#ab10d0a221f4d7a706701b806c8135fd7">UNLIKELY</a>((old_clock_pointer &amp; clock_pointer_mask) == 0)) {</div>
<div class="line"><span class="lineno"> 3511</span>      <span class="comment">// Back at the beginning. See if clock_pointer_mask should be updated.</span></div>
<div class="line"><span class="lineno"> 3512</span>      uint64_t mask = <a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94">BottomNBits</a>(</div>
<div class="line"><span class="lineno"> 3513</span>          UINT64_MAX, LengthInfoToMinShift(state.saved_length_info));</div>
<div class="line"><span class="lineno"> 3514</span>      <span class="keywordflow">if</span> (clock_pointer_mask != mask) {</div>
<div class="line"><span class="lineno"> 3515</span>        clock_pointer_mask = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(mask);</div>
<div class="line"><span class="lineno"> 3516</span>        <a class="code hl_variable" href="#a3cd88545c5e9cfb63d51e413f244f0b9">clock_pointer_mask_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#af2c681cc4fa952f86d59a3013eaeccaa">StoreRelaxed</a>(clock_pointer_mask);</div>
<div class="line"><span class="lineno"> 3517</span>      }</div>
<div class="line"><span class="lineno"> 3518</span>    }</div>
<div class="line"><span class="lineno"> 3519</span> </div>
<div class="line"><span class="lineno"> 3520</span>    <span class="keywordtype">size_t</span> major_step = clock_pointer_mask + 1;</div>
<div class="line"><span class="lineno"> 3521</span>    assert((major_step &amp; clock_pointer_mask) == 0);</div>
<div class="line"><span class="lineno"> 3522</span> </div>
<div class="line"><span class="lineno"> 3523</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> base_home = old_clock_pointer &amp; clock_pointer_mask;</div>
<div class="line"><span class="lineno"> 3524</span>         base_home &lt; used_length; base_home += major_step) {</div>
<div class="line"><span class="lineno"> 3525</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; step_size; i++) {</div>
<div class="line"><span class="lineno"> 3526</span>        <span class="keywordtype">size_t</span> home = base_home + i;</div>
<div class="line"><span class="lineno"> 3527</span>        <span class="keywordflow">if</span> (home &gt;= used_length) {</div>
<div class="line"><span class="lineno"> 3528</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3529</span>        }</div>
<div class="line"><span class="lineno"> 3530</span>        <a class="code hl_function" href="#a353c1aa19f1e338db90086bdca07407b">PurgeImpl</a>(&amp;to_finish_eviction, home, data);</div>
<div class="line"><span class="lineno"> 3531</span>      }</div>
<div class="line"><span class="lineno"> 3532</span>    }</div>
<div class="line"><span class="lineno"> 3533</span> </div>
<div class="line"><span class="lineno"> 3534</span>    <span class="keywordflow">for</span> (HandleImpl* h : to_finish_eviction) {</div>
<div class="line"><span class="lineno"> 3535</span>      <a class="code hl_function" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#aa32ca86b0bb994fcb45ddb2cbebd40e1">TrackAndReleaseEvictedEntry</a>(h);</div>
<div class="line"><span class="lineno"> 3536</span>      <span class="comment">// NOTE: setting likely_empty_slot here can cause us to reduce the</span></div>
<div class="line"><span class="lineno"> 3537</span>      <span class="comment">// portion of &quot;at home&quot; entries, probably because an evicted entry</span></div>
<div class="line"><span class="lineno"> 3538</span>      <span class="comment">// is more likely to come back than a random new entry and would be</span></div>
<div class="line"><span class="lineno"> 3539</span>      <span class="comment">// unable to go into its home slot.</span></div>
<div class="line"><span class="lineno"> 3540</span>    }</div>
<div class="line"><span class="lineno"> 3541</span>    to_finish_eviction.clear();</div>
<div class="line"><span class="lineno"> 3542</span> </div>
<div class="line"><span class="lineno"> 3543</span>    <span class="comment">// Loop exit conditions</span></div>
<div class="line"><span class="lineno"> 3544</span>    <span class="keywordflow">if</span> (data-&gt;freed_charge &gt;= requested_charge) {</div>
<div class="line"><span class="lineno"> 3545</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3546</span>    }</div>
<div class="line"><span class="lineno"> 3547</span> </div>
<div class="line"><span class="lineno"> 3548</span>    <span class="keywordflow">if</span> (max_clock_pointer == 0) {</div>
<div class="line"><span class="lineno"> 3549</span>      <span class="comment">// Cap the eviction effort at this thread (along with those operating in</span></div>
<div class="line"><span class="lineno"> 3550</span>      <span class="comment">// parallel) circling through the whole structure kMaxCountdown times.</span></div>
<div class="line"><span class="lineno"> 3551</span>      <span class="comment">// In other words, this eviction run must find something/anything that is</span></div>
<div class="line"><span class="lineno"> 3552</span>      <span class="comment">// unreferenced at start of and during the eviction run that isn&#39;t</span></div>
<div class="line"><span class="lineno"> 3553</span>      <span class="comment">// reclaimed by a concurrent eviction run.</span></div>
<div class="line"><span class="lineno"> 3554</span>      <span class="comment">// TODO: Does HyperClockCache need kMaxCountdown + 1?</span></div>
<div class="line"><span class="lineno"> 3555</span>      max_clock_pointer =</div>
<div class="line"><span class="lineno"> 3556</span>          old_clock_pointer +</div>
<div class="line"><span class="lineno"> 3557</span>          (uint64_t{ClockHandle::kMaxCountdown + 1} * major_step);</div>
<div class="line"><span class="lineno"> 3558</span>    }</div>
<div class="line"><span class="lineno"> 3559</span> </div>
<div class="line"><span class="lineno"> 3560</span>    <span class="keywordflow">if</span> (old_clock_pointer + step_size &gt;= max_clock_pointer) {</div>
<div class="line"><span class="lineno"> 3561</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3562</span>    }</div>
<div class="line"><span class="lineno"> 3563</span> </div>
<div class="line"><span class="lineno"> 3564</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/dfe/namespaceROCKSDB__NAMESPACE_1_1clock__cache.html#ab9d2629b7bb55879c4db7eb3c0ac8e41">IsEvictionEffortExceeded</a>(*data, eviction_effort_cap)) {</div>
<div class="line"><span class="lineno"> 3565</span>      <a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#afbfb2f7669dfb5646031a78ff9457374">eviction_effort_exceeded_count_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631">FetchAddRelaxed</a>(1);</div>
<div class="line"><span class="lineno"> 3566</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3567</span>    }</div>
<div class="line"><span class="lineno"> 3568</span>  }</div>
<div class="line"><span class="lineno"> 3569</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1RelaxedAtomic_html_af2c681cc4fa952f86d59a3013eaeccaa"><div class="ttname"><a href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#af2c681cc4fa952f86d59a3013eaeccaa">ROCKSDB_NAMESPACE::RelaxedAtomic::StoreRelaxed</a></div><div class="ttdeci">void StoreRelaxed(T desired)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d02/atomic_8h_source.html#l00036">atomic.h:36</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_a353c1aa19f1e338db90086bdca07407b"><div class="ttname"><a href="#a353c1aa19f1e338db90086bdca07407b">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::PurgeImpl</a></div><div class="ttdeci">void PurgeImpl(OpData *op_data, size_t home=SIZE_MAX, EvictionData *data=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l02784">clock_cache.cc:2784</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_html_aa32ca86b0bb994fcb45ddb2cbebd40e1"><div class="ttname"><a href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#aa32ca86b0bb994fcb45ddb2cbebd40e1">ROCKSDB_NAMESPACE::clock_cache::BaseClockTable::TrackAndReleaseEvictedEntry</a></div><div class="ttdeci">void TrackAndReleaseEvictedEntry(ClockHandle *h)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l00555">clock_cache.cc:555</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_html_aaf422722f1e9ff79fd0f8d1952068b57"><div class="ttname"><a href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#aaf422722f1e9ff79fd0f8d1952068b57">ROCKSDB_NAMESPACE::clock_cache::BaseClockTable::clock_pointer_</a></div><div class="ttdeci">RelaxedAtomic&lt; uint64_t &gt; clock_pointer_</div><div class="ttdef"><b>Definition</b> <a href="../../db/d81/clock__cache_8h_source.html#l00477">clock_cache.h:477</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_html_afbfb2f7669dfb5646031a78ff9457374"><div class="ttname"><a href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#afbfb2f7669dfb5646031a78ff9457374">ROCKSDB_NAMESPACE::clock_cache::BaseClockTable::eviction_effort_exceeded_count_</a></div><div class="ttdeci">RelaxedAtomic&lt; uint64_t &gt; eviction_effort_exceeded_count_</div><div class="ttdef"><b>Definition</b> <a href="../../db/d81/clock__cache_8h_source.html#l00487">clock_cache.h:487</a></div></div>
<div class="ttc" id="anamespaceROCKSDB__NAMESPACE_1_1clock__cache_html_ab9d2629b7bb55879c4db7eb3c0ac8e41"><div class="ttname"><a href="../../d9/dfe/namespaceROCKSDB__NAMESPACE_1_1clock__cache.html#ab9d2629b7bb55879c4db7eb3c0ac8e41">ROCKSDB_NAMESPACE::clock_cache::IsEvictionEffortExceeded</a></div><div class="ttdeci">bool IsEvictionEffortExceeded(const BaseClockTable::EvictionData &amp;data, uint32_t eviction_effort_cap)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l00572">clock_cache.cc:572</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9055868cef9d318a6d4bc97cc2f55c8d_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9055868cef9d318a6d4bc97cc2f55c8d_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9055868cef9d318a6d4bc97cc2f55c8d_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9055868cef9d318a6d4bc97cc2f55c8d_cgraph">
<area shape="rect" title=" " alt="" coords="5,310,219,372"/>
<area shape="poly" title=" " alt="" coords="60,310,61,300,71,291,88,285,112,284,140,286,157,293,155,298,139,291,112,289,89,291,74,296,66,302,65,310"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="827,29,1009,74"/>
<area shape="poly" title=" " alt="" coords="145,308,199,262,265,217,334,182,406,153,480,128,554,107,694,77,812,59,812,64,695,82,556,112,482,133,408,158,336,187,268,222,203,266,148,312"/>
<area shape="rect" href="../../d9/dfe/namespaceROCKSDB__NAMESPACE_1_1clock__cache.html#ab9d2629b7bb55879c4db7eb3c0ac8e41" title=" " alt="" coords="275,365,482,426"/>
<area shape="poly" title=" " alt="" coords="220,360,260,369,259,374,219,366"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a353c1aa19f1e338db90086bdca07407b" title=" " alt="" coords="272,256,485,317"/>
<area shape="poly" title=" " alt="" coords="219,316,256,309,257,314,220,322"/>
<area shape="rect" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#aa32ca86b0bb994fcb45ddb2cbebd40e1" title=" " alt="" coords="267,496,490,557"/>
<area shape="poly" title=" " alt="" coords="160,370,322,484,318,488,157,375"/>
<area shape="poly" title=" " alt="" coords="867,29,866,19,875,10,892,5,918,3,947,5,964,12,962,17,945,10,918,8,893,10,877,15,871,21,873,28"/>
<area shape="poly" title=" " alt="" coords="326,364,328,354,337,346,354,340,378,338,406,341,423,348,421,353,405,346,378,343,355,345,340,350,332,357,331,365"/>
<area shape="poly" title=" " alt="" coords="326,255,328,245,337,236,354,231,378,229,406,232,423,239,421,244,405,237,378,234,355,236,340,241,332,247,331,256"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#afe0c39ddafa0f49b10f9fe77ad8e702b" title=" " alt="" coords="1078,123,1291,202"/>
<area shape="poly" title=" " alt="" coords="403,253,460,198,497,172,537,152,604,132,674,119,745,112,815,110,949,118,1062,133,1062,139,948,123,815,116,745,117,675,124,606,137,539,157,499,176,463,202,407,257"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a30417ab9b027b7113a0573d4fa6c7edb" title=" " alt="" coords="1073,237,1296,298"/>
<area shape="poly" title=" " alt="" coords="485,289,732,296,878,294,1024,288,1057,285,1057,290,1025,293,878,300,732,301,485,295"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a4c68c3c5ccbe3c20bd71313b1a0f8e10" title=" " alt="" coords="544,190,757,252"/>
<area shape="poly" title=" " alt="" coords="485,258,528,248,529,253,486,263"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#ad0040262551e4d03603956bb5cea8b07" title=" " alt="" coords="538,354,763,416"/>
<area shape="poly" title=" " alt="" coords="467,315,550,346,549,351,465,320"/>
<area shape="poly" title=" " alt="" coords="700,187,867,80,870,85,703,192"/>
<area shape="poly" title=" " alt="" coords="757,194,811,185,940,171,1062,164,1062,169,941,177,812,190,758,199"/>
<area shape="poly" title=" " alt="" coords="598,190,600,180,610,171,626,165,651,164,679,166,696,173,694,178,677,171,651,169,628,171,612,176,605,182,604,190"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a13edad9a2ec43bc685dd5a1aaf70c21f" title=" " alt="" coords="811,200,1025,279"/>
<area shape="poly" title=" " alt="" coords="758,226,796,229,796,234,758,231"/>
<area shape="poly" title=" " alt="" coords="1024,206,1062,195,1063,200,1026,211"/>
<area shape="poly" title=" " alt="" coords="1025,248,1057,252,1057,257,1025,254"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#af094887ce078b9180b272800614bd2ee" title=" " alt="" coords="1078,344,1291,423"/>
<area shape="poly" title=" " alt="" coords="994,277,1098,334,1095,339,991,282"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631" title=" " alt="" coords="1344,361,1585,406"/>
<area shape="poly" title=" " alt="" coords="1291,381,1328,381,1328,386,1291,386"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a451c426fc0333c92fe9da85c3c1abd4a" title=" " alt="" coords="811,355,1025,434"/>
<area shape="poly" title=" " alt="" coords="764,386,795,387,795,393,764,392"/>
<area shape="poly" title=" " alt="" coords="1025,387,1062,386,1062,391,1025,393"/>
<area shape="poly" title=" " alt="" coords="326,495,328,485,337,476,354,471,378,469,406,472,423,479,421,484,405,477,378,474,355,476,340,481,332,487,331,496"/>
<area shape="rect" href="../../d1/d57/structROCKSDB__NAMESPACE_1_1clock__cache_1_1ClockHandleBasicData.html#a01209c99612b96244d57559c5ad514e2" title=" " alt="" coords="538,464,763,525"/>
<area shape="poly" title=" " alt="" coords="490,511,522,507,523,512,491,516"/>
<area shape="rect" href="../../d1/d57/structROCKSDB__NAMESPACE_1_1clock__cache_1_1ClockHandleBasicData.html#a7b8a54d718808da31ba71a2de5b28684" title=" " alt="" coords="538,549,763,610"/>
<area shape="poly" title=" " alt="" coords="491,546,523,552,522,557,490,551"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6a8401cbb9ead0bbb0def8fbfbabc97d" title=" " alt="" coords="544,635,757,679"/>
<area shape="poly" title=" " alt="" coords="426,556,479,589,539,620,555,626,552,631,537,625,477,593,423,560"/>
<area shape="poly" title=" " alt="" coords="598,463,600,453,610,444,626,439,651,437,679,440,696,447,694,452,677,445,651,442,628,444,612,449,605,455,604,464"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9055868cef9d318a6d4bc97cc2f55c8d_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9055868cef9d318a6d4bc97cc2f55c8d_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9055868cef9d318a6d4bc97cc2f55c8d_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a9055868cef9d318a6d4bc97cc2f55c8d_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="146,17,133,11,112,8,94,10,82,15,76,21,75,29,70,29,71,19,79,10,92,5,112,3,135,5,148,13"/>
</map>
</div>

</div>
</div>
<a id="a950fc9e7f613a8e924d472af6dba928c" name="a950fc9e7f613a8e924d472af6dba928c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a950fc9e7f613a8e924d472af6dba928c">&#9670;&#160;</a></span>GetOccupancyLimit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::GetOccupancyLimit </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l02125">2125</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2125</span>                                                    {</div>
<div class="line"><span class="lineno"> 2126</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="#a36ca56c367a512dc25dd00ba74a115e9">occupancy_limit_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6a8401cbb9ead0bbb0def8fbfbabc97d">LoadRelaxed</a>();</div>
<div class="line"><span class="lineno"> 2127</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a950fc9e7f613a8e924d472af6dba928c_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a950fc9e7f613a8e924d472af6dba928c_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a950fc9e7f613a8e924d472af6dba928c_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a950fc9e7f613a8e924d472af6dba928c_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="70,29,71,19,79,10,92,5,112,3,135,5,148,13,146,17,133,11,112,8,94,10,82,15,76,21,75,29"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a950fc9e7f613a8e924d472af6dba928c_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a950fc9e7f613a8e924d472af6dba928c_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a950fc9e7f613a8e924d472af6dba928c_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a950fc9e7f613a8e924d472af6dba928c_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="146,17,133,11,112,8,94,10,82,15,76,21,75,29,70,29,71,19,79,10,92,5,112,3,135,5,148,13"/>
</map>
</div>

</div>
</div>
<a id="a064c2e0057bdd3eff5edb1537bffd356" name="a064c2e0057bdd3eff5edb1537bffd356"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a064c2e0057bdd3eff5edb1537bffd356">&#9670;&#160;</a></span>GetTableSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::GetTableSize </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l02121">2121</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2121</span>                                               {</div>
<div class="line"><span class="lineno"> 2122</span>  <span class="keywordflow">return</span> LengthInfoToUsedLength(<a class="code hl_variable" href="#a691cf5bc49f36f3001d8c980901de288">length_info_</a>.<a class="code hl_function" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a5361060db542ce3ebfd914aecb908f8c">Load</a>());</div>
<div class="line"><span class="lineno"> 2123</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a064c2e0057bdd3eff5edb1537bffd356_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a064c2e0057bdd3eff5edb1537bffd356_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a064c2e0057bdd3eff5edb1537bffd356_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a064c2e0057bdd3eff5edb1537bffd356_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="70,29,71,19,79,10,92,5,112,3,135,5,148,13,146,17,133,11,112,8,94,10,82,15,76,21,75,29"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a064c2e0057bdd3eff5edb1537bffd356_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a064c2e0057bdd3eff5edb1537bffd356_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a064c2e0057bdd3eff5edb1537bffd356_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a064c2e0057bdd3eff5edb1537bffd356_icgraph">
<area shape="rect" title=" " alt="" coords="267,139,480,200"/>
<area shape="poly" title=" " alt="" coords="415,127,399,120,373,117,351,119,336,124,328,131,327,139,322,138,324,128,333,119,350,114,373,112,401,115,417,122"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a9616b2306e5efc8080bd3f56e3d59945" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="286,135,218,105,191,94,193,89,220,100,288,130"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#acecc474c0a88e9db56f62463c297fee0" title=" " alt="" coords="5,139,219,200"/>
<area shape="poly" title=" " alt="" coords="251,172,219,172,219,167,251,167"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a696abeb6e3bbbb60bba3865b715721fc" title=" " alt="" coords="5,248,219,310"/>
<area shape="poly" title=" " alt="" coords="285,209,189,250,187,245,282,204"/>
<area shape="poly" title=" " alt="" coords="154,17,138,11,112,8,89,10,74,15,67,21,66,29,61,29,62,19,72,10,88,5,112,3,139,5,156,13"/>
<area shape="poly" title=" " alt="" coords="154,127,138,120,112,117,89,119,74,124,67,131,66,139,61,138,62,128,72,119,88,114,112,112,139,115,156,122"/>
<area shape="poly" title=" " alt="" coords="154,236,138,229,112,227,89,229,74,233,67,240,66,248,61,247,62,237,72,229,88,223,112,221,139,224,156,231"/>
</map>
</div>

</div>
</div>
<a id="a5ca412446df4200dd55e020e802d99f2" name="a5ca412446df4200dd55e020e802d99f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ca412446df4200dd55e020e802d99f2">&#9670;&#160;</a></span>Grow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::Grow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/dbb/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1InsertState.html">InsertState</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>state</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l02181">2181</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2181</span>                                                 {</div>
<div class="line"><span class="lineno"> 2182</span>  <span class="comment">// Allocate the next grow slot</span></div>
<div class="line"><span class="lineno"> 2183</span>  <span class="keywordtype">size_t</span> grow_home = <a class="code hl_variable" href="#afcb35ce36192fc425c67157f697c5226">grow_frontier_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631">FetchAddRelaxed</a>(1);</div>
<div class="line"><span class="lineno"> 2184</span>  <span class="keywordflow">if</span> (grow_home &gt;= <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>.<a class="code hl_function" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a28a017539929f61ec8037625acb2ee1e">Count</a>()) {</div>
<div class="line"><span class="lineno"> 2185</span>    <span class="comment">// Can&#39;t grow any more.</span></div>
<div class="line"><span class="lineno"> 2186</span>    <span class="comment">// (Tested by unit test ClockCacheTest/Limits)</span></div>
<div class="line"><span class="lineno"> 2187</span>    <span class="comment">// Make sure we don&#39;t overflow grow_frontier_ by reaching here repeatedly</span></div>
<div class="line"><span class="lineno"> 2188</span>    <a class="code hl_variable" href="#afcb35ce36192fc425c67157f697c5226">grow_frontier_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#af2c681cc4fa952f86d59a3013eaeccaa">StoreRelaxed</a>(<a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>.<a class="code hl_function" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a28a017539929f61ec8037625acb2ee1e">Count</a>());</div>
<div class="line"><span class="lineno"> 2189</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2190</span>  }</div>
<div class="line"><span class="lineno"> 2191</span><span class="preprocessor">#ifdef COERCE_CONTEXT_SWITCH</span></div>
<div class="line"><span class="lineno"> 2192</span>  <span class="comment">// This is useful in reproducing concurrency issues in Grow()</span></div>
<div class="line"><span class="lineno"> 2193</span>  <span class="keywordflow">while</span> (Random::GetTLSInstance()-&gt;OneIn(2)) {</div>
<div class="line"><span class="lineno"> 2194</span>    std::this_thread::yield();</div>
<div class="line"><span class="lineno"> 2195</span>  }</div>
<div class="line"><span class="lineno"> 2196</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2197</span>  <span class="comment">// Basically, to implement https://en.wikipedia.org/wiki/Linear_hashing</span></div>
<div class="line"><span class="lineno"> 2198</span>  <span class="comment">// entries that belong in a new chain starting at grow_home will be</span></div>
<div class="line"><span class="lineno"> 2199</span>  <span class="comment">// split off from the chain starting at old_home, which is computed here.</span></div>
<div class="line"><span class="lineno"> 2200</span>  <span class="keywordtype">int</span> old_shift = <a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a74a1b2239413fa672392330a886188ec">FloorLog2</a>(grow_home);</div>
<div class="line"><span class="lineno"> 2201</span>  <span class="keywordtype">size_t</span> old_home = <a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94">BottomNBits</a>(grow_home, old_shift);</div>
<div class="line"><span class="lineno"> 2202</span>  assert(old_home + (<span class="keywordtype">size_t</span>{1} &lt;&lt; old_shift) == grow_home);</div>
<div class="line"><span class="lineno"> 2203</span> </div>
<div class="line"><span class="lineno"> 2204</span>  <span class="comment">// Wait here to ensure any Grow operations that would directly feed into</span></div>
<div class="line"><span class="lineno"> 2205</span>  <span class="comment">// this one are finished, though the full waiting actually completes in</span></div>
<div class="line"><span class="lineno"> 2206</span>  <span class="comment">// acquiring the rewrite lock for old_home in SplitForGrow. Here we ensure</span></div>
<div class="line"><span class="lineno"> 2207</span>  <span class="comment">// the expected shift amount has been reached, and there we ensure the</span></div>
<div class="line"><span class="lineno"> 2208</span>  <span class="comment">// chain rewrite lock has been released.</span></div>
<div class="line"><span class="lineno"> 2209</span>  <span class="keywordtype">size_t</span> old_old_home = <a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94">BottomNBits</a>(grow_home, old_shift - 1);</div>
<div class="line"><span class="lineno"> 2210</span>  <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><span class="lineno"> 2211</span>    uint64_t old_old_head = <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>[old_old_home].head_next_with_shift.Load();</div>
<div class="line"><span class="lineno"> 2212</span>    <span class="keywordflow">if</span> (GetShiftFromNextWithShift(old_old_head) &gt;= old_shift) {</div>
<div class="line"><span class="lineno"> 2213</span>      <span class="keywordflow">if</span> ((old_old_head &amp; HandleImpl::kNextEndFlags) !=</div>
<div class="line"><span class="lineno"> 2214</span>          HandleImpl::kHeadLocked) {</div>
<div class="line"><span class="lineno"> 2215</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2216</span>      }</div>
<div class="line"><span class="lineno"> 2217</span>    }</div>
<div class="line"><span class="lineno"> 2218</span>    <span class="comment">// NOTE: one of the few yield-wait loops, which is rare enough in practice</span></div>
<div class="line"><span class="lineno"> 2219</span>    <span class="comment">// for its performance to be insignificant.</span></div>
<div class="line"><span class="lineno"> 2220</span>    <a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ae058b85ca9ff2ed2c9240cafe094f99f">yield_count_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631">FetchAddRelaxed</a>(1);</div>
<div class="line"><span class="lineno"> 2221</span>    std::this_thread::yield();</div>
<div class="line"><span class="lineno"> 2222</span>  }</div>
<div class="line"><span class="lineno"> 2223</span> </div>
<div class="line"><span class="lineno"> 2224</span>  <span class="comment">// Do the dirty work of splitting the chain, including updating heads and</span></div>
<div class="line"><span class="lineno"> 2225</span>  <span class="comment">// chain nexts for new shift amounts.</span></div>
<div class="line"><span class="lineno"> 2226</span>  <a class="code hl_function" href="#ad711f79a6b0edd406c9c64330e707e0f">SplitForGrow</a>(grow_home, old_home, old_shift);</div>
<div class="line"><span class="lineno"> 2227</span> </div>
<div class="line"><span class="lineno"> 2228</span>  <span class="comment">// length_info_ can be updated any time after the new shift amount is</span></div>
<div class="line"><span class="lineno"> 2229</span>  <span class="comment">// published to both heads, potentially before the end of SplitForGrow.</span></div>
<div class="line"><span class="lineno"> 2230</span>  <span class="comment">// But we also can&#39;t update length_info_ until the previous Grow operation</span></div>
<div class="line"><span class="lineno"> 2231</span>  <span class="comment">// (with grow_home := this grow_home - 1) has published the new shift amount</span></div>
<div class="line"><span class="lineno"> 2232</span>  <span class="comment">// to both of its heads. However, we don&#39;t want to artificially wait here</span></div>
<div class="line"><span class="lineno"> 2233</span>  <span class="comment">// on that Grow that is otherwise irrelevant.</span></div>
<div class="line"><span class="lineno"> 2234</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2235</span>  <span class="comment">// We could have each Grow operation advance length_info_ here as far as it</span></div>
<div class="line"><span class="lineno"> 2236</span>  <span class="comment">// can without waiting, by checking for updated shift on the corresponding</span></div>
<div class="line"><span class="lineno"> 2237</span>  <span class="comment">// old home and also stopping at an empty head value for possible grow_home.</span></div>
<div class="line"><span class="lineno"> 2238</span>  <span class="comment">// However, this could increase CPU cache line sharing and in 1/64 cases</span></div>
<div class="line"><span class="lineno"> 2239</span>  <span class="comment">// bring in an extra page from our mmap.</span></div>
<div class="line"><span class="lineno"> 2240</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2241</span>  <span class="comment">// Instead, part of the strategy is delegated to DoInsert():</span></div>
<div class="line"><span class="lineno"> 2242</span>  <span class="comment">// * Here we try to bring length_info_ up to date with this grow_home as</span></div>
<div class="line"><span class="lineno"> 2243</span>  <span class="comment">// much as we can without waiting. It will fall short if a previous Grow</span></div>
<div class="line"><span class="lineno"> 2244</span>  <span class="comment">// is still between reserving the grow slot and making the first big step</span></div>
<div class="line"><span class="lineno"> 2245</span>  <span class="comment">// to publish the new shift amount.</span></div>
<div class="line"><span class="lineno"> 2246</span>  <span class="comment">// * To avoid length_info_ being perpetually out-of-date (for a small number</span></div>
<div class="line"><span class="lineno"> 2247</span>  <span class="comment">// of heads) after our last Grow, we do the same when Insert has to &quot;fall</span></div>
<div class="line"><span class="lineno"> 2248</span>  <span class="comment">// forward&quot; due to length_info_ being out-of-date.</span></div>
<div class="line"><span class="lineno"> 2249</span>  <a class="code hl_function" href="#a5e26beba887f4e95c1c53b5ae2eaacdd">CatchUpLengthInfoNoWait</a>(grow_home);</div>
<div class="line"><span class="lineno"> 2250</span> </div>
<div class="line"><span class="lineno"> 2251</span>  <span class="comment">// See usage in DoInsert()</span></div>
<div class="line"><span class="lineno"> 2252</span>  state.likely_empty_slot = grow_home;</div>
<div class="line"><span class="lineno"> 2253</span> </div>
<div class="line"><span class="lineno"> 2254</span>  <span class="comment">// Success</span></div>
<div class="line"><span class="lineno"> 2255</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2256</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_ad711f79a6b0edd406c9c64330e707e0f"><div class="ttname"><a href="#ad711f79a6b0edd406c9c64330e707e0f">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::SplitForGrow</a></div><div class="ttdeci">void SplitForGrow(size_t grow_home, size_t old_home, int old_shift)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l02309">clock_cache.cc:2309</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_html_ae058b85ca9ff2ed2c9240cafe094f99f"><div class="ttname"><a href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ae058b85ca9ff2ed2c9240cafe094f99f">ROCKSDB_NAMESPACE::clock_cache::BaseClockTable::yield_count_</a></div><div class="ttdeci">RelaxedAtomic&lt; uint64_t &gt; yield_count_</div><div class="ttdef"><b>Definition</b> <a href="../../db/d81/clock__cache_8h_source.html#l00482">clock_cache.h:482</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5ca412446df4200dd55e020e802d99f2_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5ca412446df4200dd55e020e802d99f2_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5ca412446df4200dd55e020e802d99f2_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5ca412446df4200dd55e020e802d99f2_cgraph">
<area shape="rect" title=" " alt="" coords="5,141,219,202"/>
<area shape="poly" title=" " alt="" coords="59,140,60,130,70,122,87,116,112,114,140,117,158,124,156,129,139,122,112,119,88,121,73,126,65,133,64,141"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="566,29,747,74"/>
<area shape="poly" title=" " alt="" coords="135,139,190,82,226,55,266,35,301,23,338,16,413,11,486,14,551,24,550,29,485,20,413,16,339,21,302,29,268,39,229,60,193,86,139,142"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a5e26beba887f4e95c1c53b5ae2eaacdd" title=" " alt="" coords="267,73,502,134"/>
<area shape="poly" title=" " alt="" coords="218,142,251,134,252,139,220,148"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a74a1b2239413fa672392330a886188ec" title=" " alt="" coords="566,123,747,167"/>
<area shape="poly" title=" " alt="" coords="219,164,550,147,551,153,219,169"/>
<area shape="rect" href="../../d9/d54/classROCKSDB__NAMESPACE_1_1Random.html#a4c57e895d1948533257b40c47d833ea5" title=" " alt="" coords="292,349,476,394"/>
<area shape="poly" title=" " alt="" coords="146,201,202,251,268,304,326,339,323,344,265,309,198,255,143,205"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#ad711f79a6b0edd406c9c64330e707e0f" title=" " alt="" coords="278,233,491,294"/>
<area shape="poly" title=" " alt="" coords="206,201,277,225,276,230,205,206"/>
<area shape="poly" title=" " alt="" coords="606,29,605,19,613,10,631,5,657,3,685,5,702,12,700,17,684,10,657,8,632,10,616,15,610,21,611,28"/>
<area shape="poly" title=" " alt="" coords="502,79,550,69,551,74,503,84"/>
<area shape="poly" title=" " alt="" coords="331,72,333,62,342,54,360,48,384,46,413,49,430,56,428,61,411,54,384,51,361,53,345,58,337,65,336,73"/>
<area shape="poly" title=" " alt="" coords="503,119,551,126,550,132,502,124"/>
<area shape="poly" title=" " alt="" coords="606,123,605,112,613,104,631,98,657,96,685,98,702,105,700,110,684,104,657,101,632,103,616,108,610,114,611,122"/>
<area shape="poly" title=" " alt="" coords="333,349,331,339,340,330,358,325,384,323,413,325,431,331,429,336,412,330,384,328,359,330,343,335,336,341,338,348"/>
<area shape="rect" href="../../d9/d54/classROCKSDB__NAMESPACE_1_1Random.html#a888cf2ca1df96e1684d405ae41c2407a" title=" " alt="" coords="566,364,747,409"/>
<area shape="poly" title=" " alt="" coords="477,374,550,378,550,383,477,379"/>
<area shape="rect" href="../../d9/d54/classROCKSDB__NAMESPACE_1_1Random.html#a36e0813921e89bdf5af60a3a58a33565" title=" " alt="" coords="832,432,1014,477"/>
<area shape="poly" title=" " alt="" coords="748,407,819,425,817,430,746,412"/>
<area shape="poly" title=" " alt="" coords="417,230,500,145,522,113,532,99,548,84,556,79,559,84,552,88,536,102,526,116,504,148,421,234"/>
<area shape="poly" title=" " alt="" coords="331,232,333,222,342,214,360,208,384,206,413,209,430,216,428,221,411,214,384,211,361,213,345,218,337,225,336,233"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a13edad9a2ec43bc685dd5a1aaf70c21f" title=" " alt="" coords="550,243,763,322"/>
<area shape="poly" title=" " alt="" coords="492,268,534,271,534,277,491,274"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#afe0c39ddafa0f49b10f9fe77ad8e702b" title=" " alt="" coords="816,140,1030,219"/>
<area shape="poly" title=" " alt="" coords="491,239,550,228,800,191,801,197,550,233,492,244"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#af094887ce078b9180b272800614bd2ee" title=" " alt="" coords="816,243,1030,322"/>
<area shape="poly" title=" " alt="" coords="764,280,801,280,801,285,764,285"/>
<area shape="poly" title=" " alt="" coords="760,240,804,223,806,228,762,245"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a30417ab9b027b7113a0573d4fa6c7edb" title=" " alt="" coords="811,346,1035,408"/>
<area shape="poly" title=" " alt="" coords="765,318,821,338,819,343,763,323"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631" title=" " alt="" coords="1083,260,1324,305"/>
<area shape="poly" title=" " alt="" coords="1030,280,1067,280,1067,285,1030,285"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5ca412446df4200dd55e020e802d99f2_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5ca412446df4200dd55e020e802d99f2_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5ca412446df4200dd55e020e802d99f2_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a5ca412446df4200dd55e020e802d99f2_icgraph">
<area shape="rect" title=" " alt="" coords="267,29,480,91"/>
<area shape="poly" title=" " alt="" coords="415,17,399,11,373,8,351,10,336,15,328,21,327,29,322,29,324,19,333,10,350,5,373,3,401,5,417,13"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#ae8566ed911e3ebb602e88d9abf773ac0" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="251,63,219,63,219,58,251,58"/>
<area shape="poly" title=" " alt="" coords="154,17,138,11,112,8,89,10,74,15,67,21,66,29,61,29,62,19,72,10,88,5,112,3,139,5,156,13"/>
</map>
</div>

</div>
</div>
<a id="ae8566ed911e3ebb602e88d9abf773ac0" name="ae8566ed911e3ebb602e88d9abf773ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8566ed911e3ebb602e88d9abf773ac0">&#9670;&#160;</a></span>GrowIfNeeded()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::GrowIfNeeded </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>new_occupancy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/dbb/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1InsertState.html">InsertState</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l02151">2151</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2152</span>                                                           {</div>
<div class="line"><span class="lineno"> 2153</span>  <span class="comment">// new_occupancy has taken into account other threads that are also trying</span></div>
<div class="line"><span class="lineno"> 2154</span>  <span class="comment">// to insert, so as soon as we see sufficient *published* usable size, we</span></div>
<div class="line"><span class="lineno"> 2155</span>  <span class="comment">// can declare success even if we aren&#39;t the one that grows the table.</span></div>
<div class="line"><span class="lineno"> 2156</span>  <span class="comment">// However, there&#39;s an awkward state where other threads own growing the</span></div>
<div class="line"><span class="lineno"> 2157</span>  <span class="comment">// table to sufficient usable size, but the udpated size is not yet</span></div>
<div class="line"><span class="lineno"> 2158</span>  <span class="comment">// published. If we wait, then that likely slows the ramp-up cache</span></div>
<div class="line"><span class="lineno"> 2159</span>  <span class="comment">// performance. If we unblock ourselves by ensuring we grow by at least one</span></div>
<div class="line"><span class="lineno"> 2160</span>  <span class="comment">// slot, we could technically overshoot required size by number of parallel</span></div>
<div class="line"><span class="lineno"> 2161</span>  <span class="comment">// threads accessing block cache. On balance considering typical cases and</span></div>
<div class="line"><span class="lineno"> 2162</span>  <span class="comment">// the modest consequences of table being slightly too large, the latter</span></div>
<div class="line"><span class="lineno"> 2163</span>  <span class="comment">// seems preferable.</span></div>
<div class="line"><span class="lineno"> 2164</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2165</span>  <span class="comment">// So if the published occupancy limit is too small, we unblock ourselves</span></div>
<div class="line"><span class="lineno"> 2166</span>  <span class="comment">// by committing to growing the table by at least one slot. Also note that</span></div>
<div class="line"><span class="lineno"> 2167</span>  <span class="comment">// we might need to grow more than once to actually increase the occupancy</span></div>
<div class="line"><span class="lineno"> 2168</span>  <span class="comment">// limit (due to max load factor &lt; 1.0)</span></div>
<div class="line"><span class="lineno"> 2169</span> </div>
<div class="line"><span class="lineno"> 2170</span>  <span class="keywordflow">while</span> (<a class="code hl_define" href="../../d6/dd6/likely_8h.html#ab10d0a221f4d7a706701b806c8135fd7">UNLIKELY</a>(new_occupancy &gt; <a class="code hl_variable" href="#a36ca56c367a512dc25dd00ba74a115e9">occupancy_limit_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6a8401cbb9ead0bbb0def8fbfbabc97d">LoadRelaxed</a>())) {</div>
<div class="line"><span class="lineno"> 2171</span>    <span class="comment">// At this point we commit the thread to growing unless we&#39;ve reached the</span></div>
<div class="line"><span class="lineno"> 2172</span>    <span class="comment">// limit (returns false).</span></div>
<div class="line"><span class="lineno"> 2173</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="#a5ca412446df4200dd55e020e802d99f2">Grow</a>(state)) {</div>
<div class="line"><span class="lineno"> 2174</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2175</span>    }</div>
<div class="line"><span class="lineno"> 2176</span>  }</div>
<div class="line"><span class="lineno"> 2177</span>  <span class="comment">// Success (didn&#39;t need to grow, or did successfully)</span></div>
<div class="line"><span class="lineno"> 2178</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2179</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_a5ca412446df4200dd55e020e802d99f2"><div class="ttname"><a href="#a5ca412446df4200dd55e020e802d99f2">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::Grow</a></div><div class="ttdeci">bool Grow(InsertState &amp;state)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l02181">clock_cache.cc:2181</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ae8566ed911e3ebb602e88d9abf773ac0_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ae8566ed911e3ebb602e88d9abf773ac0_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ae8566ed911e3ebb602e88d9abf773ac0_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ae8566ed911e3ebb602e88d9abf773ac0_cgraph">
<area shape="rect" title=" " alt="" coords="5,141,219,202"/>
<area shape="poly" title=" " alt="" coords="61,140,62,130,72,122,88,116,112,114,139,117,156,124,154,129,138,122,112,119,89,121,74,126,67,133,66,141"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a5ca412446df4200dd55e020e802d99f2" title=" " alt="" coords="267,141,480,202"/>
<area shape="poly" title=" " alt="" coords="219,169,251,169,251,174,219,174"/>
<area shape="poly" title=" " alt="" coords="322,140,324,130,333,122,350,116,373,114,401,117,417,124,415,129,399,122,373,119,351,121,336,126,328,133,327,141"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="827,29,1009,74"/>
<area shape="poly" title=" " alt="" coords="396,139,451,82,487,55,527,35,563,23,599,16,674,11,747,14,812,24,812,29,746,20,674,16,600,21,564,29,529,39,490,60,455,86,400,142"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a5e26beba887f4e95c1c53b5ae2eaacdd" title=" " alt="" coords="528,73,763,134"/>
<area shape="poly" title=" " alt="" coords="480,142,512,134,514,139,481,148"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#a74a1b2239413fa672392330a886188ec" title=" " alt="" coords="827,123,1009,167"/>
<area shape="poly" title=" " alt="" coords="480,164,812,147,812,153,481,169"/>
<area shape="rect" href="../../d9/d54/classROCKSDB__NAMESPACE_1_1Random.html#a4c57e895d1948533257b40c47d833ea5" title=" " alt="" coords="554,349,738,394"/>
<area shape="poly" title=" " alt="" coords="408,201,463,251,530,304,587,339,584,344,526,309,460,255,404,205"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#ad711f79a6b0edd406c9c64330e707e0f" title=" " alt="" coords="539,233,752,294"/>
<area shape="poly" title=" " alt="" coords="468,201,539,225,537,230,466,206"/>
<area shape="poly" title=" " alt="" coords="867,29,866,19,875,10,892,5,918,3,947,5,964,12,962,17,945,10,918,8,893,10,877,15,871,21,873,28"/>
<area shape="poly" title=" " alt="" coords="763,79,812,69,813,74,764,84"/>
<area shape="poly" title=" " alt="" coords="592,72,594,62,604,54,621,48,646,46,674,49,691,56,689,61,673,54,646,51,622,53,606,58,599,65,598,73"/>
<area shape="poly" title=" " alt="" coords="764,119,812,126,812,132,763,124"/>
<area shape="poly" title=" " alt="" coords="867,123,866,112,875,104,892,98,918,96,947,98,964,105,962,110,945,104,918,101,893,103,877,108,871,114,873,122"/>
<area shape="poly" title=" " alt="" coords="594,349,593,339,601,330,619,325,646,323,675,325,692,331,690,336,673,330,646,328,620,330,604,335,598,341,599,348"/>
<area shape="rect" href="../../d9/d54/classROCKSDB__NAMESPACE_1_1Random.html#a888cf2ca1df96e1684d405ae41c2407a" title=" " alt="" coords="827,364,1009,409"/>
<area shape="poly" title=" " alt="" coords="738,374,812,378,811,383,738,379"/>
<area shape="rect" href="../../d9/d54/classROCKSDB__NAMESPACE_1_1Random.html#a36e0813921e89bdf5af60a3a58a33565" title=" " alt="" coords="1094,432,1275,477"/>
<area shape="poly" title=" " alt="" coords="1009,407,1080,425,1079,430,1008,412"/>
<area shape="poly" title=" " alt="" coords="678,230,761,145,783,113,793,99,810,84,817,79,820,84,813,88,797,102,788,116,765,148,682,234"/>
<area shape="poly" title=" " alt="" coords="592,232,594,222,604,214,621,208,646,206,674,209,691,216,689,221,673,214,646,211,622,213,606,218,599,225,598,233"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a13edad9a2ec43bc685dd5a1aaf70c21f" title=" " alt="" coords="811,243,1025,322"/>
<area shape="poly" title=" " alt="" coords="753,268,796,271,795,277,753,274"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#afe0c39ddafa0f49b10f9fe77ad8e702b" title=" " alt="" coords="1078,140,1291,219"/>
<area shape="poly" title=" " alt="" coords="752,239,811,228,1062,191,1063,197,812,233,753,244"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#af094887ce078b9180b272800614bd2ee" title=" " alt="" coords="1078,243,1291,322"/>
<area shape="poly" title=" " alt="" coords="1025,280,1062,280,1062,285,1025,285"/>
<area shape="poly" title=" " alt="" coords="1021,240,1066,223,1067,228,1023,245"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a30417ab9b027b7113a0573d4fa6c7edb" title=" " alt="" coords="1073,346,1296,408"/>
<area shape="poly" title=" " alt="" coords="1026,318,1082,338,1081,343,1024,323"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631" title=" " alt="" coords="1344,260,1585,305"/>
<area shape="poly" title=" " alt="" coords="1291,280,1328,280,1328,285,1291,285"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ae8566ed911e3ebb602e88d9abf773ac0_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ae8566ed911e3ebb602e88d9abf773ac0_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ae8566ed911e3ebb602e88d9abf773ac0_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ae8566ed911e3ebb602e88d9abf773ac0_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="146,17,133,11,112,8,94,10,82,15,76,21,75,29,70,29,71,19,79,10,92,5,112,3,135,5,148,13"/>
</map>
</div>

</div>
</div>
<a id="a065e2e75fb96e28f35e3c404244e4c5d" name="a065e2e75fb96e28f35e3c404244e4c5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a065e2e75fb96e28f35e3c404244e4c5d">&#9670;&#160;</a></span>HandlePtr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const HandleImpl * ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::HandlePtr </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>idx</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../db/d81/clock__cache_8h_source.html">clock_cache.h</a> 파일의 <a class="el" href="../../db/d81/clock__cache_8h_source.html#l00886">886</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  886</span>{ <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>[idx]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af9c1fa5039809f0efeb200afc4db8bf8" name="af9c1fa5039809f0efeb200afc4db8bf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9c1fa5039809f0efeb200afc4db8bf8">&#9670;&#160;</a></span>Lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AutoHyperClockTable::HandleImpl * ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::Lookup </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af4c4e4074a950ca9c8bc7e635a784bf7">UniqueId64x2</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>hashed_key</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l03091">3091</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3092</span>                                    {</div>
<div class="line"><span class="lineno"> 3093</span>  <span class="comment">// Lookups are wait-free with low occurrence of retries, back-tracking,</span></div>
<div class="line"><span class="lineno"> 3094</span>  <span class="comment">// and fallback. We do not have the benefit of holding a rewrite lock on</span></div>
<div class="line"><span class="lineno"> 3095</span>  <span class="comment">// the chain so must be prepared for many kinds of mayhem, most notably</span></div>
<div class="line"><span class="lineno"> 3096</span>  <span class="comment">// &quot;falling off our chain&quot; where a slot that Lookup has identified but</span></div>
<div class="line"><span class="lineno"> 3097</span>  <span class="comment">// has not read-referenced is removed from one chain and inserted into</span></div>
<div class="line"><span class="lineno"> 3098</span>  <span class="comment">// another. The full algorithm uses the following mitigation strategies to</span></div>
<div class="line"><span class="lineno"> 3099</span>  <span class="comment">// ensure every relevant entry inserted before this Lookup, and not yet</span></div>
<div class="line"><span class="lineno"> 3100</span>  <span class="comment">// evicted, is seen by Lookup, without excessive backtracking etc.:</span></div>
<div class="line"><span class="lineno"> 3101</span>  <span class="comment">// * Keep a known good read ref in the chain for &quot;island hopping.&quot; When</span></div>
<div class="line"><span class="lineno"> 3102</span>  <span class="comment">// we observe that a concurrent write takes us off to another chain, we</span></div>
<div class="line"><span class="lineno"> 3103</span>  <span class="comment">// only need to fall back to our last known good read ref (most recent</span></div>
<div class="line"><span class="lineno"> 3104</span>  <span class="comment">// entry on the chain that is not &quot;under construction,&quot; which is a transient</span></div>
<div class="line"><span class="lineno"> 3105</span>  <span class="comment">// state). We don&#39;t want to compound the CPU toil of a long chain with</span></div>
<div class="line"><span class="lineno"> 3106</span>  <span class="comment">// operations that might need to retry from scratch, with probability</span></div>
<div class="line"><span class="lineno"> 3107</span>  <span class="comment">// in proportion to chain length.</span></div>
<div class="line"><span class="lineno"> 3108</span>  <span class="comment">// * Only detect a chain is potentially incomplete because of a Grow in</span></div>
<div class="line"><span class="lineno"> 3109</span>  <span class="comment">// progress by looking at shift in the next pointer tags (rather than</span></div>
<div class="line"><span class="lineno"> 3110</span>  <span class="comment">// re-checking length_info_).</span></div>
<div class="line"><span class="lineno"> 3111</span>  <span class="comment">// * SplitForGrow, Insert, and PurgeImplLocked ensure that there are no</span></div>
<div class="line"><span class="lineno"> 3112</span>  <span class="comment">// transient states that might cause this full Lookup algorithm to skip over</span></div>
<div class="line"><span class="lineno"> 3113</span>  <span class="comment">// live entries.</span></div>
<div class="line"><span class="lineno"> 3114</span> </div>
<div class="line"><span class="lineno"> 3115</span>  <span class="comment">// Reading length_info_ is not strictly required for Lookup, if we were</span></div>
<div class="line"><span class="lineno"> 3116</span>  <span class="comment">// to increment shift sizes until we see a shift size match on the</span></div>
<div class="line"><span class="lineno"> 3117</span>  <span class="comment">// relevant head pointer. Thus, reading with relaxed memory order gives</span></div>
<div class="line"><span class="lineno"> 3118</span>  <span class="comment">// us a safe and almost always up-to-date jump into finding the correct</span></div>
<div class="line"><span class="lineno"> 3119</span>  <span class="comment">// home and head.</span></div>
<div class="line"><span class="lineno"> 3120</span>  <span class="keywordtype">size_t</span> home;</div>
<div class="line"><span class="lineno"> 3121</span>  <span class="keywordtype">int</span> home_shift;</div>
<div class="line"><span class="lineno"> 3122</span>  GetHomeIndexAndShift(<a class="code hl_variable" href="#a691cf5bc49f36f3001d8c980901de288">length_info_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6a8401cbb9ead0bbb0def8fbfbabc97d">LoadRelaxed</a>(), hashed_key[1], &amp;home,</div>
<div class="line"><span class="lineno"> 3123</span>                       &amp;home_shift);</div>
<div class="line"><span class="lineno"> 3124</span>  assert(home_shift &gt; 0);</div>
<div class="line"><span class="lineno"> 3125</span> </div>
<div class="line"><span class="lineno"> 3126</span>  <span class="comment">// The full Lookup algorithm however is not great for hot path efficiency,</span></div>
<div class="line"><span class="lineno"> 3127</span>  <span class="comment">// because of the extra careful tracking described above. Overwhelmingly,</span></div>
<div class="line"><span class="lineno"> 3128</span>  <span class="comment">// we can find what we&#39;re looking for with a naive linked list traversal</span></div>
<div class="line"><span class="lineno"> 3129</span>  <span class="comment">// of the chain. Even if we &quot;fall off our chain&quot; to another, we don&#39;t</span></div>
<div class="line"><span class="lineno"> 3130</span>  <span class="comment">// violate memory safety. We just won&#39;t match the key we&#39;re looking for.</span></div>
<div class="line"><span class="lineno"> 3131</span>  <span class="comment">// And we would eventually reach an end state, possibly even experiencing a</span></div>
<div class="line"><span class="lineno"> 3132</span>  <span class="comment">// cycle as an entry is freed and reused during our traversal (though at</span></div>
<div class="line"><span class="lineno"> 3133</span>  <span class="comment">// any point in time the structure doesn&#39;t have cycles).</span></div>
<div class="line"><span class="lineno"> 3134</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3135</span>  <span class="comment">// So for hot path efficiency, we start with a naive Lookup attempt, and</span></div>
<div class="line"><span class="lineno"> 3136</span>  <span class="comment">// then fall back on full Lookup if we don&#39;t find the correct entry. To</span></div>
<div class="line"><span class="lineno"> 3137</span>  <span class="comment">// cap how much we invest into the naive Lookup, we simply cap the traversal</span></div>
<div class="line"><span class="lineno"> 3138</span>  <span class="comment">// length before falling back. Also, when we do fall back on full Lookup,</span></div>
<div class="line"><span class="lineno"> 3139</span>  <span class="comment">// we aren&#39;t paying much penalty by starting over. Much or most of the cost</span></div>
<div class="line"><span class="lineno"> 3140</span>  <span class="comment">// of Lookup is memory latency in following the chain pointers, and the</span></div>
<div class="line"><span class="lineno"> 3141</span>  <span class="comment">// naive Lookup has warmed the CPU cache for these entries, using as tight</span></div>
<div class="line"><span class="lineno"> 3142</span>  <span class="comment">// of a loop as possible.</span></div>
<div class="line"><span class="lineno"> 3143</span> </div>
<div class="line"><span class="lineno"> 3144</span>  HandleImpl* <span class="keyword">const</span> arr = <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>.<a class="code hl_function" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a9e0a723fcd917e570cf4207a40eef092">Get</a>();</div>
<div class="line"><span class="lineno"> 3145</span>  uint64_t next_with_shift = arr[home].head_next_with_shift.LoadRelaxed();</div>
<div class="line"><span class="lineno"> 3146</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; !HandleImpl::IsEnd(next_with_shift) &amp;&amp; i &lt; 10; ++i) {</div>
<div class="line"><span class="lineno"> 3147</span>    HandleImpl* h = &amp;arr[GetNextFromNextWithShift(next_with_shift)];</div>
<div class="line"><span class="lineno"> 3148</span>    <span class="comment">// Attempt cheap key match without acquiring a read ref. This could give a</span></div>
<div class="line"><span class="lineno"> 3149</span>    <span class="comment">// false positive, which is re-checked after acquiring read ref, or false</span></div>
<div class="line"><span class="lineno"> 3150</span>    <span class="comment">// negative, which is re-checked in the full Lookup. Also, this is a</span></div>
<div class="line"><span class="lineno"> 3151</span>    <span class="comment">// technical UB data race according to TSAN, but we don&#39;t need to read</span></div>
<div class="line"><span class="lineno"> 3152</span>    <span class="comment">// a &quot;correct&quot; value here for correct overall behavior.</span></div>
<div class="line"><span class="lineno"> 3153</span><span class="preprocessor">#ifdef __SANITIZE_THREAD__</span></div>
<div class="line"><span class="lineno"> 3154</span>    <span class="keywordtype">bool</span> probably_equal = Random::GetTLSInstance()-&gt;OneIn(2);</div>
<div class="line"><span class="lineno"> 3155</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 3156</span>    <span class="keywordtype">bool</span> probably_equal = h-&gt;hashed_key == hashed_key;</div>
<div class="line"><span class="lineno"> 3157</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3158</span>    <span class="keywordflow">if</span> (probably_equal) {</div>
<div class="line"><span class="lineno"> 3159</span>      <span class="comment">// Increment acquire counter for definitive check</span></div>
<div class="line"><span class="lineno"> 3160</span>      uint64_t old_meta = h-&gt;meta.FetchAdd(ClockHandle::kAcquireIncrement);</div>
<div class="line"><span class="lineno"> 3161</span>      <span class="comment">// Check if it&#39;s a referencable (sharable) entry</span></div>
<div class="line"><span class="lineno"> 3162</span>      <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d6/dd6/likely_8h.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a>(old_meta &amp; (uint64_t{ClockHandle::kStateShareableBit}</div>
<div class="line"><span class="lineno"> 3163</span>                             &lt;&lt; ClockHandle::kStateShift))) {</div>
<div class="line"><span class="lineno"> 3164</span>        assert(GetRefcount(old_meta + ClockHandle::kAcquireIncrement) &gt; 0);</div>
<div class="line"><span class="lineno"> 3165</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d6/dd6/likely_8h.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a>(h-&gt;hashed_key == hashed_key) &amp;&amp;</div>
<div class="line"><span class="lineno"> 3166</span>            <a class="code hl_define" href="../../d6/dd6/likely_8h.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a>(old_meta &amp; (uint64_t{ClockHandle::kStateVisibleBit}</div>
<div class="line"><span class="lineno"> 3167</span>                               &lt;&lt; ClockHandle::kStateShift))) {</div>
<div class="line"><span class="lineno"> 3168</span>          <span class="keywordflow">return</span> h;</div>
<div class="line"><span class="lineno"> 3169</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3170</span>          Unref(*h);</div>
<div class="line"><span class="lineno"> 3171</span>        }</div>
<div class="line"><span class="lineno"> 3172</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3173</span>        <span class="comment">// For non-sharable states, incrementing the acquire counter has no</span></div>
<div class="line"><span class="lineno"> 3174</span>        <span class="comment">// effect so we don&#39;t need to undo it. Furthermore, we cannot safely</span></div>
<div class="line"><span class="lineno"> 3175</span>        <span class="comment">// undo it because we did not acquire a read reference to lock the entry</span></div>
<div class="line"><span class="lineno"> 3176</span>        <span class="comment">// in a Shareable state.</span></div>
<div class="line"><span class="lineno"> 3177</span>      }</div>
<div class="line"><span class="lineno"> 3178</span>    }</div>
<div class="line"><span class="lineno"> 3179</span> </div>
<div class="line"><span class="lineno"> 3180</span>    next_with_shift = h-&gt;chain_next_with_shift.LoadRelaxed();</div>
<div class="line"><span class="lineno"> 3181</span>  }</div>
<div class="line"><span class="lineno"> 3182</span> </div>
<div class="line"><span class="lineno"> 3183</span>  <span class="comment">// If we get here, falling back on full Lookup algorithm.</span></div>
<div class="line"><span class="lineno"> 3184</span>  HandleImpl* h = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 3185</span>  HandleImpl* read_ref_on_chain = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 3186</span> </div>
<div class="line"><span class="lineno"> 3187</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0;; ++i) {</div>
<div class="line"><span class="lineno"> 3188</span>    <a class="code hl_define" href="../../d0/d8b/clock__cache_8cc.html#afe85b67c91564218df748652e3d954f1">CHECK_TOO_MANY_ITERATIONS</a>(i);</div>
<div class="line"><span class="lineno"> 3189</span>    <span class="comment">// Read head or chain pointer</span></div>
<div class="line"><span class="lineno"> 3190</span>    next_with_shift = h ? h-&gt;chain_next_with_shift.Load()</div>
<div class="line"><span class="lineno"> 3191</span>                        : arr[home].head_next_with_shift.Load();</div>
<div class="line"><span class="lineno"> 3192</span>    <span class="keywordtype">int</span> shift = GetShiftFromNextWithShift(next_with_shift);</div>
<div class="line"><span class="lineno"> 3193</span> </div>
<div class="line"><span class="lineno"> 3194</span>    <span class="comment">// Make sure it&#39;s usable</span></div>
<div class="line"><span class="lineno"> 3195</span>    <span class="keywordtype">size_t</span> effective_home = home;</div>
<div class="line"><span class="lineno"> 3196</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d6/dd6/likely_8h.html#ab10d0a221f4d7a706701b806c8135fd7">UNLIKELY</a>(shift != home_shift)) {</div>
<div class="line"><span class="lineno"> 3197</span>      <span class="comment">// We have potentially gone awry somehow, but it&#39;s possible we&#39;re just</span></div>
<div class="line"><span class="lineno"> 3198</span>      <span class="comment">// hitting old data that is not yet completed Grow.</span></div>
<div class="line"><span class="lineno"> 3199</span>      <span class="comment">// NOTE: shift bits goes up with table growth.</span></div>
<div class="line"><span class="lineno"> 3200</span>      <span class="keywordflow">if</span> (shift &lt; home_shift) {</div>
<div class="line"><span class="lineno"> 3201</span>        <span class="comment">// To avoid waiting on Grow in progress, an old shift amount needs</span></div>
<div class="line"><span class="lineno"> 3202</span>        <span class="comment">// to be processed as if we were still using it and (potentially</span></div>
<div class="line"><span class="lineno"> 3203</span>        <span class="comment">// different or the same) the old home.</span></div>
<div class="line"><span class="lineno"> 3204</span>        <span class="comment">// We can assert it&#39;s not too old, because each generation of Grow</span></div>
<div class="line"><span class="lineno"> 3205</span>        <span class="comment">// waits on its ancestor in the previous generation.</span></div>
<div class="line"><span class="lineno"> 3206</span>        assert(shift + 1 == home_shift);</div>
<div class="line"><span class="lineno"> 3207</span>        effective_home = GetHomeIndex(home, shift);</div>
<div class="line"><span class="lineno"> 3208</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h == read_ref_on_chain) {</div>
<div class="line"><span class="lineno"> 3209</span>        assert(shift &gt; home_shift);</div>
<div class="line"><span class="lineno"> 3210</span>        <span class="comment">// At head or coming from an entry on our chain where we&#39;re holding</span></div>
<div class="line"><span class="lineno"> 3211</span>        <span class="comment">// a read reference. Thus, we know the newer shift applies to us.</span></div>
<div class="line"><span class="lineno"> 3212</span>        <span class="comment">// Newer shift might not yet be reflected in length_info_ (an atomicity</span></div>
<div class="line"><span class="lineno"> 3213</span>        <span class="comment">// gap in Grow), so operate as if it is. Note that other insertions</span></div>
<div class="line"><span class="lineno"> 3214</span>        <span class="comment">// could happen using this shift before length_info_ is updated, and</span></div>
<div class="line"><span class="lineno"> 3215</span>        <span class="comment">// it&#39;s possible (though unlikely) that multiple generations of Grow</span></div>
<div class="line"><span class="lineno"> 3216</span>        <span class="comment">// have occurred. If shift is more than one generation ahead of</span></div>
<div class="line"><span class="lineno"> 3217</span>        <span class="comment">// home_shift, it&#39;s possible that not all descendent homes have</span></div>
<div class="line"><span class="lineno"> 3218</span>        <span class="comment">// reached the `shift` generation. Thus, we need to advance only one</span></div>
<div class="line"><span class="lineno"> 3219</span>        <span class="comment">// shift at a time looking for a home+head with a matching shift</span></div>
<div class="line"><span class="lineno"> 3220</span>        <span class="comment">// amount.</span></div>
<div class="line"><span class="lineno"> 3221</span>        home_shift++;</div>
<div class="line"><span class="lineno"> 3222</span>        <span class="comment">// Update home in case it has changed</span></div>
<div class="line"><span class="lineno"> 3223</span>        home = GetHomeIndex(hashed_key[1], home_shift);</div>
<div class="line"><span class="lineno"> 3224</span>        <span class="comment">// This should be rare enough occurrence that it&#39;s simplest just</span></div>
<div class="line"><span class="lineno"> 3225</span>        <span class="comment">// to restart (TODO: improve in some cases?)</span></div>
<div class="line"><span class="lineno"> 3226</span>        h = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 3227</span>        <span class="keywordflow">if</span> (read_ref_on_chain) {</div>
<div class="line"><span class="lineno"> 3228</span>          Unref(*read_ref_on_chain);</div>
<div class="line"><span class="lineno"> 3229</span>          read_ref_on_chain = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 3230</span>        }</div>
<div class="line"><span class="lineno"> 3231</span>        <span class="comment">// Didn&#39;t make progress &amp; retry</span></div>
<div class="line"><span class="lineno"> 3232</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3233</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3234</span>        assert(shift &gt; home_shift);</div>
<div class="line"><span class="lineno"> 3235</span>        assert(h != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 3236</span>        <span class="comment">// An &quot;under (de)construction&quot; entry has a new shift amount, which</span></div>
<div class="line"><span class="lineno"> 3237</span>        <span class="comment">// means we have either gotten off our chain or our home shift is out</span></div>
<div class="line"><span class="lineno"> 3238</span>        <span class="comment">// of date. If we revert back to saved ref, we will get updated info.</span></div>
<div class="line"><span class="lineno"> 3239</span>        h = read_ref_on_chain;</div>
<div class="line"><span class="lineno"> 3240</span>        <span class="comment">// Didn&#39;t make progress &amp; retry</span></div>
<div class="line"><span class="lineno"> 3241</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3242</span>      }</div>
<div class="line"><span class="lineno"> 3243</span>    }</div>
<div class="line"><span class="lineno"> 3244</span> </div>
<div class="line"><span class="lineno"> 3245</span>    <span class="comment">// Check for end marker</span></div>
<div class="line"><span class="lineno"> 3246</span>    <span class="keywordflow">if</span> (HandleImpl::IsEnd(next_with_shift)) {</div>
<div class="line"><span class="lineno"> 3247</span>      <span class="comment">// To ensure we didn&#39;t miss anything in the chain, the end marker must</span></div>
<div class="line"><span class="lineno"> 3248</span>      <span class="comment">// point back to the correct home.</span></div>
<div class="line"><span class="lineno"> 3249</span>      <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d6/dd6/likely_8h.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a>(GetNextFromNextWithShift(next_with_shift) == effective_home)) {</div>
<div class="line"><span class="lineno"> 3250</span>        <span class="comment">// Complete, clean iteration of the chain, not found.</span></div>
<div class="line"><span class="lineno"> 3251</span>        <span class="comment">// Clean up.</span></div>
<div class="line"><span class="lineno"> 3252</span>        <span class="keywordflow">if</span> (read_ref_on_chain) {</div>
<div class="line"><span class="lineno"> 3253</span>          Unref(*read_ref_on_chain);</div>
<div class="line"><span class="lineno"> 3254</span>        }</div>
<div class="line"><span class="lineno"> 3255</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 3256</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3257</span>        <span class="comment">// Something went awry. Revert back to a safe point (if we have it)</span></div>
<div class="line"><span class="lineno"> 3258</span>        h = read_ref_on_chain;</div>
<div class="line"><span class="lineno"> 3259</span>        <span class="comment">// Didn&#39;t make progress &amp; retry</span></div>
<div class="line"><span class="lineno"> 3260</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3261</span>      }</div>
<div class="line"><span class="lineno"> 3262</span>    }</div>
<div class="line"><span class="lineno"> 3263</span> </div>
<div class="line"><span class="lineno"> 3264</span>    <span class="comment">// Follow the next and check for full key match, home match, or neither</span></div>
<div class="line"><span class="lineno"> 3265</span>    h = &amp;arr[GetNextFromNextWithShift(next_with_shift)];</div>
<div class="line"><span class="lineno"> 3266</span>    <span class="keywordtype">bool</span> full_match_or_unknown = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3267</span>    <span class="keywordflow">if</span> (MatchAndRef(&amp;hashed_key, *h, shift, effective_home,</div>
<div class="line"><span class="lineno"> 3268</span>                    &amp;full_match_or_unknown)) {</div>
<div class="line"><span class="lineno"> 3269</span>      <span class="comment">// Got a read ref on next (h).</span></div>
<div class="line"><span class="lineno"> 3270</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3271</span>      <span class="comment">// There is a very small chance that between getting the next pointer</span></div>
<div class="line"><span class="lineno"> 3272</span>      <span class="comment">// (now h) and doing MatchAndRef on it, another thread erased/evicted it</span></div>
<div class="line"><span class="lineno"> 3273</span>      <span class="comment">// reinserted it into the same chain, causing us to cycle back in the</span></div>
<div class="line"><span class="lineno"> 3274</span>      <span class="comment">// same chain and potentially see some entries again if we keep walking.</span></div>
<div class="line"><span class="lineno"> 3275</span>      <span class="comment">// Newly-inserted entries are inserted before older ones, so we are at</span></div>
<div class="line"><span class="lineno"> 3276</span>      <span class="comment">// least guaranteed not to miss anything. Here in Lookup, it&#39;s just a</span></div>
<div class="line"><span class="lineno"> 3277</span>      <span class="comment">// transient, slight hiccup in performance.</span></div>
<div class="line"><span class="lineno"> 3278</span> </div>
<div class="line"><span class="lineno"> 3279</span>      <span class="keywordflow">if</span> (full_match_or_unknown) {</div>
<div class="line"><span class="lineno"> 3280</span>        <span class="comment">// Full match.</span></div>
<div class="line"><span class="lineno"> 3281</span>        <span class="comment">// Release old read ref on chain if applicable</span></div>
<div class="line"><span class="lineno"> 3282</span>        <span class="keywordflow">if</span> (read_ref_on_chain) {</div>
<div class="line"><span class="lineno"> 3283</span>          <span class="comment">// Pretend we never took the reference.</span></div>
<div class="line"><span class="lineno"> 3284</span>          Unref(*read_ref_on_chain);</div>
<div class="line"><span class="lineno"> 3285</span>        }</div>
<div class="line"><span class="lineno"> 3286</span>        <span class="comment">// Update the hit bit</span></div>
<div class="line"><span class="lineno"> 3287</span>        <span class="keywordflow">if</span> (eviction_callback_) {</div>
<div class="line"><span class="lineno"> 3288</span>          h-&gt;meta.FetchOrRelaxed(uint64_t{1} &lt;&lt; ClockHandle::kHitBitShift);</div>
<div class="line"><span class="lineno"> 3289</span>        }</div>
<div class="line"><span class="lineno"> 3290</span>        <span class="comment">// All done.</span></div>
<div class="line"><span class="lineno"> 3291</span>        <span class="keywordflow">return</span> h;</div>
<div class="line"><span class="lineno"> 3292</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d6/dd6/likely_8h.html#ab10d0a221f4d7a706701b806c8135fd7">UNLIKELY</a>(shift != home_shift) &amp;&amp;</div>
<div class="line"><span class="lineno"> 3293</span>                 home != <a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94">BottomNBits</a>(h-&gt;hashed_key[1], home_shift)) {</div>
<div class="line"><span class="lineno"> 3294</span>        <span class="comment">// This chain is in a Grow operation and we&#39;ve landed on an entry</span></div>
<div class="line"><span class="lineno"> 3295</span>        <span class="comment">// that belongs to the wrong destination chain. We can keep going, but</span></div>
<div class="line"><span class="lineno"> 3296</span>        <span class="comment">// there&#39;s a chance we&#39;ll need to backtrack back *before* this entry,</span></div>
<div class="line"><span class="lineno"> 3297</span>        <span class="comment">// if the Grow finishes before this Lookup. We cannot save this entry</span></div>
<div class="line"><span class="lineno"> 3298</span>        <span class="comment">// for backtracking because it might soon or already be on the wrong</span></div>
<div class="line"><span class="lineno"> 3299</span>        <span class="comment">// chain.</span></div>
<div class="line"><span class="lineno"> 3300</span>        <span class="comment">// NOTE: if we simply backtrack rather than continuing, we would</span></div>
<div class="line"><span class="lineno"> 3301</span>        <span class="comment">// be in a wait loop (not allowed in Lookup!) until the other thread</span></div>
<div class="line"><span class="lineno"> 3302</span>        <span class="comment">// finishes its Grow.</span></div>
<div class="line"><span class="lineno"> 3303</span>        Unref(*h);</div>
<div class="line"><span class="lineno"> 3304</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3305</span>        <span class="comment">// Correct home location, so we are on the right chain.</span></div>
<div class="line"><span class="lineno"> 3306</span>        <span class="comment">// With new usable read ref, can release old one (if applicable).</span></div>
<div class="line"><span class="lineno"> 3307</span>        <span class="keywordflow">if</span> (read_ref_on_chain) {</div>
<div class="line"><span class="lineno"> 3308</span>          <span class="comment">// Pretend we never took the reference.</span></div>
<div class="line"><span class="lineno"> 3309</span>          Unref(*read_ref_on_chain);</div>
<div class="line"><span class="lineno"> 3310</span>        }</div>
<div class="line"><span class="lineno"> 3311</span>        <span class="comment">// And keep the new one.</span></div>
<div class="line"><span class="lineno"> 3312</span>        read_ref_on_chain = h;</div>
<div class="line"><span class="lineno"> 3313</span>      }</div>
<div class="line"><span class="lineno"> 3314</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3315</span>      <span class="keywordflow">if</span> (full_match_or_unknown) {</div>
<div class="line"><span class="lineno"> 3316</span>        <span class="comment">// Must have been an &quot;under construction&quot; entry. Can safely skip it,</span></div>
<div class="line"><span class="lineno"> 3317</span>        <span class="comment">// but there&#39;s a chance we&#39;ll have to backtrack later</span></div>
<div class="line"><span class="lineno"> 3318</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3319</span>        <span class="comment">// Home mismatch! Revert back to a safe point (if we have it)</span></div>
<div class="line"><span class="lineno"> 3320</span>        h = read_ref_on_chain;</div>
<div class="line"><span class="lineno"> 3321</span>        <span class="comment">// Didn&#39;t make progress &amp; retry</span></div>
<div class="line"><span class="lineno"> 3322</span>      }</div>
<div class="line"><span class="lineno"> 3323</span>    }</div>
<div class="line"><span class="lineno"> 3324</span>  }</div>
<div class="line"><span class="lineno"> 3325</span>}</div>
<div class="ttc" id="alikely_8h_html_affde14445f49f65ff4f5b592e44ee71a"><div class="ttname"><a href="../../d6/dd6/likely_8h.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a></div><div class="ttdeci">#define LIKELY(x)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dd6/likely_8h_source.html#l00016">likely.h:16</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9c1fa5039809f0efeb200afc4db8bf8_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9c1fa5039809f0efeb200afc4db8bf8_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9c1fa5039809f0efeb200afc4db8bf8_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9c1fa5039809f0efeb200afc4db8bf8_cgraph">
<area shape="rect" title=" " alt="" coords="5,68,219,129"/>
<area shape="poly" title=" " alt="" coords="63,67,65,57,74,48,90,43,112,41,138,44,154,51,151,56,136,49,112,46,91,48,77,53,70,59,69,68"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="268,29,450,74"/>
<area shape="poly" title=" " alt="" coords="219,76,252,69,253,74,220,81"/>
<area shape="rect" href="../../d9/d54/classROCKSDB__NAMESPACE_1_1Random.html#a4c57e895d1948533257b40c47d833ea5" title=" " alt="" coords="267,123,451,167"/>
<area shape="poly" title=" " alt="" coords="220,116,252,122,251,127,219,121"/>
<area shape="poly" title=" " alt="" coords="315,29,313,19,321,10,336,5,359,3,384,5,399,12,397,17,382,10,359,8,337,10,324,15,319,21,320,28"/>
<area shape="poly" title=" " alt="" coords="315,123,313,113,321,104,336,98,359,96,384,99,399,105,397,110,382,104,359,101,337,103,324,108,319,114,320,122"/>
<area shape="rect" href="../../d9/d54/classROCKSDB__NAMESPACE_1_1Random.html#a888cf2ca1df96e1684d405ae41c2407a" title=" " alt="" coords="499,123,680,167"/>
<area shape="poly" title=" " alt="" coords="452,142,484,142,484,148,452,148"/>
<area shape="rect" href="../../d9/d54/classROCKSDB__NAMESPACE_1_1Random.html#a36e0813921e89bdf5af60a3a58a33565" title=" " alt="" coords="728,123,910,167"/>
<area shape="poly" title=" " alt="" coords="681,142,713,142,713,148,681,148"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9c1fa5039809f0efeb200afc4db8bf8_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9c1fa5039809f0efeb200afc4db8bf8_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9c1fa5039809f0efeb200afc4db8bf8_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9c1fa5039809f0efeb200afc4db8bf8_icgraph">
<area shape="rect" title=" " alt="" coords="267,29,480,91"/>
<area shape="poly" title=" " alt="" coords="415,17,399,11,373,8,351,10,336,15,328,21,327,29,322,29,324,19,333,10,350,5,373,3,401,5,417,13"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#aa5b762aa6657b81ad29f6cd51ea9f305" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="251,63,219,63,219,58,251,58"/>
<area shape="poly" title=" " alt="" coords="154,17,138,11,112,8,89,10,74,15,67,21,66,29,61,29,62,19,72,10,88,5,112,3,139,5,156,13"/>
</map>
</div>

</div>
</div>
<a id="a353c1aa19f1e338db90086bdca07407b" name="a353c1aa19f1e338db90086bdca07407b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a353c1aa19f1e338db90086bdca07407b">&#9670;&#160;</a></span>PurgeImpl()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class OpData&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::PurgeImpl </td>
          <td>(</td>
          <td class="paramtype">OpData *</td>          <td class="paramname"><span class="paramname"><em>op_data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>home</em></span><span class="paramdefsep"> = </span><span class="paramdefval">SIZE_MAX</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d35/structROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_1_1EvictionData.html">BaseClockTable::EvictionData</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span><span class="paramdefsep"> = </span><span class="paramdefval">nullptr</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l02784">2784</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2785</span>                                                                      {</div>
<div class="line"><span class="lineno"> 2786</span>  <span class="comment">// Early efforts to make AutoHCC fully wait-free ran into too many problems</span></div>
<div class="line"><span class="lineno"> 2787</span>  <span class="comment">// that needed obscure and potentially inefficient work-arounds to have a</span></div>
<div class="line"><span class="lineno"> 2788</span>  <span class="comment">// chance at working.</span></div>
<div class="line"><span class="lineno"> 2789</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2790</span>  <span class="comment">// The implementation settled on &quot;essentially wait-free&quot; which can be</span></div>
<div class="line"><span class="lineno"> 2791</span>  <span class="comment">// achieved by locking at the level of each probing chain and only for</span></div>
<div class="line"><span class="lineno"> 2792</span>  <span class="comment">// operations that might remove entries from the chain. Because parallel</span></div>
<div class="line"><span class="lineno"> 2793</span>  <span class="comment">// clock updates and Grow operations are ordered, contention is very rare.</span></div>
<div class="line"><span class="lineno"> 2794</span>  <span class="comment">// However, parallel insertions at any chain head have to be accommodated</span></div>
<div class="line"><span class="lineno"> 2795</span>  <span class="comment">// to keep them wait-free.</span></div>
<div class="line"><span class="lineno"> 2796</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2797</span>  <span class="comment">// This function implements Purge and ClockUpdateChain functions (see above</span></div>
<div class="line"><span class="lineno"> 2798</span>  <span class="comment">// OpData type definitions) as part of higher-level operations. This function</span></div>
<div class="line"><span class="lineno"> 2799</span>  <span class="comment">// ensures the correct chain is (eventually) covered and handles rewrite</span></div>
<div class="line"><span class="lineno"> 2800</span>  <span class="comment">// locking the chain. PurgeImplLocked has lower level details.</span></div>
<div class="line"><span class="lineno"> 2801</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2802</span>  <span class="comment">// In general, these operations and Grow are kept simpler by allowing eager</span></div>
<div class="line"><span class="lineno"> 2803</span>  <span class="comment">// purging of under (de-)construction entries. For example, an Erase</span></div>
<div class="line"><span class="lineno"> 2804</span>  <span class="comment">// operation might find that another thread has purged the entry from the</span></div>
<div class="line"><span class="lineno"> 2805</span>  <span class="comment">// chain by the time its own purge operation acquires the rewrite lock and</span></div>
<div class="line"><span class="lineno"> 2806</span>  <span class="comment">// proceeds. This is OK, and potentially reduces the number of lock/unlock</span></div>
<div class="line"><span class="lineno"> 2807</span>  <span class="comment">// cycles because empty chains are not rewrite-lockable.</span></div>
<div class="line"><span class="lineno"> 2808</span> </div>
<div class="line"><span class="lineno"> 2809</span>  <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> kIsPurge = std::is_same_v&lt;OpData, PurgeOpData&gt;;</div>
<div class="line"><span class="lineno"> 2810</span>  <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> kIsClockUpdateChain =</div>
<div class="line"><span class="lineno"> 2811</span>      std::is_same_v&lt;OpData, ClockUpdateChainOpData&gt;;</div>
<div class="line"><span class="lineno"> 2812</span> </div>
<div class="line"><span class="lineno"> 2813</span>  <span class="comment">// Exactly one op specified</span></div>
<div class="line"><span class="lineno"> 2814</span>  <span class="keyword">static_assert</span>(kIsPurge + kIsClockUpdateChain == 1);</div>
<div class="line"><span class="lineno"> 2815</span> </div>
<div class="line"><span class="lineno"> 2816</span>  <span class="keywordtype">int</span> home_shift = 0;</div>
<div class="line"><span class="lineno"> 2817</span>  <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (kIsPurge) {</div>
<div class="line"><span class="lineno"> 2818</span>    <span class="comment">// Purge callers leave home unspecified, to be determined from key</span></div>
<div class="line"><span class="lineno"> 2819</span>    assert(home == SIZE_MAX);</div>
<div class="line"><span class="lineno"> 2820</span>    GetHomeIndexAndShift(<a class="code hl_variable" href="#a691cf5bc49f36f3001d8c980901de288">length_info_</a>.<a class="code hl_function" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a5361060db542ce3ebfd914aecb908f8c">Load</a>(), (*op_data)[1], &amp;home,</div>
<div class="line"><span class="lineno"> 2821</span>                         &amp;home_shift);</div>
<div class="line"><span class="lineno"> 2822</span>    assert(home_shift &gt; 0);</div>
<div class="line"><span class="lineno"> 2823</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2824</span>    assert(kIsClockUpdateChain);</div>
<div class="line"><span class="lineno"> 2825</span>    <span class="comment">// Evict callers must specify home</span></div>
<div class="line"><span class="lineno"> 2826</span>    assert(home &lt; SIZE_MAX);</div>
<div class="line"><span class="lineno"> 2827</span>  }</div>
<div class="line"><span class="lineno"> 2828</span> </div>
<div class="line"><span class="lineno"> 2829</span>  HandleImpl* <span class="keyword">const</span> arr = <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>.<a class="code hl_function" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a9e0a723fcd917e570cf4207a40eef092">Get</a>();</div>
<div class="line"><span class="lineno"> 2830</span> </div>
<div class="line"><span class="lineno"> 2831</span>  <span class="comment">// Acquire the RAII rewrite lock (if not an empty chain)</span></div>
<div class="line"><span class="lineno"> 2832</span>  ChainRewriteLock rewrite_lock(&amp;arr[home], yield_count_);</div>
<div class="line"><span class="lineno"> 2833</span> </div>
<div class="line"><span class="lineno"> 2834</span>  <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (kIsPurge) {</div>
<div class="line"><span class="lineno"> 2835</span>    <span class="comment">// Ensure we are at the correct home for the shift in effect for the</span></div>
<div class="line"><span class="lineno"> 2836</span>    <span class="comment">// chain head.</span></div>
<div class="line"><span class="lineno"> 2837</span>    <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><span class="lineno"> 2838</span>      <span class="keywordtype">int</span> shift = GetShiftFromNextWithShift(rewrite_lock.GetSavedHead());</div>
<div class="line"><span class="lineno"> 2839</span> </div>
<div class="line"><span class="lineno"> 2840</span>      <span class="keywordflow">if</span> (shift &gt; home_shift) {</div>
<div class="line"><span class="lineno"> 2841</span>        <span class="comment">// Found a newer shift at candidate head, which must apply to us.</span></div>
<div class="line"><span class="lineno"> 2842</span>        <span class="comment">// Newer shift might not yet be reflected in length_info_ (an atomicity</span></div>
<div class="line"><span class="lineno"> 2843</span>        <span class="comment">// gap in Grow), so operate as if it is. Note that other insertions</span></div>
<div class="line"><span class="lineno"> 2844</span>        <span class="comment">// could happen using this shift before length_info_ is updated, and</span></div>
<div class="line"><span class="lineno"> 2845</span>        <span class="comment">// it&#39;s possible (though unlikely) that multiple generations of Grow</span></div>
<div class="line"><span class="lineno"> 2846</span>        <span class="comment">// have occurred. If shift is more than one generation ahead of</span></div>
<div class="line"><span class="lineno"> 2847</span>        <span class="comment">// home_shift, it&#39;s possible that not all descendent homes have</span></div>
<div class="line"><span class="lineno"> 2848</span>        <span class="comment">// reached the `shift` generation. Thus, we need to advance only one</span></div>
<div class="line"><span class="lineno"> 2849</span>        <span class="comment">// shift at a time looking for a home+head with a matching shift</span></div>
<div class="line"><span class="lineno"> 2850</span>        <span class="comment">// amount.</span></div>
<div class="line"><span class="lineno"> 2851</span>        home_shift++;</div>
<div class="line"><span class="lineno"> 2852</span>        home = GetHomeIndex((*op_data)[1], home_shift);</div>
<div class="line"><span class="lineno"> 2853</span>        rewrite_lock.Reset(&amp;arr[home], yield_count_);</div>
<div class="line"><span class="lineno"> 2854</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2855</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2856</span>        assert(shift == home_shift);</div>
<div class="line"><span class="lineno"> 2857</span>      }</div>
<div class="line"><span class="lineno"> 2858</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2859</span>    }</div>
<div class="line"><span class="lineno"> 2860</span>  }</div>
<div class="line"><span class="lineno"> 2861</span> </div>
<div class="line"><span class="lineno"> 2862</span>  <span class="comment">// If the chain is empty, nothing to do</span></div>
<div class="line"><span class="lineno"> 2863</span>  <span class="keywordflow">if</span> (!rewrite_lock.IsEnd()) {</div>
<div class="line"><span class="lineno"> 2864</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (kIsPurge) {</div>
<div class="line"><span class="lineno"> 2865</span>      <a class="code hl_typedef" href="../../d9/dfe/namespaceROCKSDB__NAMESPACE_1_1clock__cache.html#ae1e84f46ab62a996f0a3a49003456084">PurgeLockedOpData</a>* locked_op_data{};</div>
<div class="line"><span class="lineno"> 2866</span>      <a class="code hl_function" href="#a4c68c3c5ccbe3c20bd71313b1a0f8e10">PurgeImplLocked</a>(locked_op_data, rewrite_lock, home, data);</div>
<div class="line"><span class="lineno"> 2867</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2868</span>      <a class="code hl_function" href="#a4c68c3c5ccbe3c20bd71313b1a0f8e10">PurgeImplLocked</a>(op_data, rewrite_lock, home, data);</div>
<div class="line"><span class="lineno"> 2869</span>    }</div>
<div class="line"><span class="lineno"> 2870</span>  }</div>
<div class="line"><span class="lineno"> 2871</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_a4c68c3c5ccbe3c20bd71313b1a0f8e10"><div class="ttname"><a href="#a4c68c3c5ccbe3c20bd71313b1a0f8e10">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::PurgeImplLocked</a></div><div class="ttdeci">void PurgeImplLocked(OpData *op_data, ChainRewriteLock &amp;rewrite_lock, size_t home, EvictionData *data)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l02651">clock_cache.cc:2651</a></div></div>
<div class="ttc" id="anamespaceROCKSDB__NAMESPACE_1_1clock__cache_html_ae1e84f46ab62a996f0a3a49003456084"><div class="ttname"><a href="../../d9/dfe/namespaceROCKSDB__NAMESPACE_1_1clock__cache.html#ae1e84f46ab62a996f0a3a49003456084">ROCKSDB_NAMESPACE::clock_cache::PurgeLockedOpData</a></div><div class="ttdeci">void PurgeLockedOpData</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l02641">clock_cache.cc:2641</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a353c1aa19f1e338db90086bdca07407b_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a353c1aa19f1e338db90086bdca07407b_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a353c1aa19f1e338db90086bdca07407b_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a353c1aa19f1e338db90086bdca07407b_cgraph">
<area shape="rect" title=" " alt="" coords="5,176,219,238"/>
<area shape="poly" title=" " alt="" coords="60,176,61,166,71,157,88,152,112,150,140,153,157,160,155,165,139,158,112,155,89,157,73,162,66,168,65,177"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#afe0c39ddafa0f49b10f9fe77ad8e702b" title=" " alt="" coords="806,5,1020,84"/>
<area shape="poly" title=" " alt="" coords="147,174,201,133,266,96,332,70,401,52,471,38,542,30,676,25,791,29,791,34,676,30,542,35,472,44,402,57,333,76,268,100,204,137,150,178"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a30417ab9b027b7113a0573d4fa6c7edb" title=" " alt="" coords="801,142,1025,204"/>
<area shape="poly" title=" " alt="" coords="217,236,329,262,464,281,536,286,609,285,682,278,753,263,809,241,858,211,861,215,811,246,754,269,683,283,610,290,536,291,463,287,328,267,216,241"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a4c68c3c5ccbe3c20bd71313b1a0f8e10" title=" " alt="" coords="273,134,486,196"/>
<area shape="poly" title=" " alt="" coords="219,188,257,181,258,187,220,193"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#ad0040262551e4d03603956bb5cea8b07" title=" " alt="" coords="267,332,492,394"/>
<area shape="poly" title=" " alt="" coords="158,236,268,308,296,323,294,328,265,312,155,241"/>
<area shape="poly" title=" " alt="" coords="419,131,474,96,539,67,603,52,668,42,791,36,791,42,668,48,604,57,541,73,477,101,422,136"/>
<area shape="poly" title=" " alt="" coords="327,133,328,123,338,115,355,109,379,107,407,110,424,117,422,122,406,115,379,112,356,114,341,119,333,126,332,134"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="556,209,737,254"/>
<area shape="poly" title=" " alt="" coords="487,189,541,202,540,208,486,194"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a13edad9a2ec43bc685dd5a1aaf70c21f" title=" " alt="" coords="540,83,753,161"/>
<area shape="poly" title=" " alt="" coords="486,145,524,139,525,144,487,150"/>
<area shape="poly" title=" " alt="" coords="596,209,595,199,603,190,621,184,647,182,675,185,692,191,690,196,674,190,647,188,622,190,606,194,600,200,601,208"/>
<area shape="poly" title=" " alt="" coords="753,88,791,77,792,83,754,94"/>
<area shape="poly" title=" " alt="" coords="754,140,786,146,785,151,753,145"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#af094887ce078b9180b272800614bd2ee" title=" " alt="" coords="806,295,1020,373"/>
<area shape="poly" title=" " alt="" coords="738,160,755,171,806,217,867,281,863,285,802,221,752,175,735,164"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631" title=" " alt="" coords="1073,312,1314,356"/>
<area shape="poly" title=" " alt="" coords="1020,331,1057,331,1057,337,1020,337"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a451c426fc0333c92fe9da85c3c1abd4a" title=" " alt="" coords="540,329,753,408"/>
<area shape="poly" title=" " alt="" coords="493,363,524,364,524,369,492,368"/>
<area shape="poly" title=" " alt="" coords="753,352,791,347,791,353,754,357"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a353c1aa19f1e338db90086bdca07407b_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a353c1aa19f1e338db90086bdca07407b_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a353c1aa19f1e338db90086bdca07407b_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a353c1aa19f1e338db90086bdca07407b_icgraph">
<area shape="rect" title=" " alt="" coords="1051,84,1264,146"/>
<area shape="poly" title=" " alt="" coords="1199,72,1183,65,1157,63,1135,65,1120,69,1112,76,1111,84,1106,83,1108,73,1117,65,1134,59,1157,57,1185,60,1201,67"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a9055868cef9d318a6d4bc97cc2f55c8d" title=" " alt="" coords="789,29,1003,91"/>
<area shape="poly" title=" " alt="" coords="1034,92,1003,85,1004,80,1036,87"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a24212c074c37a92800c31882b2907f8d" title=" " alt="" coords="789,139,1003,200"/>
<area shape="poly" title=" " alt="" coords="1036,143,1004,150,1003,145,1034,138"/>
<area shape="poly" title=" " alt="" coords="938,17,922,11,896,8,873,10,858,15,851,21,850,29,845,29,846,19,856,10,872,5,896,3,923,5,940,13"/>
<area shape="poly" title=" " alt="" coords="938,127,922,120,896,117,873,119,858,124,851,131,850,139,845,138,846,128,856,119,872,114,896,112,923,115,940,122"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#acecc474c0a88e9db56f62463c297fee0" title=" " alt="" coords="528,84,741,146"/>
<area shape="poly" title=" " alt="" coords="773,147,741,140,742,135,774,141"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a53060e46ed4e542a6db7f0e6bdae9c8a" title=" " alt="" coords="528,193,741,255"/>
<area shape="poly" title=" " alt="" coords="774,198,742,204,741,199,773,192"/>
<area shape="poly" title=" " alt="" coords="677,72,661,65,635,63,612,65,597,69,590,76,589,84,583,83,585,73,594,65,611,59,635,57,662,60,679,67"/>
<area shape="poly" title=" " alt="" coords="677,181,661,175,635,172,612,174,597,179,590,185,589,193,583,193,585,183,594,174,611,169,635,167,662,169,679,177"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#aa5b762aa6657b81ad29f6cd51ea9f305" title=" " alt="" coords="267,139,480,200"/>
<area shape="poly" title=" " alt="" coords="512,201,480,194,481,189,513,196"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a8ad5ee767437cfef149d7effdf2b97a4" title=" " alt="" coords="267,248,480,310"/>
<area shape="poly" title=" " alt="" coords="513,252,481,259,480,254,512,247"/>
<area shape="poly" title=" " alt="" coords="415,127,399,120,373,117,351,119,336,124,328,131,327,139,322,138,324,128,333,119,350,114,373,112,401,115,417,122"/>
<area shape="poly" title=" " alt="" coords="415,236,399,229,373,227,351,229,336,233,328,240,327,248,322,247,324,237,333,229,350,223,373,221,401,224,417,231"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#af9b12764aa02fbbf9120fb96ed552cf7" title=" " alt="" coords="5,248,219,310"/>
<area shape="poly" title=" " alt="" coords="251,282,219,282,219,276,251,276"/>
<area shape="poly" title=" " alt="" coords="154,236,138,229,112,227,89,229,74,233,67,240,66,248,61,247,62,237,72,229,88,223,112,221,139,224,156,231"/>
</map>
</div>

</div>
</div>
<a id="a4c68c3c5ccbe3c20bd71313b1a0f8e10" name="a4c68c3c5ccbe3c20bd71313b1a0f8e10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c68c3c5ccbe3c20bd71313b1a0f8e10">&#9670;&#160;</a></span>PurgeImplLocked()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class OpData&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::PurgeImplLocked </td>
          <td>(</td>
          <td class="paramtype">OpData *</td>          <td class="paramname"><span class="paramname"><em>op_data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html">ChainRewriteLock</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>rewrite_lock</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>home</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d35/structROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_1_1EvictionData.html">BaseClockTable::EvictionData</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l02651">2651</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2654</span>                                                                            {</div>
<div class="line"><span class="lineno"> 2655</span>  <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> kIsPurge = std::is_same_v&lt;OpData, PurgeLockedOpData&gt;;</div>
<div class="line"><span class="lineno"> 2656</span>  <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> kIsClockUpdateChain =</div>
<div class="line"><span class="lineno"> 2657</span>      std::is_same_v&lt;OpData, ClockUpdateChainLockedOpData&gt;;</div>
<div class="line"><span class="lineno"> 2658</span> </div>
<div class="line"><span class="lineno"> 2659</span>  <span class="comment">// Exactly one op specified</span></div>
<div class="line"><span class="lineno"> 2660</span>  <span class="keyword">static_assert</span>(kIsPurge + kIsClockUpdateChain == 1);</div>
<div class="line"><span class="lineno"> 2661</span> </div>
<div class="line"><span class="lineno"> 2662</span>  HandleImpl* <span class="keyword">const</span> arr = <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>.<a class="code hl_function" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a9e0a723fcd917e570cf4207a40eef092">Get</a>();</div>
<div class="line"><span class="lineno"> 2663</span> </div>
<div class="line"><span class="lineno"> 2664</span>  uint64_t next_with_shift = rewrite_lock.GetSavedHead();</div>
<div class="line"><span class="lineno"> 2665</span>  assert(!HandleImpl::IsEnd(next_with_shift));</div>
<div class="line"><span class="lineno"> 2666</span>  <span class="keywordtype">int</span> home_shift = GetShiftFromNextWithShift(next_with_shift);</div>
<div class="line"><span class="lineno"> 2667</span>  (void)home;</div>
<div class="line"><span class="lineno"> 2668</span>  (void)home_shift;</div>
<div class="line"><span class="lineno"> 2669</span>  <span class="keywordtype">size_t</span> next = GetNextFromNextWithShift(next_with_shift);</div>
<div class="line"><span class="lineno"> 2670</span>  assert(next &lt; <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>.<a class="code hl_function" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a28a017539929f61ec8037625acb2ee1e">Count</a>());</div>
<div class="line"><span class="lineno"> 2671</span>  HandleImpl* h = &amp;arr[next];</div>
<div class="line"><span class="lineno"> 2672</span>  HandleImpl* prev_to_keep = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2673</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><span class="lineno"> 2674</span>  uint64_t prev_to_keep_next_with_shift = 0;</div>
<div class="line"><span class="lineno"> 2675</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2676</span>  <span class="comment">// Whether there are entries between h and prev_to_keep that should be</span></div>
<div class="line"><span class="lineno"> 2677</span>  <span class="comment">// purged from the chain.</span></div>
<div class="line"><span class="lineno"> 2678</span>  <span class="keywordtype">bool</span> pending_purge = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2679</span> </div>
<div class="line"><span class="lineno"> 2680</span>  <span class="comment">// Walk the chain, and stitch together any entries that are still</span></div>
<div class="line"><span class="lineno"> 2681</span>  <span class="comment">// &quot;shareable,&quot; possibly after clock update. prev_to_keep tells us where</span></div>
<div class="line"><span class="lineno"> 2682</span>  <span class="comment">// the last &quot;stitch back to&quot; location is (nullptr =&gt; head).</span></div>
<div class="line"><span class="lineno"> 2683</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0;; ++i) {</div>
<div class="line"><span class="lineno"> 2684</span>    <a class="code hl_define" href="../../d0/d8b/clock__cache_8cc.html#afe85b67c91564218df748652e3d954f1">CHECK_TOO_MANY_ITERATIONS</a>(i);</div>
<div class="line"><span class="lineno"> 2685</span> </div>
<div class="line"><span class="lineno"> 2686</span>    <span class="keywordtype">bool</span> purgeable = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2687</span>    <span class="comment">// In last iteration, h will be nullptr, to stitch together the tail of</span></div>
<div class="line"><span class="lineno"> 2688</span>    <span class="comment">// the chain.</span></div>
<div class="line"><span class="lineno"> 2689</span>    <span class="keywordflow">if</span> (h) {</div>
<div class="line"><span class="lineno"> 2690</span>      <span class="comment">// NOTE: holding a rewrite lock on the chain prevents any &quot;under</span></div>
<div class="line"><span class="lineno"> 2691</span>      <span class="comment">// (de)construction&quot; entries in the chain from being marked empty, which</span></div>
<div class="line"><span class="lineno"> 2692</span>      <span class="comment">// allows us to access the hashed_keys without holding a read ref.</span></div>
<div class="line"><span class="lineno"> 2693</span>      assert(home == <a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94">BottomNBits</a>(h-&gt;hashed_key[1], home_shift));</div>
<div class="line"><span class="lineno"> 2694</span>      <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (kIsClockUpdateChain) {</div>
<div class="line"><span class="lineno"> 2695</span>        <span class="comment">// Clock update and/or check for purgeable (under (de)construction)</span></div>
<div class="line"><span class="lineno"> 2696</span>        <span class="keywordflow">if</span> (ClockUpdate(*h, data, &amp;purgeable)) {</div>
<div class="line"><span class="lineno"> 2697</span>          <span class="comment">// Remember for finishing eviction</span></div>
<div class="line"><span class="lineno"> 2698</span>          op_data-&gt;push_back(h);</div>
<div class="line"><span class="lineno"> 2699</span>          <span class="comment">// Entries for eviction become purgeable</span></div>
<div class="line"><span class="lineno"> 2700</span>          purgeable = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2701</span>          assert((h-&gt;meta.Load() &gt;&gt; ClockHandle::kStateShift) ==</div>
<div class="line"><span class="lineno"> 2702</span>                 ClockHandle::kStateConstruction);</div>
<div class="line"><span class="lineno"> 2703</span>        }</div>
<div class="line"><span class="lineno"> 2704</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2705</span>        (void)op_data;</div>
<div class="line"><span class="lineno"> 2706</span>        (void)data;</div>
<div class="line"><span class="lineno"> 2707</span>        purgeable = ((h-&gt;meta.Load() &gt;&gt; ClockHandle::kStateShift) &amp;</div>
<div class="line"><span class="lineno"> 2708</span>                     ClockHandle::kStateShareableBit) == 0;</div>
<div class="line"><span class="lineno"> 2709</span>      }</div>
<div class="line"><span class="lineno"> 2710</span>    }</div>
<div class="line"><span class="lineno"> 2711</span> </div>
<div class="line"><span class="lineno"> 2712</span>    <span class="keywordflow">if</span> (purgeable) {</div>
<div class="line"><span class="lineno"> 2713</span>      assert((h-&gt;meta.Load() &gt;&gt; ClockHandle::kStateShift) ==</div>
<div class="line"><span class="lineno"> 2714</span>             ClockHandle::kStateConstruction);</div>
<div class="line"><span class="lineno"> 2715</span>      pending_purge = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2716</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pending_purge) {</div>
<div class="line"><span class="lineno"> 2717</span>      <span class="keywordflow">if</span> (prev_to_keep) {</div>
<div class="line"><span class="lineno"> 2718</span>        <span class="comment">// Update chain next to skip purgeable entries</span></div>
<div class="line"><span class="lineno"> 2719</span>        assert(prev_to_keep-&gt;chain_next_with_shift.Load() ==</div>
<div class="line"><span class="lineno"> 2720</span>               prev_to_keep_next_with_shift);</div>
<div class="line"><span class="lineno"> 2721</span>        prev_to_keep-&gt;chain_next_with_shift.Store(next_with_shift);</div>
<div class="line"><span class="lineno"> 2722</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rewrite_lock.CasUpdate(next_with_shift, yield_count_)) {</div>
<div class="line"><span class="lineno"> 2723</span>        <span class="comment">// Managed to update head without any parallel insertions</span></div>
<div class="line"><span class="lineno"> 2724</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2725</span>        <span class="comment">// Parallel insertion must have interfered. Need to do a purge</span></div>
<div class="line"><span class="lineno"> 2726</span>        <span class="comment">// from updated head to here. Since we have no prev_to_keep, there&#39;s</span></div>
<div class="line"><span class="lineno"> 2727</span>        <span class="comment">// no risk of duplicate clock updates to entries. Any entries already</span></div>
<div class="line"><span class="lineno"> 2728</span>        <span class="comment">// updated must have been evicted (purgeable) and it&#39;s OK to clock</span></div>
<div class="line"><span class="lineno"> 2729</span>        <span class="comment">// update any new entries just inserted in parallel.</span></div>
<div class="line"><span class="lineno"> 2730</span>        <span class="comment">// Can simply restart (GetSavedHead() already updated from CAS failure).</span></div>
<div class="line"><span class="lineno"> 2731</span>        next_with_shift = rewrite_lock.GetSavedHead();</div>
<div class="line"><span class="lineno"> 2732</span>        assert(!HandleImpl::IsEnd(next_with_shift));</div>
<div class="line"><span class="lineno"> 2733</span>        next = GetNextFromNextWithShift(next_with_shift);</div>
<div class="line"><span class="lineno"> 2734</span>        assert(next &lt; <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>.<a class="code hl_function" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a28a017539929f61ec8037625acb2ee1e">Count</a>());</div>
<div class="line"><span class="lineno"> 2735</span>        h = &amp;arr[next];</div>
<div class="line"><span class="lineno"> 2736</span>        pending_purge = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2737</span>        assert(prev_to_keep == <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 2738</span>        assert(GetShiftFromNextWithShift(next_with_shift) == home_shift);</div>
<div class="line"><span class="lineno"> 2739</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2740</span>      }</div>
<div class="line"><span class="lineno"> 2741</span>      pending_purge = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2742</span>      prev_to_keep = h;</div>
<div class="line"><span class="lineno"> 2743</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2744</span>      prev_to_keep = h;</div>
<div class="line"><span class="lineno"> 2745</span>    }</div>
<div class="line"><span class="lineno"> 2746</span> </div>
<div class="line"><span class="lineno"> 2747</span>    <span class="keywordflow">if</span> (h == <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno"> 2748</span>      <span class="comment">// Reached end of the chain</span></div>
<div class="line"><span class="lineno"> 2749</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2750</span>    }</div>
<div class="line"><span class="lineno"> 2751</span> </div>
<div class="line"><span class="lineno"> 2752</span>    <span class="comment">// Read chain pointer</span></div>
<div class="line"><span class="lineno"> 2753</span>    next_with_shift = h-&gt;chain_next_with_shift.Load();</div>
<div class="line"><span class="lineno"> 2754</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><span class="lineno"> 2755</span>    <span class="keywordflow">if</span> (prev_to_keep == h) {</div>
<div class="line"><span class="lineno"> 2756</span>      prev_to_keep_next_with_shift = next_with_shift;</div>
<div class="line"><span class="lineno"> 2757</span>    }</div>
<div class="line"><span class="lineno"> 2758</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2759</span> </div>
<div class="line"><span class="lineno"> 2760</span>    assert(GetShiftFromNextWithShift(next_with_shift) == home_shift);</div>
<div class="line"><span class="lineno"> 2761</span> </div>
<div class="line"><span class="lineno"> 2762</span>    <span class="comment">// Check for end marker</span></div>
<div class="line"><span class="lineno"> 2763</span>    <span class="keywordflow">if</span> (HandleImpl::IsEnd(next_with_shift)) {</div>
<div class="line"><span class="lineno"> 2764</span>      h = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2765</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2766</span>      next = GetNextFromNextWithShift(next_with_shift);</div>
<div class="line"><span class="lineno"> 2767</span>      assert(next &lt; <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>.<a class="code hl_function" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a28a017539929f61ec8037625acb2ee1e">Count</a>());</div>
<div class="line"><span class="lineno"> 2768</span>      h = &amp;arr[next];</div>
<div class="line"><span class="lineno"> 2769</span>      assert(h != prev_to_keep);</div>
<div class="line"><span class="lineno"> 2770</span>    }</div>
<div class="line"><span class="lineno"> 2771</span>  }</div>
<div class="line"><span class="lineno"> 2772</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a4c68c3c5ccbe3c20bd71313b1a0f8e10_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a4c68c3c5ccbe3c20bd71313b1a0f8e10_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a4c68c3c5ccbe3c20bd71313b1a0f8e10_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a4c68c3c5ccbe3c20bd71313b1a0f8e10_cgraph">
<area shape="rect" title=" " alt="" coords="5,114,219,176"/>
<area shape="poly" title=" " alt="" coords="61,113,62,103,72,95,88,89,112,87,139,90,156,97,154,102,138,95,112,92,89,94,74,99,67,106,66,114"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="283,37,464,82"/>
<area shape="poly" title=" " alt="" coords="204,111,266,90,284,84,285,89,268,95,206,116"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a13edad9a2ec43bc685dd5a1aaf70c21f" title=" " alt="" coords="267,105,480,184"/>
<area shape="poly" title=" " alt="" coords="219,142,251,142,251,147,219,147"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#afe0c39ddafa0f49b10f9fe77ad8e702b" title=" " alt="" coords="533,195,746,273"/>
<area shape="poly" title=" " alt="" coords="198,174,267,193,396,214,517,225,517,231,395,219,266,198,197,179"/>
<area shape="poly" title=" " alt="" coords="324,37,322,27,331,18,348,12,373,10,401,13,418,19,416,24,400,18,373,16,349,18,334,22,327,28,329,36"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#af094887ce078b9180b272800614bd2ee" title=" " alt="" coords="533,5,746,84"/>
<area shape="poly" title=" " alt="" coords="479,102,518,87,520,92,481,107"/>
<area shape="poly" title=" " alt="" coords="481,178,519,191,518,196,480,183"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a30417ab9b027b7113a0573d4fa6c7edb" title=" " alt="" coords="528,108,751,170"/>
<area shape="poly" title=" " alt="" coords="480,140,512,139,512,145,480,145"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631" title=" " alt="" coords="799,22,1041,67"/>
<area shape="poly" title=" " alt="" coords="747,42,784,42,784,47,747,47"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a4c68c3c5ccbe3c20bd71313b1a0f8e10_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a4c68c3c5ccbe3c20bd71313b1a0f8e10_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a4c68c3c5ccbe3c20bd71313b1a0f8e10_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a4c68c3c5ccbe3c20bd71313b1a0f8e10_icgraph">
<area shape="rect" title=" " alt="" coords="1312,84,1525,146"/>
<area shape="poly" title=" " alt="" coords="1461,72,1445,65,1419,63,1396,65,1381,69,1374,76,1373,84,1367,83,1369,73,1378,65,1395,59,1419,57,1446,60,1463,67"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a353c1aa19f1e338db90086bdca07407b" title=" " alt="" coords="1051,84,1264,146"/>
<area shape="poly" title=" " alt="" coords="1296,118,1264,118,1264,112,1296,112"/>
<area shape="poly" title=" " alt="" coords="1199,72,1183,65,1157,63,1135,65,1120,69,1112,76,1111,84,1106,83,1108,73,1117,65,1134,59,1157,57,1185,60,1201,67"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a9055868cef9d318a6d4bc97cc2f55c8d" title=" " alt="" coords="789,29,1003,91"/>
<area shape="poly" title=" " alt="" coords="1034,92,1003,85,1004,80,1036,87"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a24212c074c37a92800c31882b2907f8d" title=" " alt="" coords="789,139,1003,200"/>
<area shape="poly" title=" " alt="" coords="1036,143,1004,150,1003,145,1034,138"/>
<area shape="poly" title=" " alt="" coords="938,17,922,11,896,8,873,10,858,15,851,21,850,29,845,29,846,19,856,10,872,5,896,3,923,5,940,13"/>
<area shape="poly" title=" " alt="" coords="938,127,922,120,896,117,873,119,858,124,851,131,850,139,845,138,846,128,856,119,872,114,896,112,923,115,940,122"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#acecc474c0a88e9db56f62463c297fee0" title=" " alt="" coords="528,84,741,146"/>
<area shape="poly" title=" " alt="" coords="773,147,741,140,742,135,774,141"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a53060e46ed4e542a6db7f0e6bdae9c8a" title=" " alt="" coords="528,193,741,255"/>
<area shape="poly" title=" " alt="" coords="774,198,742,204,741,199,773,192"/>
<area shape="poly" title=" " alt="" coords="677,72,661,65,635,63,612,65,597,69,590,76,589,84,583,83,585,73,594,65,611,59,635,57,662,60,679,67"/>
<area shape="poly" title=" " alt="" coords="677,181,661,175,635,172,612,174,597,179,590,185,589,193,583,193,585,183,594,174,611,169,635,167,662,169,679,177"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#aa5b762aa6657b81ad29f6cd51ea9f305" title=" " alt="" coords="267,139,480,200"/>
<area shape="poly" title=" " alt="" coords="512,201,480,194,481,189,513,196"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a8ad5ee767437cfef149d7effdf2b97a4" title=" " alt="" coords="267,248,480,310"/>
<area shape="poly" title=" " alt="" coords="513,252,481,259,480,254,512,247"/>
<area shape="poly" title=" " alt="" coords="415,127,399,120,373,117,351,119,336,124,328,131,327,139,322,138,324,128,333,119,350,114,373,112,401,115,417,122"/>
<area shape="poly" title=" " alt="" coords="415,236,399,229,373,227,351,229,336,233,328,240,327,248,322,247,324,237,333,229,350,223,373,221,401,224,417,231"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#af9b12764aa02fbbf9120fb96ed552cf7" title=" " alt="" coords="5,248,219,310"/>
<area shape="poly" title=" " alt="" coords="251,282,219,282,219,276,251,276"/>
<area shape="poly" title=" " alt="" coords="154,236,138,229,112,227,89,229,74,233,67,240,66,248,61,247,62,237,72,229,88,223,112,221,139,224,156,231"/>
</map>
</div>

</div>
</div>
<a id="a8ad5ee767437cfef149d7effdf2b97a4" name="a8ad5ee767437cfef149d7effdf2b97a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ad5ee767437cfef149d7effdf2b97a4">&#9670;&#160;</a></span>Release()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::Release </td>
          <td>(</td>
          <td class="paramtype">HandleImpl *</td>          <td class="paramname"><span class="paramname"><em>handle</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>useful</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>erase_if_last_ref</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l03384">3384</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3385</span>                                                          {</div>
<div class="line"><span class="lineno"> 3386</span>  <span class="comment">// In contrast with LRUCache&#39;s Release, this function won&#39;t delete the handle</span></div>
<div class="line"><span class="lineno"> 3387</span>  <span class="comment">// when the cache is above capacity and the reference is the last one. Space</span></div>
<div class="line"><span class="lineno"> 3388</span>  <span class="comment">// is only freed up by Evict/PurgeImpl (called by Insert when space</span></div>
<div class="line"><span class="lineno"> 3389</span>  <span class="comment">// is needed) and Erase. We do this to avoid an extra atomic read of the</span></div>
<div class="line"><span class="lineno"> 3390</span>  <span class="comment">// variable usage_.</span></div>
<div class="line"><span class="lineno"> 3391</span> </div>
<div class="line"><span class="lineno"> 3392</span>  uint64_t old_meta;</div>
<div class="line"><span class="lineno"> 3393</span>  <span class="keywordflow">if</span> (useful) {</div>
<div class="line"><span class="lineno"> 3394</span>    <span class="comment">// Increment release counter to indicate was used</span></div>
<div class="line"><span class="lineno"> 3395</span>    old_meta = h-&gt;meta.FetchAdd(ClockHandle::kReleaseIncrement);</div>
<div class="line"><span class="lineno"> 3396</span>    <span class="comment">// Correct for possible (but rare) overflow</span></div>
<div class="line"><span class="lineno"> 3397</span>    CorrectNearOverflow(old_meta, h-&gt;meta);</div>
<div class="line"><span class="lineno"> 3398</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3399</span>    <span class="comment">// Decrement acquire counter to pretend it never happened</span></div>
<div class="line"><span class="lineno"> 3400</span>    old_meta = h-&gt;meta.FetchSub(ClockHandle::kAcquireIncrement);</div>
<div class="line"><span class="lineno"> 3401</span>  }</div>
<div class="line"><span class="lineno"> 3402</span> </div>
<div class="line"><span class="lineno"> 3403</span>  assert((old_meta &gt;&gt; ClockHandle::kStateShift) &amp;</div>
<div class="line"><span class="lineno"> 3404</span>         ClockHandle::kStateShareableBit);</div>
<div class="line"><span class="lineno"> 3405</span>  <span class="comment">// No underflow</span></div>
<div class="line"><span class="lineno"> 3406</span>  assert(((old_meta &gt;&gt; ClockHandle::kAcquireCounterShift) &amp;</div>
<div class="line"><span class="lineno"> 3407</span>          ClockHandle::kCounterMask) !=</div>
<div class="line"><span class="lineno"> 3408</span>         ((old_meta &gt;&gt; ClockHandle::kReleaseCounterShift) &amp;</div>
<div class="line"><span class="lineno"> 3409</span>          ClockHandle::kCounterMask));</div>
<div class="line"><span class="lineno"> 3410</span> </div>
<div class="line"><span class="lineno"> 3411</span>  <span class="keywordflow">if</span> ((erase_if_last_ref || <a class="code hl_define" href="../../d6/dd6/likely_8h.html#ab10d0a221f4d7a706701b806c8135fd7">UNLIKELY</a>(old_meta &gt;&gt; ClockHandle::kStateShift ==</div>
<div class="line"><span class="lineno"> 3412</span>                                     ClockHandle::kStateInvisible))) {</div>
<div class="line"><span class="lineno"> 3413</span>    <span class="comment">// FIXME: There&#39;s a chance here that another thread could replace this</span></div>
<div class="line"><span class="lineno"> 3414</span>    <span class="comment">// entry and we end up erasing the wrong one.</span></div>
<div class="line"><span class="lineno"> 3415</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#a53060e46ed4e542a6db7f0e6bdae9c8a">TryEraseHandle</a>(h, <span class="comment">/*holding_ref=*/</span><span class="keyword">false</span>, <span class="comment">/*mark_invisible=*/</span><span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3416</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3417</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3418</span>  }</div>
<div class="line"><span class="lineno"> 3419</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a8ad5ee767437cfef149d7effdf2b97a4_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a8ad5ee767437cfef149d7effdf2b97a4_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a8ad5ee767437cfef149d7effdf2b97a4_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a8ad5ee767437cfef149d7effdf2b97a4_cgraph">
<area shape="rect" title=" " alt="" coords="5,176,219,238"/>
<area shape="poly" title=" " alt="" coords="61,176,62,166,72,157,88,152,112,150,139,153,156,160,154,165,138,158,112,155,89,157,74,162,67,168,66,177"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a53060e46ed4e542a6db7f0e6bdae9c8a" title=" " alt="" coords="267,176,480,238"/>
<area shape="poly" title=" " alt="" coords="219,205,251,205,251,210,219,210"/>
<area shape="poly" title=" " alt="" coords="322,176,324,166,333,157,350,152,373,150,401,153,417,160,415,165,399,158,373,155,351,157,336,162,328,168,327,177"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a24212c074c37a92800c31882b2907f8d" title=" " alt="" coords="528,176,741,238"/>
<area shape="poly" title=" " alt="" coords="481,205,513,205,513,210,481,210"/>
<area shape="poly" title=" " alt="" coords="583,176,585,166,594,157,611,152,635,150,662,153,679,160,677,165,661,158,635,155,612,157,597,162,590,168,589,177"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a353c1aa19f1e338db90086bdca07407b" title=" " alt="" coords="789,176,1003,238"/>
<area shape="poly" title=" " alt="" coords="742,205,774,205,774,210,742,210"/>
<area shape="poly" title=" " alt="" coords="845,176,846,166,856,157,872,152,896,150,923,153,940,160,938,165,922,158,896,155,873,157,858,162,851,168,850,177"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#afe0c39ddafa0f49b10f9fe77ad8e702b" title=" " alt="" coords="1590,5,1804,84"/>
<area shape="poly" title=" " alt="" coords="931,174,985,133,1050,96,1116,70,1185,52,1255,38,1326,30,1460,25,1575,29,1575,34,1460,30,1326,35,1256,44,1186,57,1117,76,1052,100,988,137,934,178"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a30417ab9b027b7113a0573d4fa6c7edb" title=" " alt="" coords="1585,142,1809,204"/>
<area shape="poly" title=" " alt="" coords="1001,236,1113,262,1248,281,1320,286,1393,285,1466,278,1537,263,1593,241,1642,211,1645,215,1595,246,1538,269,1467,283,1394,290,1320,291,1247,287,1112,267,1000,241"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a4c68c3c5ccbe3c20bd71313b1a0f8e10" title=" " alt="" coords="1057,134,1270,196"/>
<area shape="poly" title=" " alt="" coords="1003,188,1041,181,1042,187,1004,193"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#ad0040262551e4d03603956bb5cea8b07" title=" " alt="" coords="1051,332,1276,394"/>
<area shape="poly" title=" " alt="" coords="942,236,1052,308,1080,323,1078,328,1049,312,939,241"/>
<area shape="poly" title=" " alt="" coords="1203,131,1258,96,1323,67,1387,52,1452,42,1575,36,1575,42,1452,48,1388,57,1325,73,1261,101,1206,136"/>
<area shape="poly" title=" " alt="" coords="1111,133,1112,123,1122,115,1139,109,1163,107,1191,110,1208,117,1206,122,1190,115,1163,112,1140,114,1125,119,1117,126,1116,134"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="1340,209,1521,254"/>
<area shape="poly" title=" " alt="" coords="1271,189,1325,202,1324,208,1270,194"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a13edad9a2ec43bc685dd5a1aaf70c21f" title=" " alt="" coords="1324,83,1537,161"/>
<area shape="poly" title=" " alt="" coords="1270,145,1308,139,1309,144,1271,150"/>
<area shape="poly" title=" " alt="" coords="1380,209,1379,199,1387,190,1405,184,1431,182,1459,185,1476,191,1474,196,1458,190,1431,188,1406,190,1390,194,1384,200,1385,208"/>
<area shape="poly" title=" " alt="" coords="1537,88,1575,77,1576,83,1538,94"/>
<area shape="poly" title=" " alt="" coords="1538,140,1570,146,1569,151,1537,145"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#af094887ce078b9180b272800614bd2ee" title=" " alt="" coords="1590,295,1804,373"/>
<area shape="poly" title=" " alt="" coords="1522,160,1539,171,1590,217,1651,281,1647,285,1586,221,1536,175,1519,164"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631" title=" " alt="" coords="1857,312,2098,356"/>
<area shape="poly" title=" " alt="" coords="1804,331,1841,331,1841,337,1804,337"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a451c426fc0333c92fe9da85c3c1abd4a" title=" " alt="" coords="1324,329,1537,408"/>
<area shape="poly" title=" " alt="" coords="1277,363,1308,364,1308,369,1276,368"/>
<area shape="poly" title=" " alt="" coords="1537,352,1575,347,1575,353,1538,357"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a8ad5ee767437cfef149d7effdf2b97a4_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a8ad5ee767437cfef149d7effdf2b97a4_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a8ad5ee767437cfef149d7effdf2b97a4_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a8ad5ee767437cfef149d7effdf2b97a4_icgraph">
<area shape="rect" title=" " alt="" coords="267,29,480,91"/>
<area shape="poly" title=" " alt="" coords="415,17,399,11,373,8,351,10,336,15,328,21,327,29,322,29,324,19,333,10,350,5,373,3,401,5,417,13"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#af9b12764aa02fbbf9120fb96ed552cf7" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="251,63,219,63,219,58,251,58"/>
<area shape="poly" title=" " alt="" coords="154,17,138,11,112,8,89,10,74,15,67,21,66,29,61,29,62,19,72,10,88,5,112,3,139,5,156,13"/>
</map>
</div>

</div>
</div>
<a id="a24212c074c37a92800c31882b2907f8d" name="a24212c074c37a92800c31882b2907f8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24212c074c37a92800c31882b2907f8d">&#9670;&#160;</a></span>Remove()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::Remove </td>
          <td>(</td>
          <td class="paramtype">HandleImpl *</td>          <td class="paramname"><span class="paramname"><em>h</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l03327">3327</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3327</span>                                              {</div>
<div class="line"><span class="lineno"> 3328</span>  assert((h-&gt;meta.Load() &gt;&gt; ClockHandle::kStateShift) ==</div>
<div class="line"><span class="lineno"> 3329</span>         ClockHandle::kStateConstruction);</div>
<div class="line"><span class="lineno"> 3330</span> </div>
<div class="line"><span class="lineno"> 3331</span>  <span class="keyword">const</span> HandleImpl&amp; c_h = *h;</div>
<div class="line"><span class="lineno"> 3332</span>  <a class="code hl_function" href="#a353c1aa19f1e338db90086bdca07407b">PurgeImpl</a>(&amp;c_h.hashed_key);</div>
<div class="line"><span class="lineno"> 3333</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a24212c074c37a92800c31882b2907f8d_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a24212c074c37a92800c31882b2907f8d_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a24212c074c37a92800c31882b2907f8d_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a24212c074c37a92800c31882b2907f8d_cgraph">
<area shape="rect" title=" " alt="" coords="5,176,219,238"/>
<area shape="poly" title=" " alt="" coords="61,176,62,166,72,157,88,152,112,150,139,153,156,160,154,165,138,158,112,155,89,157,74,162,67,168,66,177"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a353c1aa19f1e338db90086bdca07407b" title=" " alt="" coords="267,176,480,238"/>
<area shape="poly" title=" " alt="" coords="219,205,251,205,251,210,219,210"/>
<area shape="poly" title=" " alt="" coords="322,176,324,166,333,157,350,152,373,150,401,153,417,160,415,165,399,158,373,155,351,157,336,162,328,168,327,177"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#afe0c39ddafa0f49b10f9fe77ad8e702b" title=" " alt="" coords="1068,5,1281,84"/>
<area shape="poly" title=" " alt="" coords="408,174,462,133,527,96,593,70,662,52,733,38,803,30,938,25,1052,29,1052,34,938,30,804,35,734,44,663,57,595,76,529,100,465,137,412,178"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a30417ab9b027b7113a0573d4fa6c7edb" title=" " alt="" coords="1063,142,1286,204"/>
<area shape="poly" title=" " alt="" coords="478,236,590,262,725,281,797,286,871,285,943,278,1014,263,1070,241,1120,211,1122,215,1072,246,1015,269,944,283,871,290,797,291,725,287,589,267,477,241"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a4c68c3c5ccbe3c20bd71313b1a0f8e10" title=" " alt="" coords="534,134,747,196"/>
<area shape="poly" title=" " alt="" coords="480,188,518,181,519,187,481,193"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#ad0040262551e4d03603956bb5cea8b07" title=" " alt="" coords="528,332,753,394"/>
<area shape="poly" title=" " alt="" coords="419,236,529,308,558,323,555,328,527,312,416,241"/>
<area shape="poly" title=" " alt="" coords="681,131,736,96,800,67,864,52,929,42,1052,36,1052,42,930,48,865,57,802,73,738,101,683,136"/>
<area shape="poly" title=" " alt="" coords="588,133,590,123,600,115,616,109,641,107,669,110,686,117,684,122,667,115,641,112,618,114,602,119,595,126,594,134"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="817,209,999,254"/>
<area shape="poly" title=" " alt="" coords="748,189,803,202,801,208,747,194"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a13edad9a2ec43bc685dd5a1aaf70c21f" title=" " alt="" coords="801,83,1015,161"/>
<area shape="poly" title=" " alt="" coords="747,145,786,139,787,144,748,150"/>
<area shape="poly" title=" " alt="" coords="857,209,856,199,865,190,882,184,908,182,937,185,954,191,952,196,935,190,908,188,883,190,867,194,861,200,863,208"/>
<area shape="poly" title=" " alt="" coords="1014,88,1052,77,1053,83,1016,94"/>
<area shape="poly" title=" " alt="" coords="1016,140,1048,146,1047,151,1015,145"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#af094887ce078b9180b272800614bd2ee" title=" " alt="" coords="1068,295,1281,373"/>
<area shape="poly" title=" " alt="" coords="999,160,1016,171,1067,217,1129,281,1125,285,1064,221,1013,175,997,164"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631" title=" " alt="" coords="1334,312,1575,356"/>
<area shape="poly" title=" " alt="" coords="1281,331,1318,331,1318,337,1281,337"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a451c426fc0333c92fe9da85c3c1abd4a" title=" " alt="" coords="801,329,1015,408"/>
<area shape="poly" title=" " alt="" coords="754,363,785,364,785,369,754,368"/>
<area shape="poly" title=" " alt="" coords="1015,352,1052,347,1053,353,1015,357"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a24212c074c37a92800c31882b2907f8d_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a24212c074c37a92800c31882b2907f8d_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a24212c074c37a92800c31882b2907f8d_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a24212c074c37a92800c31882b2907f8d_icgraph">
<area shape="rect" title=" " alt="" coords="789,84,1003,146"/>
<area shape="poly" title=" " alt="" coords="938,72,922,65,896,63,873,65,858,69,851,76,850,84,845,83,846,73,856,65,872,59,896,57,923,60,940,67"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#acecc474c0a88e9db56f62463c297fee0" title=" " alt="" coords="528,29,741,91"/>
<area shape="poly" title=" " alt="" coords="773,92,741,85,742,80,774,87"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a53060e46ed4e542a6db7f0e6bdae9c8a" title=" " alt="" coords="528,139,741,200"/>
<area shape="poly" title=" " alt="" coords="774,143,742,150,741,145,773,138"/>
<area shape="poly" title=" " alt="" coords="677,17,661,11,635,8,612,10,597,15,590,21,589,29,583,29,585,19,594,10,611,5,635,3,662,5,679,13"/>
<area shape="poly" title=" " alt="" coords="677,127,661,120,635,117,612,119,597,124,590,131,589,139,583,138,585,128,594,119,611,114,635,112,662,115,679,122"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#aa5b762aa6657b81ad29f6cd51ea9f305" title=" " alt="" coords="267,84,480,146"/>
<area shape="poly" title=" " alt="" coords="512,147,480,140,481,135,513,141"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a8ad5ee767437cfef149d7effdf2b97a4" title=" " alt="" coords="267,193,480,255"/>
<area shape="poly" title=" " alt="" coords="513,198,481,204,480,199,512,192"/>
<area shape="poly" title=" " alt="" coords="415,72,399,65,373,63,351,65,336,69,328,76,327,84,322,83,324,73,333,65,350,59,373,57,401,60,417,67"/>
<area shape="poly" title=" " alt="" coords="415,181,399,175,373,172,351,174,336,179,328,185,327,193,322,193,324,183,333,174,350,169,373,167,401,169,417,177"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#af9b12764aa02fbbf9120fb96ed552cf7" title=" " alt="" coords="5,193,219,255"/>
<area shape="poly" title=" " alt="" coords="251,227,219,227,219,222,251,222"/>
<area shape="poly" title=" " alt="" coords="154,181,138,175,112,172,89,174,74,179,67,185,66,193,61,193,62,183,72,174,88,169,112,167,139,169,156,177"/>
</map>
</div>

</div>
</div>
<a id="ad711f79a6b0edd406c9c64330e707e0f" name="ad711f79a6b0edd406c9c64330e707e0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad711f79a6b0edd406c9c64330e707e0f">&#9670;&#160;</a></span>SplitForGrow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::SplitForGrow </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>grow_home</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>old_home</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>old_shift</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l02309">2309</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2310</span>                                                      {</div>
<div class="line"><span class="lineno"> 2311</span>  <span class="keywordtype">int</span> new_shift = old_shift + 1;</div>
<div class="line"><span class="lineno"> 2312</span>  HandleImpl* <span class="keyword">const</span> arr = <a class="code hl_variable" href="#ac090a43a3dde16589fbaf9a3aab83c63">array_</a>.<a class="code hl_function" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html#a9e0a723fcd917e570cf4207a40eef092">Get</a>();</div>
<div class="line"><span class="lineno"> 2313</span> </div>
<div class="line"><span class="lineno"> 2314</span>  <span class="comment">// We implement a somewhat complicated splitting algorithm to ensure that</span></div>
<div class="line"><span class="lineno"> 2315</span>  <span class="comment">// entries are always wait-free visible to Lookup, without Lookup needing</span></div>
<div class="line"><span class="lineno"> 2316</span>  <span class="comment">// to double-check length_info_ to ensure every potentially relevant</span></div>
<div class="line"><span class="lineno"> 2317</span>  <span class="comment">// existing entry is seen. This works step-by-step, carefully sharing</span></div>
<div class="line"><span class="lineno"> 2318</span>  <span class="comment">// unmigrated parts of the chain between the source chain and the new</span></div>
<div class="line"><span class="lineno"> 2319</span>  <span class="comment">// destination chain. This means that Lookup might see a partially migrated</span></div>
<div class="line"><span class="lineno"> 2320</span>  <span class="comment">// chain so has to take that into consideration when checking that it hasn&#39;t</span></div>
<div class="line"><span class="lineno"> 2321</span>  <span class="comment">// &quot;jumped off&quot; its intended chain (due to a parallel modification to an</span></div>
<div class="line"><span class="lineno"> 2322</span>  <span class="comment">// &quot;under (de)construction&quot; entry that was found on the chain but has</span></div>
<div class="line"><span class="lineno"> 2323</span>  <span class="comment">// been reassigned).</span></div>
<div class="line"><span class="lineno"> 2324</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2325</span>  <span class="comment">// We use a &quot;rewrite lock&quot; on the source and desination chains to exclude</span></div>
<div class="line"><span class="lineno"> 2326</span>  <span class="comment">// removals from those, and we have a prior waiting step that ensures any Grow</span></div>
<div class="line"><span class="lineno"> 2327</span>  <span class="comment">// operations feeding into this one have completed. But this process does have</span></div>
<div class="line"><span class="lineno"> 2328</span>  <span class="comment">// to gracefully handle concurrent insertions to the head of the source chain,</span></div>
<div class="line"><span class="lineno"> 2329</span>  <span class="comment">// and once marked ready, the destination chain.</span></div>
<div class="line"><span class="lineno"> 2330</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2331</span>  <span class="comment">// With those considerations, the migration starts with one &quot;big step,&quot;</span></div>
<div class="line"><span class="lineno"> 2332</span>  <span class="comment">// potentially with retries to deal with insertions in parallel. Part of the</span></div>
<div class="line"><span class="lineno"> 2333</span>  <span class="comment">// big step is to mark the two chain heads as updated with the new shift</span></div>
<div class="line"><span class="lineno"> 2334</span>  <span class="comment">// amount, which redirects Lookups to the appropriate new chain.</span></div>
<div class="line"><span class="lineno"> 2335</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2336</span>  <span class="comment">// After that big step that updates the heads, the rewrite lock makes it</span></div>
<div class="line"><span class="lineno"> 2337</span>  <span class="comment">// relatively easy to deal with the rest of the migration. Big</span></div>
<div class="line"><span class="lineno"> 2338</span>  <span class="comment">// simplifications come from being able to read the hashed_key of each</span></div>
<div class="line"><span class="lineno"> 2339</span>  <span class="comment">// entry on the chain without needing to hold a read reference, and</span></div>
<div class="line"><span class="lineno"> 2340</span>  <span class="comment">// from never &quot;jumping our to another chain.&quot; Concurrent insertions only</span></div>
<div class="line"><span class="lineno"> 2341</span>  <span class="comment">// happen at the chain head, which is outside of what is left to migrate.</span></div>
<div class="line"><span class="lineno"> 2342</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2343</span>  <span class="comment">// A series of smaller steps finishes splitting apart the existing chain into</span></div>
<div class="line"><span class="lineno"> 2344</span>  <span class="comment">// two distinct chains, followed by some steps to fully commit the result.</span></div>
<div class="line"><span class="lineno"> 2345</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2346</span>  <span class="comment">// Except for trivial cases in which all entries (or remaining entries)</span></div>
<div class="line"><span class="lineno"> 2347</span>  <span class="comment">// on the input chain go to one output chain, there is an important invariant</span></div>
<div class="line"><span class="lineno"> 2348</span>  <span class="comment">// after each step of migration, including after the initial &quot;big step&quot;:</span></div>
<div class="line"><span class="lineno"> 2349</span>  <span class="comment">// For each output chain, the &quot;zero chain&quot; (new hash bit is zero) and the</span></div>
<div class="line"><span class="lineno"> 2350</span>  <span class="comment">// &quot;one chain&quot; (new hash bit is one) we have a &quot;frontier&quot; entry marking the</span></div>
<div class="line"><span class="lineno"> 2351</span>  <span class="comment">// boundary between what has been migrated and what has not. One of the</span></div>
<div class="line"><span class="lineno"> 2352</span>  <span class="comment">// frontiers is along the old chain after the other, and all entries between</span></div>
<div class="line"><span class="lineno"> 2353</span>  <span class="comment">// them are for the same target chain as the earlier frontier. Thus, the</span></div>
<div class="line"><span class="lineno"> 2354</span>  <span class="comment">// chains share linked list tails starting at the latter frontier. All</span></div>
<div class="line"><span class="lineno"> 2355</span>  <span class="comment">// pointers from the new head locations to the frontier entries are marked</span></div>
<div class="line"><span class="lineno"> 2356</span>  <span class="comment">// with the new shift amount, while all pointers after the frontiers use the</span></div>
<div class="line"><span class="lineno"> 2357</span>  <span class="comment">// old shift amount.</span></div>
<div class="line"><span class="lineno"> 2358</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2359</span>  <span class="comment">// And after each step there is a strengthening step to reach a stronger</span></div>
<div class="line"><span class="lineno"> 2360</span>  <span class="comment">// invariant: the frontier earlier in the original chain is advanced to be</span></div>
<div class="line"><span class="lineno"> 2361</span>  <span class="comment">// immediately before the other frontier.</span></div>
<div class="line"><span class="lineno"> 2362</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2363</span>  <span class="comment">// Consider this original input chain,</span></div>
<div class="line"><span class="lineno"> 2364</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2365</span>  <span class="comment">// OldHome  -Old-&gt; A0 -Old-&gt; B0 -Old-&gt; A1 -Old-&gt; C0 -Old-&gt; OldHome(End)</span></div>
<div class="line"><span class="lineno"> 2366</span>  <span class="comment">// GrowHome (empty)</span></div>
<div class="line"><span class="lineno"> 2367</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2368</span>  <span class="comment">// == BIG STEP ==</span></div>
<div class="line"><span class="lineno"> 2369</span>  <span class="comment">// The initial big step finds the first entry that will be on the each</span></div>
<div class="line"><span class="lineno"> 2370</span>  <span class="comment">// output chain (in this case A0 and A1). We use brackets ([]) to mark them</span></div>
<div class="line"><span class="lineno"> 2371</span>  <span class="comment">// as our prospective frontiers.</span></div>
<div class="line"><span class="lineno"> 2372</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2373</span>  <span class="comment">// OldHome  -Old-&gt; [A0] -Old-&gt; B0 -Old-&gt; [A1] -Old-&gt; C0 -Old-&gt; OldHome(End)</span></div>
<div class="line"><span class="lineno"> 2374</span>  <span class="comment">// GrowHome (empty)</span></div>
<div class="line"><span class="lineno"> 2375</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2376</span>  <span class="comment">// Next we speculatively update grow_home head to point to the first entry for</span></div>
<div class="line"><span class="lineno"> 2377</span>  <span class="comment">// the one chain. This will not be used by Lookup until the head at old_home</span></div>
<div class="line"><span class="lineno"> 2378</span>  <span class="comment">// uses the new shift amount.</span></div>
<div class="line"><span class="lineno"> 2379</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2380</span>  <span class="comment">// OldHome  -Old-&gt; [A0] -Old-&gt; B0 -Old-&gt; [A1] -Old-&gt; C0 -Old-&gt; OldHome(End)</span></div>
<div class="line"><span class="lineno"> 2381</span>  <span class="comment">// GrowHome --------------New------------/</span></div>
<div class="line"><span class="lineno"> 2382</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2383</span>  <span class="comment">// Observe that if Lookup were to use the new head at GrowHome, it would be</span></div>
<div class="line"><span class="lineno"> 2384</span>  <span class="comment">// able to find all relevant entries. Finishing the initial big step</span></div>
<div class="line"><span class="lineno"> 2385</span>  <span class="comment">// requires a CAS (compare_exchange) of the OldHome head because there</span></div>
<div class="line"><span class="lineno"> 2386</span>  <span class="comment">// might have been parallel insertions there, in which case we roll back</span></div>
<div class="line"><span class="lineno"> 2387</span>  <span class="comment">// and try again. (We might need to point GrowHome head differently.)</span></div>
<div class="line"><span class="lineno"> 2388</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2389</span>  <span class="comment">// OldHome  -New-&gt; [A0] -Old-&gt; B0 -Old-&gt; [A1] -Old-&gt; C0 -Old-&gt; OldHome(End)</span></div>
<div class="line"><span class="lineno"> 2390</span>  <span class="comment">// GrowHome --------------New------------/</span></div>
<div class="line"><span class="lineno"> 2391</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2392</span>  <span class="comment">// Upgrading the OldHome head pointer with the new shift amount, with a</span></div>
<div class="line"><span class="lineno"> 2393</span>  <span class="comment">// compare_exchange, completes the initial big step, with [A0] as zero</span></div>
<div class="line"><span class="lineno"> 2394</span>  <span class="comment">// chain frontier and [A1] as one chain frontier. Links before the frontiers</span></div>
<div class="line"><span class="lineno"> 2395</span>  <span class="comment">// use the new shift amount and links after use the old shift amount.</span></div>
<div class="line"><span class="lineno"> 2396</span>  <span class="comment">// == END BIG STEP==</span></div>
<div class="line"><span class="lineno"> 2397</span>  <span class="comment">// == STRENGTHENING ==</span></div>
<div class="line"><span class="lineno"> 2398</span>  <span class="comment">// Zero chain frontier is advanced to [B0] (immediately before other</span></div>
<div class="line"><span class="lineno"> 2399</span>  <span class="comment">// frontier) by updating pointers with new shift amounts.</span></div>
<div class="line"><span class="lineno"> 2400</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2401</span>  <span class="comment">// OldHome  -New-&gt; A0 -New-&gt; [B0] -Old-&gt; [A1] -Old-&gt; C0 -Old-&gt; OldHome(End)</span></div>
<div class="line"><span class="lineno"> 2402</span>  <span class="comment">// GrowHome -------------New-----------/</span></div>
<div class="line"><span class="lineno"> 2403</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2404</span>  <span class="comment">// == END STRENGTHENING ==</span></div>
<div class="line"><span class="lineno"> 2405</span>  <span class="comment">// == SMALL STEP #1 ==</span></div>
<div class="line"><span class="lineno"> 2406</span>  <span class="comment">// From the strong invariant state, we need to find the next entry for</span></div>
<div class="line"><span class="lineno"> 2407</span>  <span class="comment">// the new chain with the earlier frontier. In this case, we need to find</span></div>
<div class="line"><span class="lineno"> 2408</span>  <span class="comment">// the next entry for the zero chain that comes after [B0], which in this</span></div>
<div class="line"><span class="lineno"> 2409</span>  <span class="comment">// case is C0. This will be our next zero chain frontier, at least under</span></div>
<div class="line"><span class="lineno"> 2410</span>  <span class="comment">// the weak invariant. To get there, we simply update the link between</span></div>
<div class="line"><span class="lineno"> 2411</span>  <span class="comment">// the current two frontiers to skip over the entries irreleveant to the</span></div>
<div class="line"><span class="lineno"> 2412</span>  <span class="comment">// ealier frontier chain. In this case, the zero chain skips over A1. As a</span></div>
<div class="line"><span class="lineno"> 2413</span>  <span class="comment">// result, he other chain is now the &quot;earlier.&quot;</span></div>
<div class="line"><span class="lineno"> 2414</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2415</span>  <span class="comment">// OldHome  -New-&gt; A0 -New-&gt; B0 -New-&gt; [C0] -Old-&gt; OldHome(End)</span></div>
<div class="line"><span class="lineno"> 2416</span>  <span class="comment">// GrowHome -New-&gt; [A1] ------Old-----/</span></div>
<div class="line"><span class="lineno"> 2417</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2418</span>  <span class="comment">// == END SMALL STEP #1 ==</span></div>
<div class="line"><span class="lineno"> 2419</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2420</span>  <span class="comment">// Repeating the cycle and end handling is not as interesting.</span></div>
<div class="line"><span class="lineno"> 2421</span> </div>
<div class="line"><span class="lineno"> 2422</span>  <span class="comment">// Acquire rewrite lock on zero chain (if it&#39;s non-empty)</span></div>
<div class="line"><span class="lineno"> 2423</span>  ChainRewriteLock zero_head_lock(&amp;arr[old_home], yield_count_);</div>
<div class="line"><span class="lineno"> 2424</span> </div>
<div class="line"><span class="lineno"> 2425</span>  <span class="comment">// Used for locking the one chain below</span></div>
<div class="line"><span class="lineno"> 2426</span>  uint64_t saved_one_head;</div>
<div class="line"><span class="lineno"> 2427</span>  <span class="comment">// One head has not been written to</span></div>
<div class="line"><span class="lineno"> 2428</span>  assert(arr[grow_home].head_next_with_shift.Load() == 0);</div>
<div class="line"><span class="lineno"> 2429</span> </div>
<div class="line"><span class="lineno"> 2430</span>  <span class="comment">// old_home will also the head of the new &quot;zero chain&quot; -- all entries in the</span></div>
<div class="line"><span class="lineno"> 2431</span>  <span class="comment">// &quot;from&quot; chain whose next hash bit is 0. grow_home will be head of the new</span></div>
<div class="line"><span class="lineno"> 2432</span>  <span class="comment">// &quot;one chain&quot;.</span></div>
<div class="line"><span class="lineno"> 2433</span> </div>
<div class="line"><span class="lineno"> 2434</span>  <span class="comment">// For these, SIZE_MAX is like nullptr (unknown)</span></div>
<div class="line"><span class="lineno"> 2435</span>  <span class="keywordtype">size_t</span> zero_chain_frontier = SIZE_MAX;</div>
<div class="line"><span class="lineno"> 2436</span>  <span class="keywordtype">size_t</span> one_chain_frontier = SIZE_MAX;</div>
<div class="line"><span class="lineno"> 2437</span>  <span class="keywordtype">size_t</span> cur = SIZE_MAX;</div>
<div class="line"><span class="lineno"> 2438</span> </div>
<div class="line"><span class="lineno"> 2439</span>  <span class="comment">// Set to 0 (zero chain frontier earlier), 1 (one chain), or -1 (unknown)</span></div>
<div class="line"><span class="lineno"> 2440</span>  <span class="keywordtype">int</span> chain_frontier_first = -1;</div>
<div class="line"><span class="lineno"> 2441</span> </div>
<div class="line"><span class="lineno"> 2442</span>  <span class="comment">// Might need to retry initial update of heads</span></div>
<div class="line"><span class="lineno"> 2443</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0;; ++i) {</div>
<div class="line"><span class="lineno"> 2444</span>    <a class="code hl_define" href="../../d0/d8b/clock__cache_8cc.html#afe85b67c91564218df748652e3d954f1">CHECK_TOO_MANY_ITERATIONS</a>(i);</div>
<div class="line"><span class="lineno"> 2445</span>    assert(zero_chain_frontier == SIZE_MAX);</div>
<div class="line"><span class="lineno"> 2446</span>    assert(one_chain_frontier == SIZE_MAX);</div>
<div class="line"><span class="lineno"> 2447</span>    assert(cur == SIZE_MAX);</div>
<div class="line"><span class="lineno"> 2448</span>    assert(chain_frontier_first == -1);</div>
<div class="line"><span class="lineno"> 2449</span> </div>
<div class="line"><span class="lineno"> 2450</span>    uint64_t next_with_shift = zero_head_lock.GetSavedHead();</div>
<div class="line"><span class="lineno"> 2451</span> </div>
<div class="line"><span class="lineno"> 2452</span>    <span class="comment">// Find a single representative for each target chain, or scan the whole</span></div>
<div class="line"><span class="lineno"> 2453</span>    <span class="comment">// chain if some target chain has no representative.</span></div>
<div class="line"><span class="lineno"> 2454</span>    <span class="keywordflow">for</span> (;; ++i) {</div>
<div class="line"><span class="lineno"> 2455</span>      <a class="code hl_define" href="../../d0/d8b/clock__cache_8cc.html#afe85b67c91564218df748652e3d954f1">CHECK_TOO_MANY_ITERATIONS</a>(i);</div>
<div class="line"><span class="lineno"> 2456</span> </div>
<div class="line"><span class="lineno"> 2457</span>      <span class="comment">// Loop invariants</span></div>
<div class="line"><span class="lineno"> 2458</span>      assert((chain_frontier_first &lt; 0) == (zero_chain_frontier == SIZE_MAX &amp;&amp;</div>
<div class="line"><span class="lineno"> 2459</span>                                            one_chain_frontier == SIZE_MAX));</div>
<div class="line"><span class="lineno"> 2460</span>      assert((cur == SIZE_MAX) == (zero_chain_frontier == SIZE_MAX &amp;&amp;</div>
<div class="line"><span class="lineno"> 2461</span>                                   one_chain_frontier == SIZE_MAX));</div>
<div class="line"><span class="lineno"> 2462</span> </div>
<div class="line"><span class="lineno"> 2463</span>      assert(GetShiftFromNextWithShift(next_with_shift) == old_shift);</div>
<div class="line"><span class="lineno"> 2464</span> </div>
<div class="line"><span class="lineno"> 2465</span>      <span class="comment">// Check for end of original chain</span></div>
<div class="line"><span class="lineno"> 2466</span>      <span class="keywordflow">if</span> (HandleImpl::IsEnd(next_with_shift)) {</div>
<div class="line"><span class="lineno"> 2467</span>        cur = SIZE_MAX;</div>
<div class="line"><span class="lineno"> 2468</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2469</span>      }</div>
<div class="line"><span class="lineno"> 2470</span> </div>
<div class="line"><span class="lineno"> 2471</span>      <span class="comment">// next_with_shift is not End</span></div>
<div class="line"><span class="lineno"> 2472</span>      cur = GetNextFromNextWithShift(next_with_shift);</div>
<div class="line"><span class="lineno"> 2473</span> </div>
<div class="line"><span class="lineno"> 2474</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94">BottomNBits</a>(arr[cur].hashed_key[1], new_shift) == old_home) {</div>
<div class="line"><span class="lineno"> 2475</span>        <span class="comment">// Entry for zero chain</span></div>
<div class="line"><span class="lineno"> 2476</span>        <span class="keywordflow">if</span> (zero_chain_frontier == SIZE_MAX) {</div>
<div class="line"><span class="lineno"> 2477</span>          zero_chain_frontier = cur;</div>
<div class="line"><span class="lineno"> 2478</span>          <span class="keywordflow">if</span> (one_chain_frontier != SIZE_MAX) {</div>
<div class="line"><span class="lineno"> 2479</span>            <span class="comment">// Ready to update heads</span></div>
<div class="line"><span class="lineno"> 2480</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2481</span>          }</div>
<div class="line"><span class="lineno"> 2482</span>          <span class="comment">// Nothing yet for one chain</span></div>
<div class="line"><span class="lineno"> 2483</span>          chain_frontier_first = 0;</div>
<div class="line"><span class="lineno"> 2484</span>        }</div>
<div class="line"><span class="lineno"> 2485</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2486</span>        assert(<a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94">BottomNBits</a>(arr[cur].hashed_key[1], new_shift) == grow_home);</div>
<div class="line"><span class="lineno"> 2487</span>        <span class="comment">// Entry for one chain</span></div>
<div class="line"><span class="lineno"> 2488</span>        <span class="keywordflow">if</span> (one_chain_frontier == SIZE_MAX) {</div>
<div class="line"><span class="lineno"> 2489</span>          one_chain_frontier = cur;</div>
<div class="line"><span class="lineno"> 2490</span>          <span class="keywordflow">if</span> (zero_chain_frontier != SIZE_MAX) {</div>
<div class="line"><span class="lineno"> 2491</span>            <span class="comment">// Ready to update heads</span></div>
<div class="line"><span class="lineno"> 2492</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2493</span>          }</div>
<div class="line"><span class="lineno"> 2494</span>          <span class="comment">// Nothing yet for zero chain</span></div>
<div class="line"><span class="lineno"> 2495</span>          chain_frontier_first = 1;</div>
<div class="line"><span class="lineno"> 2496</span>        }</div>
<div class="line"><span class="lineno"> 2497</span>      }</div>
<div class="line"><span class="lineno"> 2498</span> </div>
<div class="line"><span class="lineno"> 2499</span>      next_with_shift = arr[cur].chain_next_with_shift.Load();</div>
<div class="line"><span class="lineno"> 2500</span>    }</div>
<div class="line"><span class="lineno"> 2501</span> </div>
<div class="line"><span class="lineno"> 2502</span>    <span class="comment">// Try to update heads for initial migration info</span></div>
<div class="line"><span class="lineno"> 2503</span>    <span class="comment">// We only reached the end of the migrate-from chain already if one of the</span></div>
<div class="line"><span class="lineno"> 2504</span>    <span class="comment">// target chains will be empty.</span></div>
<div class="line"><span class="lineno"> 2505</span>    assert((cur == SIZE_MAX) ==</div>
<div class="line"><span class="lineno"> 2506</span>           (zero_chain_frontier == SIZE_MAX || one_chain_frontier == SIZE_MAX));</div>
<div class="line"><span class="lineno"> 2507</span>    assert((chain_frontier_first &lt; 0) ==</div>
<div class="line"><span class="lineno"> 2508</span>           (zero_chain_frontier == SIZE_MAX &amp;&amp; one_chain_frontier == SIZE_MAX));</div>
<div class="line"><span class="lineno"> 2509</span> </div>
<div class="line"><span class="lineno"> 2510</span>    <span class="comment">// Always update one chain&#39;s head first (safe), and mark it as locked</span></div>
<div class="line"><span class="lineno"> 2511</span>    saved_one_head = HandleImpl::kHeadLocked |</div>
<div class="line"><span class="lineno"> 2512</span>                     (one_chain_frontier != SIZE_MAX</div>
<div class="line"><span class="lineno"> 2513</span>                          ? MakeNextWithShift(one_chain_frontier, new_shift)</div>
<div class="line"><span class="lineno"> 2514</span>                          : MakeNextWithShiftEnd(grow_home, new_shift));</div>
<div class="line"><span class="lineno"> 2515</span>    arr[grow_home].head_next_with_shift.Store(saved_one_head);</div>
<div class="line"><span class="lineno"> 2516</span> </div>
<div class="line"><span class="lineno"> 2517</span>    <span class="comment">// Make sure length_info_ hasn&#39;t been updated too early, as we&#39;re about</span></div>
<div class="line"><span class="lineno"> 2518</span>    <span class="comment">// to make the change that makes it safe to update (e.g. in DoInsert())</span></div>
<div class="line"><span class="lineno"> 2519</span>    assert(LengthInfoToUsedLength(<a class="code hl_variable" href="#a691cf5bc49f36f3001d8c980901de288">length_info_</a>.<a class="code hl_function" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a5361060db542ce3ebfd914aecb908f8c">Load</a>()) &lt;= grow_home);</div>
<div class="line"><span class="lineno"> 2520</span> </div>
<div class="line"><span class="lineno"> 2521</span>    <span class="comment">// Try to set zero&#39;s head.</span></div>
<div class="line"><span class="lineno"> 2522</span>    <span class="keywordflow">if</span> (zero_head_lock.CasUpdate(</div>
<div class="line"><span class="lineno"> 2523</span>            zero_chain_frontier != SIZE_MAX</div>
<div class="line"><span class="lineno"> 2524</span>                ? MakeNextWithShift(zero_chain_frontier, new_shift)</div>
<div class="line"><span class="lineno"> 2525</span>                : MakeNextWithShiftEnd(old_home, new_shift),</div>
<div class="line"><span class="lineno"> 2526</span>            yield_count_)) {</div>
<div class="line"><span class="lineno"> 2527</span>      <span class="comment">// Both heads successfully updated to new shift</span></div>
<div class="line"><span class="lineno"> 2528</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2529</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2530</span>      <span class="comment">// Concurrent insertion. This should not happen too many times.</span></div>
<div class="line"><span class="lineno"> 2531</span>      <a class="code hl_define" href="../../d0/d8b/clock__cache_8cc.html#afe85b67c91564218df748652e3d954f1">CHECK_TOO_MANY_ITERATIONS</a>(i);</div>
<div class="line"><span class="lineno"> 2532</span>      <span class="comment">// The easiest solution is to restart.</span></div>
<div class="line"><span class="lineno"> 2533</span>      zero_chain_frontier = SIZE_MAX;</div>
<div class="line"><span class="lineno"> 2534</span>      one_chain_frontier = SIZE_MAX;</div>
<div class="line"><span class="lineno"> 2535</span>      cur = SIZE_MAX;</div>
<div class="line"><span class="lineno"> 2536</span>      chain_frontier_first = -1;</div>
<div class="line"><span class="lineno"> 2537</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2538</span>    }</div>
<div class="line"><span class="lineno"> 2539</span>  }</div>
<div class="line"><span class="lineno"> 2540</span> </div>
<div class="line"><span class="lineno"> 2541</span>  <span class="comment">// Create an RAII wrapper for the one chain rewrite lock we are already</span></div>
<div class="line"><span class="lineno"> 2542</span>  <span class="comment">// holding (if was not end) and is now &quot;published&quot; after successful CAS on</span></div>
<div class="line"><span class="lineno"> 2543</span>  <span class="comment">// zero chain head.</span></div>
<div class="line"><span class="lineno"> 2544</span>  ChainRewriteLock one_head_lock(&amp;arr[grow_home], yield_count_, saved_one_head);</div>
<div class="line"><span class="lineno"> 2545</span> </div>
<div class="line"><span class="lineno"> 2546</span>  <span class="comment">// Except for trivial cases, we have something like</span></div>
<div class="line"><span class="lineno"> 2547</span>  <span class="comment">// AHome -New-&gt; [A0] -Old-&gt; [B0] -Old-&gt; [C0] \                        |</span></div>
<div class="line"><span class="lineno"> 2548</span>  <span class="comment">// BHome --------------------New------------&gt; [A1] -Old-&gt; ...</span></div>
<div class="line"><span class="lineno"> 2549</span>  <span class="comment">// And we need to upgrade as much as we can on the &quot;first&quot; chain</span></div>
<div class="line"><span class="lineno"> 2550</span>  <span class="comment">// (the one eventually pointing to the other&#39;s frontier). This will</span></div>
<div class="line"><span class="lineno"> 2551</span>  <span class="comment">// also finish off any case in which one of the target chains will be empty.</span></div>
<div class="line"><span class="lineno"> 2552</span>  <span class="keywordflow">if</span> (chain_frontier_first &gt;= 0) {</div>
<div class="line"><span class="lineno"> 2553</span>    <span class="keywordtype">size_t</span>&amp; first_frontier = chain_frontier_first == 0</div>
<div class="line"><span class="lineno"> 2554</span>                                 ? <span class="comment">/*&amp;*/</span> zero_chain_frontier</div>
<div class="line"><span class="lineno"> 2555</span>                                 : <span class="comment">/*&amp;*/</span> one_chain_frontier;</div>
<div class="line"><span class="lineno"> 2556</span>    <span class="keywordtype">size_t</span>&amp; other_frontier = chain_frontier_first != 0</div>
<div class="line"><span class="lineno"> 2557</span>                                 ? <span class="comment">/*&amp;*/</span> zero_chain_frontier</div>
<div class="line"><span class="lineno"> 2558</span>                                 : <span class="comment">/*&amp;*/</span> one_chain_frontier;</div>
<div class="line"><span class="lineno"> 2559</span>    uint64_t stop_before_or_new_tail =</div>
<div class="line"><span class="lineno"> 2560</span>        other_frontier != SIZE_MAX</div>
<div class="line"><span class="lineno"> 2561</span>            ? <span class="comment">/*stop before*/</span> MakeNextWithShift(other_frontier, old_shift)</div>
<div class="line"><span class="lineno"> 2562</span>            : <span class="comment">/*new tail*/</span> MakeNextWithShiftEnd(</div>
<div class="line"><span class="lineno"> 2563</span>                  chain_frontier_first == 0 ? old_home : grow_home, new_shift);</div>
<div class="line"><span class="lineno"> 2564</span>    UpgradeShiftsOnRange(arr, first_frontier, stop_before_or_new_tail,</div>
<div class="line"><span class="lineno"> 2565</span>                         old_shift, new_shift);</div>
<div class="line"><span class="lineno"> 2566</span>  }</div>
<div class="line"><span class="lineno"> 2567</span> </div>
<div class="line"><span class="lineno"> 2568</span>  <span class="keywordflow">if</span> (zero_chain_frontier == SIZE_MAX) {</div>
<div class="line"><span class="lineno"> 2569</span>    <span class="comment">// Already finished migrating</span></div>
<div class="line"><span class="lineno"> 2570</span>    assert(one_chain_frontier == SIZE_MAX);</div>
<div class="line"><span class="lineno"> 2571</span>    assert(cur == SIZE_MAX);</div>
<div class="line"><span class="lineno"> 2572</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2573</span>    <span class="comment">// Still need to migrate between two target chains</span></div>
<div class="line"><span class="lineno"> 2574</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0;; ++i) {</div>
<div class="line"><span class="lineno"> 2575</span>      <a class="code hl_define" href="../../d0/d8b/clock__cache_8cc.html#afe85b67c91564218df748652e3d954f1">CHECK_TOO_MANY_ITERATIONS</a>(i);</div>
<div class="line"><span class="lineno"> 2576</span>      <span class="comment">// Overall loop invariants</span></div>
<div class="line"><span class="lineno"> 2577</span>      assert(zero_chain_frontier != SIZE_MAX);</div>
<div class="line"><span class="lineno"> 2578</span>      assert(one_chain_frontier != SIZE_MAX);</div>
<div class="line"><span class="lineno"> 2579</span>      assert(cur != SIZE_MAX);</div>
<div class="line"><span class="lineno"> 2580</span>      assert(chain_frontier_first &gt;= 0);</div>
<div class="line"><span class="lineno"> 2581</span>      <span class="keywordtype">size_t</span>&amp; first_frontier = chain_frontier_first == 0</div>
<div class="line"><span class="lineno"> 2582</span>                                   ? <span class="comment">/*&amp;*/</span> zero_chain_frontier</div>
<div class="line"><span class="lineno"> 2583</span>                                   : <span class="comment">/*&amp;*/</span> one_chain_frontier;</div>
<div class="line"><span class="lineno"> 2584</span>      <span class="keywordtype">size_t</span>&amp; other_frontier = chain_frontier_first != 0</div>
<div class="line"><span class="lineno"> 2585</span>                                   ? <span class="comment">/*&amp;*/</span> zero_chain_frontier</div>
<div class="line"><span class="lineno"> 2586</span>                                   : <span class="comment">/*&amp;*/</span> one_chain_frontier;</div>
<div class="line"><span class="lineno"> 2587</span>      assert(cur != first_frontier);</div>
<div class="line"><span class="lineno"> 2588</span>      assert(GetNextFromNextWithShift(</div>
<div class="line"><span class="lineno"> 2589</span>                 arr[first_frontier].chain_next_with_shift.Load()) ==</div>
<div class="line"><span class="lineno"> 2590</span>             other_frontier);</div>
<div class="line"><span class="lineno"> 2591</span> </div>
<div class="line"><span class="lineno"> 2592</span>      uint64_t next_with_shift = arr[cur].chain_next_with_shift.Load();</div>
<div class="line"><span class="lineno"> 2593</span> </div>
<div class="line"><span class="lineno"> 2594</span>      <span class="comment">// Check for end of original chain</span></div>
<div class="line"><span class="lineno"> 2595</span>      <span class="keywordflow">if</span> (HandleImpl::IsEnd(next_with_shift)) {</div>
<div class="line"><span class="lineno"> 2596</span>        <span class="comment">// Can set upgraded tail on first chain</span></div>
<div class="line"><span class="lineno"> 2597</span>        uint64_t first_new_tail = MakeNextWithShiftEnd(</div>
<div class="line"><span class="lineno"> 2598</span>            chain_frontier_first == 0 ? old_home : grow_home, new_shift);</div>
<div class="line"><span class="lineno"> 2599</span>        arr[first_frontier].chain_next_with_shift.Store(first_new_tail);</div>
<div class="line"><span class="lineno"> 2600</span>        <span class="comment">// And upgrade remainder of other chain</span></div>
<div class="line"><span class="lineno"> 2601</span>        uint64_t other_new_tail = MakeNextWithShiftEnd(</div>
<div class="line"><span class="lineno"> 2602</span>            chain_frontier_first != 0 ? old_home : grow_home, new_shift);</div>
<div class="line"><span class="lineno"> 2603</span>        UpgradeShiftsOnRange(arr, other_frontier, other_new_tail, old_shift,</div>
<div class="line"><span class="lineno"> 2604</span>                             new_shift);</div>
<div class="line"><span class="lineno"> 2605</span>        assert(other_frontier == SIZE_MAX);  <span class="comment">// Finished</span></div>
<div class="line"><span class="lineno"> 2606</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2607</span>      }</div>
<div class="line"><span class="lineno"> 2608</span> </div>
<div class="line"><span class="lineno"> 2609</span>      <span class="comment">// next_with_shift is not End</span></div>
<div class="line"><span class="lineno"> 2610</span>      cur = GetNextFromNextWithShift(next_with_shift);</div>
<div class="line"><span class="lineno"> 2611</span> </div>
<div class="line"><span class="lineno"> 2612</span>      <span class="keywordtype">int</span> target_chain;</div>
<div class="line"><span class="lineno"> 2613</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94">BottomNBits</a>(arr[cur].hashed_key[1], new_shift) == old_home) {</div>
<div class="line"><span class="lineno"> 2614</span>        <span class="comment">// Entry for zero chain</span></div>
<div class="line"><span class="lineno"> 2615</span>        target_chain = 0;</div>
<div class="line"><span class="lineno"> 2616</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2617</span>        assert(<a class="code hl_function" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94">BottomNBits</a>(arr[cur].hashed_key[1], new_shift) == grow_home);</div>
<div class="line"><span class="lineno"> 2618</span>        <span class="comment">// Entry for one chain</span></div>
<div class="line"><span class="lineno"> 2619</span>        target_chain = 1;</div>
<div class="line"><span class="lineno"> 2620</span>      }</div>
<div class="line"><span class="lineno"> 2621</span>      <span class="keywordflow">if</span> (target_chain == chain_frontier_first) {</div>
<div class="line"><span class="lineno"> 2622</span>        <span class="comment">// Found next entry to skip to on the first chain</span></div>
<div class="line"><span class="lineno"> 2623</span>        uint64_t skip_to = MakeNextWithShift(cur, new_shift);</div>
<div class="line"><span class="lineno"> 2624</span>        arr[first_frontier].chain_next_with_shift.Store(skip_to);</div>
<div class="line"><span class="lineno"> 2625</span>        first_frontier = cur;</div>
<div class="line"><span class="lineno"> 2626</span>        <span class="comment">// Upgrade other chain up to entry before that one</span></div>
<div class="line"><span class="lineno"> 2627</span>        UpgradeShiftsOnRange(arr, other_frontier, next_with_shift, old_shift,</div>
<div class="line"><span class="lineno"> 2628</span>                             new_shift);</div>
<div class="line"><span class="lineno"> 2629</span>        <span class="comment">// Swap which is marked as first</span></div>
<div class="line"><span class="lineno"> 2630</span>        chain_frontier_first = 1 - chain_frontier_first;</div>
<div class="line"><span class="lineno"> 2631</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2632</span>        <span class="comment">// Nothing to do yet, as we need to keep old generation pointers in</span></div>
<div class="line"><span class="lineno"> 2633</span>        <span class="comment">// place for lookups</span></div>
<div class="line"><span class="lineno"> 2634</span>      }</div>
<div class="line"><span class="lineno"> 2635</span>    }</div>
<div class="line"><span class="lineno"> 2636</span>  }</div>
<div class="line"><span class="lineno"> 2637</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ad711f79a6b0edd406c9c64330e707e0f_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ad711f79a6b0edd406c9c64330e707e0f_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ad711f79a6b0edd406c9c64330e707e0f_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ad711f79a6b0edd406c9c64330e707e0f_cgraph">
<area shape="rect" title=" " alt="" coords="5,114,219,176"/>
<area shape="poly" title=" " alt="" coords="61,113,62,103,72,95,88,89,112,87,139,90,156,97,154,102,138,95,112,92,89,94,74,99,67,106,66,114"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="283,37,464,82"/>
<area shape="poly" title=" " alt="" coords="204,111,266,90,284,84,285,89,268,95,206,116"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a13edad9a2ec43bc685dd5a1aaf70c21f" title=" " alt="" coords="267,105,480,184"/>
<area shape="poly" title=" " alt="" coords="219,142,251,142,251,147,219,147"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#afe0c39ddafa0f49b10f9fe77ad8e702b" title=" " alt="" coords="533,195,746,273"/>
<area shape="poly" title=" " alt="" coords="198,174,267,193,396,214,517,225,517,231,395,219,266,198,197,179"/>
<area shape="poly" title=" " alt="" coords="324,37,322,27,331,18,348,12,373,10,401,13,418,19,416,24,400,18,373,16,349,18,334,22,327,28,329,36"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#af094887ce078b9180b272800614bd2ee" title=" " alt="" coords="533,5,746,84"/>
<area shape="poly" title=" " alt="" coords="479,102,518,87,520,92,481,107"/>
<area shape="poly" title=" " alt="" coords="481,178,519,191,518,196,480,183"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a30417ab9b027b7113a0573d4fa6c7edb" title=" " alt="" coords="528,108,751,170"/>
<area shape="poly" title=" " alt="" coords="480,140,512,139,512,145,480,145"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631" title=" " alt="" coords="799,22,1041,67"/>
<area shape="poly" title=" " alt="" coords="747,42,784,42,784,47,747,47"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ad711f79a6b0edd406c9c64330e707e0f_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ad711f79a6b0edd406c9c64330e707e0f_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ad711f79a6b0edd406c9c64330e707e0f_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_ad711f79a6b0edd406c9c64330e707e0f_icgraph">
<area shape="rect" title=" " alt="" coords="528,29,741,91"/>
<area shape="poly" title=" " alt="" coords="677,17,661,11,635,8,612,10,597,15,590,21,589,29,583,29,585,19,594,10,611,5,635,3,662,5,679,13"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a5ca412446df4200dd55e020e802d99f2" title=" " alt="" coords="267,29,480,91"/>
<area shape="poly" title=" " alt="" coords="512,63,480,63,480,58,512,58"/>
<area shape="poly" title=" " alt="" coords="415,17,399,11,373,8,351,10,336,15,328,21,327,29,322,29,324,19,333,10,350,5,373,3,401,5,417,13"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#ae8566ed911e3ebb602e88d9abf773ac0" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="251,63,219,63,219,58,251,58"/>
<area shape="poly" title=" " alt="" coords="154,17,138,11,112,8,89,10,74,15,67,21,66,29,61,29,62,19,72,10,88,5,112,3,139,5,156,13"/>
</map>
</div>

</div>
</div>
<a id="a6679dbb26ab8882954a473b50bac5082" name="a6679dbb26ab8882954a473b50bac5082"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6679dbb26ab8882954a473b50bac5082">&#9670;&#160;</a></span>StartInsert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::StartInsert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/dbb/structROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1InsertState.html">InsertState</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>state</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l02129">2129</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2129</span>                                                        {</div>
<div class="line"><span class="lineno"> 2130</span>  state.saved_length_info = <a class="code hl_variable" href="#a691cf5bc49f36f3001d8c980901de288">length_info_</a>.<a class="code hl_function" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a5361060db542ce3ebfd914aecb908f8c">Load</a>();</div>
<div class="line"><span class="lineno"> 2131</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6679dbb26ab8882954a473b50bac5082_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6679dbb26ab8882954a473b50bac5082_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6679dbb26ab8882954a473b50bac5082_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6679dbb26ab8882954a473b50bac5082_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="70,29,71,19,79,10,92,5,112,3,135,5,148,13,146,17,133,11,112,8,94,10,82,15,76,21,75,29"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6679dbb26ab8882954a473b50bac5082_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6679dbb26ab8882954a473b50bac5082_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6679dbb26ab8882954a473b50bac5082_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a6679dbb26ab8882954a473b50bac5082_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="146,17,133,11,112,8,94,10,82,15,76,21,75,29,70,29,71,19,79,10,92,5,112,3,135,5,148,13"/>
</map>
</div>

</div>
</div>
<a id="a899a03cabc8d3f3f1bc371d432c68551" name="a899a03cabc8d3f3f1bc371d432c68551"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a899a03cabc8d3f3f1bc371d432c68551">&#9670;&#160;</a></span>TEST_MutableOccupancyLimit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t &amp; ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::TEST_MutableOccupancyLimit </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../db/d81/clock__cache_8h_source.html">clock_cache.h</a> 파일의 <a class="el" href="../../db/d81/clock__cache_8h_source.html#l00889">889</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  889</span>                                       {</div>
<div class="line"><span class="lineno">  890</span>    <span class="keywordflow">return</span> *<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">size_t</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="#a36ca56c367a512dc25dd00ba74a115e9">occupancy_limit_</a>);</div>
<div class="line"><span class="lineno">  891</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af9b12764aa02fbbf9120fb96ed552cf7" name="af9b12764aa02fbbf9120fb96ed552cf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9b12764aa02fbbf9120fb96ed552cf7">&#9670;&#160;</a></span>TEST_ReleaseN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::TEST_ReleaseN </td>
          <td>(</td>
          <td class="paramtype">HandleImpl *</td>          <td class="paramname"><span class="paramname"><em>handle</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l03422">3422</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3422</span>                                                               {</div>
<div class="line"><span class="lineno"> 3423</span>  <span class="keywordflow">if</span> (n &gt; 0) {</div>
<div class="line"><span class="lineno"> 3424</span>    <span class="comment">// Do n-1 simple releases first</span></div>
<div class="line"><span class="lineno"> 3425</span>    <a class="code hl_function" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ae56c44d575aee6d3d4dcedec2a5de280">TEST_ReleaseNMinus1</a>(h, n);</div>
<div class="line"><span class="lineno"> 3426</span> </div>
<div class="line"><span class="lineno"> 3427</span>    <span class="comment">// Then the last release might be more involved</span></div>
<div class="line"><span class="lineno"> 3428</span>    <a class="code hl_function" href="#a8ad5ee767437cfef149d7effdf2b97a4">Release</a>(h, <span class="comment">/*useful*/</span> <span class="keyword">true</span>, <span class="comment">/*erase_if_last_ref*/</span> <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3429</span>  }</div>
<div class="line"><span class="lineno"> 3430</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_html_a8ad5ee767437cfef149d7effdf2b97a4"><div class="ttname"><a href="#a8ad5ee767437cfef149d7effdf2b97a4">ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::Release</a></div><div class="ttdeci">bool Release(HandleImpl *handle, bool useful, bool erase_if_last_ref)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l03384">clock_cache.cc:3384</a></div></div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_html_ae56c44d575aee6d3d4dcedec2a5de280"><div class="ttname"><a href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ae56c44d575aee6d3d4dcedec2a5de280">ROCKSDB_NAMESPACE::clock_cache::BaseClockTable::TEST_ReleaseNMinus1</a></div><div class="ttdeci">void TEST_ReleaseNMinus1(ClockHandle *handle, size_t n)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8b/clock__cache_8cc_source.html#l00707">clock_cache.cc:707</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9b12764aa02fbbf9120fb96ed552cf7_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9b12764aa02fbbf9120fb96ed552cf7_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9b12764aa02fbbf9120fb96ed552cf7_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9b12764aa02fbbf9120fb96ed552cf7_cgraph">
<area shape="rect" title=" " alt="" coords="5,231,219,293"/>
<area shape="poly" title=" " alt="" coords="61,231,62,221,72,212,88,206,112,205,139,207,156,214,154,219,138,212,112,210,89,212,74,217,67,223,66,231"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a8ad5ee767437cfef149d7effdf2b97a4" title=" " alt="" coords="267,176,480,238"/>
<area shape="poly" title=" " alt="" coords="219,237,251,230,252,235,220,242"/>
<area shape="rect" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ae56c44d575aee6d3d4dcedec2a5de280" title=" " alt="" coords="268,286,478,348"/>
<area shape="poly" title=" " alt="" coords="220,282,254,289,253,294,219,287"/>
<area shape="poly" title=" " alt="" coords="322,176,324,166,333,157,350,152,373,150,401,153,417,160,415,165,399,158,373,155,351,157,336,162,328,168,327,177"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a53060e46ed4e542a6db7f0e6bdae9c8a" title=" " alt="" coords="528,176,741,238"/>
<area shape="poly" title=" " alt="" coords="481,205,513,205,513,210,481,210"/>
<area shape="poly" title=" " alt="" coords="583,176,585,166,594,157,611,152,635,150,662,153,679,160,677,165,661,158,635,155,612,157,597,162,590,168,589,177"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a24212c074c37a92800c31882b2907f8d" title=" " alt="" coords="789,176,1003,238"/>
<area shape="poly" title=" " alt="" coords="742,205,774,205,774,210,742,210"/>
<area shape="poly" title=" " alt="" coords="845,176,846,166,856,157,872,152,896,150,923,153,940,160,938,165,922,158,896,155,873,157,858,162,851,168,850,177"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a353c1aa19f1e338db90086bdca07407b" title=" " alt="" coords="1051,176,1264,238"/>
<area shape="poly" title=" " alt="" coords="1003,205,1035,205,1035,210,1003,210"/>
<area shape="poly" title=" " alt="" coords="1106,176,1108,166,1117,157,1134,152,1157,150,1185,153,1201,160,1199,165,1183,158,1157,155,1135,157,1120,162,1112,168,1111,177"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#afe0c39ddafa0f49b10f9fe77ad8e702b" title=" " alt="" coords="1852,5,2065,84"/>
<area shape="poly" title=" " alt="" coords="1192,174,1246,133,1311,96,1377,70,1446,52,1517,38,1587,30,1722,25,1836,29,1836,34,1722,30,1588,35,1518,44,1447,57,1379,76,1313,100,1249,137,1196,178"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a30417ab9b027b7113a0573d4fa6c7edb" title=" " alt="" coords="1847,142,2070,204"/>
<area shape="poly" title=" " alt="" coords="1262,236,1374,262,1509,281,1581,286,1655,285,1727,278,1798,263,1854,241,1904,211,1906,215,1856,246,1799,269,1728,283,1655,290,1581,291,1509,287,1373,267,1261,241"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a4c68c3c5ccbe3c20bd71313b1a0f8e10" title=" " alt="" coords="1318,134,1531,196"/>
<area shape="poly" title=" " alt="" coords="1264,188,1302,181,1303,187,1265,193"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#ad0040262551e4d03603956bb5cea8b07" title=" " alt="" coords="1312,332,1537,394"/>
<area shape="poly" title=" " alt="" coords="1203,236,1313,308,1342,323,1339,328,1311,312,1200,241"/>
<area shape="poly" title=" " alt="" coords="1465,131,1520,96,1584,67,1648,52,1713,42,1836,36,1836,42,1714,48,1649,57,1586,73,1522,101,1467,136"/>
<area shape="poly" title=" " alt="" coords="1372,133,1374,123,1384,115,1400,109,1425,107,1453,110,1470,117,1468,122,1451,115,1425,112,1402,114,1386,119,1379,126,1378,134"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="1601,209,1783,254"/>
<area shape="poly" title=" " alt="" coords="1532,189,1587,202,1585,208,1531,194"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a13edad9a2ec43bc685dd5a1aaf70c21f" title=" " alt="" coords="1585,83,1799,161"/>
<area shape="poly" title=" " alt="" coords="1531,145,1570,139,1571,144,1532,150"/>
<area shape="poly" title=" " alt="" coords="1641,209,1640,199,1649,190,1666,184,1692,182,1721,185,1738,191,1736,196,1719,190,1692,188,1667,190,1651,194,1645,200,1647,208"/>
<area shape="poly" title=" " alt="" coords="1798,88,1836,77,1837,83,1800,94"/>
<area shape="poly" title=" " alt="" coords="1800,140,1832,146,1831,151,1799,145"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#af094887ce078b9180b272800614bd2ee" title=" " alt="" coords="1852,295,2065,373"/>
<area shape="poly" title=" " alt="" coords="1783,160,1800,171,1851,217,1913,281,1909,285,1848,221,1797,175,1781,164"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631" title=" " alt="" coords="2118,312,2359,356"/>
<area shape="poly" title=" " alt="" coords="2065,331,2102,331,2102,337,2065,337"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a451c426fc0333c92fe9da85c3c1abd4a" title=" " alt="" coords="1585,329,1799,408"/>
<area shape="poly" title=" " alt="" coords="1538,363,1569,364,1569,369,1538,368"/>
<area shape="poly" title=" " alt="" coords="1799,352,1836,347,1837,353,1799,357"/>
<area shape="poly" title=" " alt="" coords="322,285,324,275,333,267,350,261,373,259,401,262,417,269,415,274,399,267,373,264,351,266,336,271,328,278,327,286"/>
<area shape="rect" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#aac93e76aa937b0f5ef7e127e9d72c775" title=" " alt="" coords="544,294,725,339"/>
<area shape="poly" title=" " alt="" coords="479,314,528,314,528,319,479,319"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9b12764aa02fbbf9120fb96ed552cf7_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9b12764aa02fbbf9120fb96ed552cf7_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9b12764aa02fbbf9120fb96ed552cf7_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_af9b12764aa02fbbf9120fb96ed552cf7_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,219,91"/>
<area shape="poly" title=" " alt="" coords="146,17,133,11,112,8,94,10,82,15,76,21,75,29,70,29,71,19,79,10,92,5,112,3,135,5,148,13"/>
</map>
</div>

</div>
</div>
<a id="a53060e46ed4e542a6db7f0e6bdae9c8a" name="a53060e46ed4e542a6db7f0e6bdae9c8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53060e46ed4e542a6db7f0e6bdae9c8a">&#9670;&#160;</a></span>TryEraseHandle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::TryEraseHandle </td>
          <td>(</td>
          <td class="paramtype">HandleImpl *</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>holding_ref</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>mark_invisible</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a> 파일의 <a class="el" href="../../d0/d8b/clock__cache_8cc_source.html#l03335">3335</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3336</span>                                                              {</div>
<div class="line"><span class="lineno"> 3337</span>  uint64_t meta;</div>
<div class="line"><span class="lineno"> 3338</span>  <span class="keywordflow">if</span> (mark_invisible) {</div>
<div class="line"><span class="lineno"> 3339</span>    <span class="comment">// Set invisible</span></div>
<div class="line"><span class="lineno"> 3340</span>    meta = h-&gt;meta.FetchAnd(</div>
<div class="line"><span class="lineno"> 3341</span>        ~(uint64_t{ClockHandle::kStateVisibleBit} &lt;&lt; ClockHandle::kStateShift));</div>
<div class="line"><span class="lineno"> 3342</span>    <span class="comment">// To local variable also</span></div>
<div class="line"><span class="lineno"> 3343</span>    meta &amp;=</div>
<div class="line"><span class="lineno"> 3344</span>        ~(uint64_t{ClockHandle::kStateVisibleBit} &lt;&lt; ClockHandle::kStateShift);</div>
<div class="line"><span class="lineno"> 3345</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3346</span>    meta = h-&gt;meta.Load();</div>
<div class="line"><span class="lineno"> 3347</span>  }</div>
<div class="line"><span class="lineno"> 3348</span> </div>
<div class="line"><span class="lineno"> 3349</span>  <span class="comment">// Take ownership if no other refs</span></div>
<div class="line"><span class="lineno"> 3350</span>  <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno"> 3351</span>    <span class="keywordflow">if</span> (GetRefcount(meta) != uint64_t{holding_ref}) {</div>
<div class="line"><span class="lineno"> 3352</span>      <span class="comment">// Not last ref at some point in time during this call</span></div>
<div class="line"><span class="lineno"> 3353</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3354</span>    }</div>
<div class="line"><span class="lineno"> 3355</span>    <span class="keywordflow">if</span> ((meta &amp; (uint64_t{ClockHandle::kStateShareableBit}</div>
<div class="line"><span class="lineno"> 3356</span>                 &lt;&lt; ClockHandle::kStateShift)) == 0) {</div>
<div class="line"><span class="lineno"> 3357</span>      <span class="comment">// Someone else took ownership</span></div>
<div class="line"><span class="lineno"> 3358</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3359</span>    }</div>
<div class="line"><span class="lineno"> 3360</span>    <span class="comment">// Note that if !holding_ref, there&#39;s a small chance that we release,</span></div>
<div class="line"><span class="lineno"> 3361</span>    <span class="comment">// another thread replaces this entry with another, reaches zero refs, and</span></div>
<div class="line"><span class="lineno"> 3362</span>    <span class="comment">// then we end up erasing that other entry. That&#39;s an acceptable risk /</span></div>
<div class="line"><span class="lineno"> 3363</span>    <span class="comment">// imprecision.</span></div>
<div class="line"><span class="lineno"> 3364</span>  } <span class="keywordflow">while</span> (!h-&gt;meta.CasWeak(meta, uint64_t{ClockHandle::kStateConstruction}</div>
<div class="line"><span class="lineno"> 3365</span>                                      &lt;&lt; ClockHandle::kStateShift));</div>
<div class="line"><span class="lineno"> 3366</span>  <span class="comment">// Took ownership</span></div>
<div class="line"><span class="lineno"> 3367</span>  <span class="comment">// TODO? Delay freeing?</span></div>
<div class="line"><span class="lineno"> 3368</span>  h-&gt;FreeData(allocator_);</div>
<div class="line"><span class="lineno"> 3369</span>  <span class="keywordtype">size_t</span> total_charge = h-&gt;total_charge;</div>
<div class="line"><span class="lineno"> 3370</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d6/dd6/likely_8h.html#ab10d0a221f4d7a706701b806c8135fd7">UNLIKELY</a>(h-&gt;IsStandalone())) {</div>
<div class="line"><span class="lineno"> 3371</span>    <span class="comment">// Delete detached handle</span></div>
<div class="line"><span class="lineno"> 3372</span>    <span class="keyword">delete</span> h;</div>
<div class="line"><span class="lineno"> 3373</span>    <a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#af52195d41a6f06bfcbd82679a027cbf6">standalone_usage_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6eee24b94e05b32724d318d80b24397d">FetchSubRelaxed</a>(total_charge);</div>
<div class="line"><span class="lineno"> 3374</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3375</span>    <a class="code hl_function" href="#a24212c074c37a92800c31882b2907f8d">Remove</a>(h);</div>
<div class="line"><span class="lineno"> 3376</span>    MarkEmpty(*h);</div>
<div class="line"><span class="lineno"> 3377</span>    <a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#ac77e847a676d7b1c9b23386e8fc0671b">occupancy_</a>.<a class="code hl_function" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html#a215ec373e21f9b51cdc18cfb082d7bca">FetchSub</a>(1U);</div>
<div class="line"><span class="lineno"> 3378</span>  }</div>
<div class="line"><span class="lineno"> 3379</span>  <a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a83cfd21cdc4064eaad12cf25f7dc0011">usage_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6eee24b94e05b32724d318d80b24397d">FetchSubRelaxed</a>(total_charge);</div>
<div class="line"><span class="lineno"> 3380</span>  assert(<a class="code hl_variable" href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#a83cfd21cdc4064eaad12cf25f7dc0011">usage_</a>.<a class="code hl_function" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#a6a8401cbb9ead0bbb0def8fbfbabc97d">LoadRelaxed</a>() &lt; SIZE_MAX / 2);</div>
<div class="line"><span class="lineno"> 3381</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3382</span>}</div>
<div class="ttc" id="aclassROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable_html_af52195d41a6f06bfcbd82679a027cbf6"><div class="ttname"><a href="../../d9/dd4/classROCKSDB__NAMESPACE_1_1clock__cache_1_1BaseClockTable.html#af52195d41a6f06bfcbd82679a027cbf6">ROCKSDB_NAMESPACE::clock_cache::BaseClockTable::standalone_usage_</a></div><div class="ttdeci">AcqRelAtomic&lt; size_t &gt; standalone_usage_</div><div class="ttdef"><b>Definition</b> <a href="../../db/d81/clock__cache_8h_source.html#l00498">clock_cache.h:498</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a53060e46ed4e542a6db7f0e6bdae9c8a_cgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a53060e46ed4e542a6db7f0e6bdae9c8a_cgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a53060e46ed4e542a6db7f0e6bdae9c8a_cgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a53060e46ed4e542a6db7f0e6bdae9c8a_cgraph">
<area shape="rect" title=" " alt="" coords="5,176,219,238"/>
<area shape="poly" title=" " alt="" coords="61,176,62,166,72,157,88,152,112,150,139,153,156,160,154,165,138,158,112,155,89,157,74,162,67,168,66,177"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a24212c074c37a92800c31882b2907f8d" title=" " alt="" coords="267,176,480,238"/>
<area shape="poly" title=" " alt="" coords="219,205,251,205,251,210,219,210"/>
<area shape="poly" title=" " alt="" coords="322,176,324,166,333,157,350,152,373,150,401,153,417,160,415,165,399,158,373,155,351,157,336,162,328,168,327,177"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a353c1aa19f1e338db90086bdca07407b" title=" " alt="" coords="528,176,741,238"/>
<area shape="poly" title=" " alt="" coords="481,205,513,205,513,210,481,210"/>
<area shape="poly" title=" " alt="" coords="583,176,585,166,594,157,611,152,635,150,662,153,679,160,677,165,661,158,635,155,612,157,597,162,590,168,589,177"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#afe0c39ddafa0f49b10f9fe77ad8e702b" title=" " alt="" coords="1329,5,1542,84"/>
<area shape="poly" title=" " alt="" coords="670,174,723,133,788,96,854,70,923,52,994,38,1065,30,1199,25,1314,29,1313,34,1199,30,1065,35,995,44,925,57,856,76,790,100,726,137,673,178"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a30417ab9b027b7113a0573d4fa6c7edb" title=" " alt="" coords="1324,142,1547,204"/>
<area shape="poly" title=" " alt="" coords="739,236,851,262,986,281,1059,286,1132,285,1205,278,1275,263,1331,241,1381,211,1384,215,1334,246,1277,269,1206,283,1132,290,1059,291,986,287,850,267,738,241"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a4c68c3c5ccbe3c20bd71313b1a0f8e10" title=" " alt="" coords="795,134,1009,196"/>
<area shape="poly" title=" " alt="" coords="741,188,780,181,781,187,742,193"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#ad0040262551e4d03603956bb5cea8b07" title=" " alt="" coords="789,332,1015,394"/>
<area shape="poly" title=" " alt="" coords="681,236,791,308,819,323,817,328,788,312,678,241"/>
<area shape="poly" title=" " alt="" coords="942,131,997,96,1062,67,1125,52,1191,42,1314,36,1314,42,1191,48,1126,57,1064,73,999,101,945,136"/>
<area shape="poly" title=" " alt="" coords="850,133,851,123,861,115,878,109,902,107,930,110,947,117,945,122,929,115,902,112,879,114,863,119,856,126,855,134"/>
<area shape="rect" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html#af600c4fa93d07ebb44f669e76582de94" title=" " alt="" coords="1079,209,1260,254"/>
<area shape="poly" title=" " alt="" coords="1010,189,1064,202,1063,208,1008,194"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a13edad9a2ec43bc685dd5a1aaf70c21f" title=" " alt="" coords="1063,83,1276,161"/>
<area shape="poly" title=" " alt="" coords="1009,145,1047,139,1048,144,1010,150"/>
<area shape="poly" title=" " alt="" coords="1119,209,1117,199,1126,190,1143,184,1169,182,1198,185,1215,191,1213,196,1197,190,1169,188,1144,190,1129,194,1122,200,1124,208"/>
<area shape="poly" title=" " alt="" coords="1276,88,1313,77,1315,83,1277,94"/>
<area shape="poly" title=" " alt="" coords="1277,140,1309,146,1308,151,1276,145"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#af094887ce078b9180b272800614bd2ee" title=" " alt="" coords="1329,295,1542,373"/>
<area shape="poly" title=" " alt="" coords="1261,160,1278,171,1329,217,1390,281,1386,285,1325,221,1274,175,1258,164"/>
<area shape="rect" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html#ab8c07210b81d7b64fc00ce2d30fc5631" title=" " alt="" coords="1595,312,1837,356"/>
<area shape="poly" title=" " alt="" coords="1543,331,1580,331,1580,337,1543,337"/>
<area shape="rect" href="../../df/d01/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_1_1ChainRewriteLock.html#a451c426fc0333c92fe9da85c3c1abd4a" title=" " alt="" coords="1063,329,1276,408"/>
<area shape="poly" title=" " alt="" coords="1015,363,1047,364,1047,369,1015,368"/>
<area shape="poly" title=" " alt="" coords="1276,352,1313,347,1314,353,1277,357"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a53060e46ed4e542a6db7f0e6bdae9c8a_icgraph.png" border="0" usemap="#ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a53060e46ed4e542a6db7f0e6bdae9c8a_icgraph" alt=""/></div>
<map name="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a53060e46ed4e542a6db7f0e6bdae9c8a_icgraph" id="ad1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable_a53060e46ed4e542a6db7f0e6bdae9c8a_icgraph">
<area shape="rect" title=" " alt="" coords="528,84,741,146"/>
<area shape="poly" title=" " alt="" coords="677,72,661,65,635,63,612,65,597,69,590,76,589,84,583,83,585,73,594,65,611,59,635,57,662,60,679,67"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#aa5b762aa6657b81ad29f6cd51ea9f305" title=" " alt="" coords="267,29,480,91"/>
<area shape="poly" title=" " alt="" coords="512,92,480,85,481,80,513,87"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#a8ad5ee767437cfef149d7effdf2b97a4" title=" " alt="" coords="267,139,480,200"/>
<area shape="poly" title=" " alt="" coords="513,143,481,150,480,145,512,138"/>
<area shape="poly" title=" " alt="" coords="415,17,399,11,373,8,351,10,336,15,328,21,327,29,322,29,324,19,333,10,350,5,373,3,401,5,417,13"/>
<area shape="poly" title=" " alt="" coords="415,127,399,120,373,117,351,119,336,124,328,131,327,139,322,138,324,128,333,119,350,114,373,112,401,115,417,122"/>
<area shape="rect" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html#af9b12764aa02fbbf9120fb96ed552cf7" title=" " alt="" coords="5,139,219,200"/>
<area shape="poly" title=" " alt="" coords="251,172,219,172,219,167,251,167"/>
<area shape="poly" title=" " alt="" coords="154,127,138,120,112,117,89,119,74,124,67,131,66,139,61,138,62,128,72,119,88,114,112,112,139,115,156,122"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">멤버 데이터 문서화</h2>
<a id="ac090a43a3dde16589fbaf9a3aab83c63" name="ac090a43a3dde16589fbaf9a3aab83c63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac090a43a3dde16589fbaf9a3aab83c63">&#9670;&#160;</a></span>array_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d4/d04/classROCKSDB__NAMESPACE_1_1TypedMemMapping.html">TypedMemMapping</a>&lt;HandleImpl&gt; ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::array_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../db/d81/clock__cache_8h_source.html">clock_cache.h</a> 파일의 <a class="el" href="../../db/d81/clock__cache_8h_source.html#l00958">958</a> 번째 라인에서 정의되었습니다.</p>

</div>
</div>
<a id="a3cd88545c5e9cfb63d51e413f244f0b9" name="a3cd88545c5e9cfb63d51e413f244f0b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cd88545c5e9cfb63d51e413f244f0b9">&#9670;&#160;</a></span>clock_pointer_mask_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html">RelaxedAtomic</a>&lt;size_t&gt; ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::clock_pointer_mask_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../db/d81/clock__cache_8h_source.html">clock_cache.h</a> 파일의 <a class="el" href="../../db/d81/clock__cache_8h_source.html#l00991">991</a> 번째 라인에서 정의되었습니다.</p>

</div>
</div>
<a id="afcb35ce36192fc425c67157f697c5226" name="afcb35ce36192fc425c67157f697c5226"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcb35ce36192fc425c67157f697c5226">&#9670;&#160;</a></span>grow_frontier_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html">RelaxedAtomic</a>&lt;size_t&gt; ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::grow_frontier_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../db/d81/clock__cache_8h_source.html">clock_cache.h</a> 파일의 <a class="el" href="../../db/d81/clock__cache_8h_source.html#l00987">987</a> 번째 라인에서 정의되었습니다.</p>

</div>
</div>
<a id="a98620a4cd334f9067756d38932c75d5f" name="a98620a4cd334f9067756d38932c75d5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98620a4cd334f9067756d38932c75d5f">&#9670;&#160;</a></span>kMaxLoadFactor</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::kMaxLoadFactor = 0.60</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel constexpr">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../db/d81/clock__cache_8h_source.html">clock_cache.h</a> 파일의 <a class="el" href="../../db/d81/clock__cache_8h_source.html#l00904">904</a> 번째 라인에서 정의되었습니다.</p>

</div>
</div>
<a id="a691cf5bc49f36f3001d8c980901de288" name="a691cf5bc49f36f3001d8c980901de288"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a691cf5bc49f36f3001d8c980901de288">&#9670;&#160;</a></span>length_info_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d80/classROCKSDB__NAMESPACE_1_1AcqRelAtomic.html">AcqRelAtomic</a>&lt;uint64_t&gt; ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::length_info_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../db/d81/clock__cache_8h_source.html">clock_cache.h</a> 파일의 <a class="el" href="../../db/d81/clock__cache_8h_source.html#l00976">976</a> 번째 라인에서 정의되었습니다.</p>

</div>
</div>
<a id="a36ca56c367a512dc25dd00ba74a115e9" name="a36ca56c367a512dc25dd00ba74a115e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36ca56c367a512dc25dd00ba74a115e9">&#9670;&#160;</a></span>occupancy_limit_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbc/classROCKSDB__NAMESPACE_1_1RelaxedAtomic.html">RelaxedAtomic</a>&lt;size_t&gt; ROCKSDB_NAMESPACE::clock_cache::AutoHyperClockTable::occupancy_limit_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition"><a class="el" href="../../db/d81/clock__cache_8h_source.html">clock_cache.h</a> 파일의 <a class="el" href="../../db/d81/clock__cache_8h_source.html#l00982">982</a> 번째 라인에서 정의되었습니다.</p>

</div>
</div>
<hr/>이 클래스에 대한 문서화 페이지는 다음의 파일들로부터 생성되었습니다.:<ul>
<li>cache/<a class="el" href="../../db/d81/clock__cache_8h_source.html">clock_cache.h</a></li>
<li>cache/<a class="el" href="../../d0/d8b/clock__cache_8cc_source.html">clock_cache.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d1/d23/namespaceROCKSDB__NAMESPACE.html">ROCKSDB_NAMESPACE</a></li><li class="navelem"><a class="el" href="../../d9/dfe/namespaceROCKSDB__NAMESPACE_1_1clock__cache.html">clock_cache</a></li><li class="navelem"><a class="el" href="../../d1/d81/classROCKSDB__NAMESPACE_1_1clock__cache_1_1AutoHyperClockTable.html">AutoHyperClockTable</a></li>
    <li class="footer">다음에 의해 생성됨 :  <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
